<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FlashPost Ultimate - –ü–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª</title>
    
    <!-- Google Fonts - 20 –ª—É—á—à–∏—Ö —à—Ä–∏—Ñ—Ç–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∏—Ä–∏–ª–ª–∏—Ü—ã -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Playfair+Display:wght@400;500;600;700;800;900&family=Bebas+Neue:wght@400&family=Space+Grotesk:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700;800;900&family=Roboto:wght@300;400;500;700;900&family=Open+Sans:wght@300;400;500;600;700;800&family=Lato:wght@300;400;700;900&family=Poppins:wght@300;400;500;600;700;800;900&family=Nunito:wght@300;400;500;600;700;800;900&family=Source+Sans+Pro:wght@300;400;600;700;900&family=Raleway:wght@300;400;500;600;700;800;900&family=Ubuntu:wght@300;400;500;700&family=Fira+Sans:wght@300;400;500;600;700;800;900&family=Merriweather:wght@300;400;700;900&family=PT+Sans:wght@400;700&family=Oswald:wght@300;400;500;600;700&family=Rubik:wght@300;400;500;600;700;800;900&family=Work+Sans:wght@300;400;500;600;700;800;900&family=Comfortaa:wght@300;400;500;600;700&display=swap&subset=latin,cyrillic" rel="stylesheet">
    
    <!-- HTML2Canvas –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- jsPDF –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f0f14 0%, #1a1a2e 50%, #16213e 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .title {
            font-size: 48px;
            font-weight: 800;
            background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
        }
        
        .main-layout {
            display: grid;
            grid-template-columns: 350px 1fr 300px;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            height: fit-content;
            animation: slideInUp 0.6s ease-out;
            transition: all 0.3s ease;
        }
        
        .panel:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        @keyframes slideInUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .label {
            display: block;
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 8px;
            color: rgba(255, 255, 255, 0.95);
        }
        
        .input-field {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 12px;
            font-size: 14px;
            color: white;
            resize: vertical;
            outline: none;
            transition: all 0.3s ease;
            font-family: inherit;
        }
        
        .input-field:focus {
            border-color: rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .input-field::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: inherit;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            text-decoration: none;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #833ab4 0%, #fd1d1d 50%, #fcb045 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(131, 58, 180, 0.3);
            width: 100%;
            margin-bottom: 10px;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 12px 35px rgba(131, 58, 180, 0.4);
        }
        
        .btn-primary:active {
            transform: translateY(-1px) scale(0.98);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-right: 8px;
            margin-bottom: 8px;
            font-size: 12px;
            padding: 8px 12px;
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        }
        
        .canvas-container {
            position: relative;
            background: #000;
            border-radius: 16px;
            overflow: hidden;
            aspect-ratio: 1;
            max-width: 600px;
            margin: 0 auto;
            border: 2px dashed transparent;
            transition: all 0.3s ease;
        }
        
        .canvas-container.drag-over {
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.05);
        }
        
        .slide-canvas {
            width: 100%;
            height: 100%;
            position: relative;
            cursor: crosshair;
        }
        
        .text-element {
            position: absolute;
            color: white;
            cursor: move;
            padding: 4px 8px;
            border: 2px solid transparent;
            border-radius: 4px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            word-wrap: break-word;
            user-select: none;
            min-width: 50px;
            min-height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            line-height: 1.2;
            animation: fadeInUp 0.5s ease-out;
        }
        
        .text-element:hover {
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(0, 0, 0, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .text-element.selected {
            border-color: #fff;
            background: rgba(0, 0, 0, 0.3);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.4);
            animation: pulse 2s infinite;
        }
        
        .text-element.dragging {
            z-index: 1000;
            transform: scale(1.1) rotate(2deg);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 0 20px rgba(255, 255, 255, 0.4);
            }
            50% {
                box-shadow: 0 0 30px rgba(255, 255, 255, 0.6);
            }
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideInLeft {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes bounceIn {
            0% {
                transform: scale(0.3);
                opacity: 0;
            }
            50% {
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .keyword-highlight {
            position: relative;
            display: inline;
        }
        
        .keyword-glow {
            text-shadow: 0 0 10px currentColor, 0 0 20px currentColor, 0 0 30px currentColor;
            animation: glow-pulse 2s ease-in-out infinite alternate;
        }
        
        .keyword-background {
            background: rgba(255, 255, 0, 0.3);
            padding: 2px 4px;
            border-radius: 4px;
        }
        
        .keyword-underline {
            border-bottom: 2px solid;
            border-image: linear-gradient(90deg, transparent, currentColor, transparent) 1;
        }
        
        .keyword-bold {
            font-weight: 900 !important;
        }
        
        @keyframes glow-pulse {
            from { text-shadow: 0 0 5px currentColor, 0 0 10px currentColor, 0 0 15px currentColor; }
            to { text-shadow: 0 0 10px currentColor, 0 0 20px currentColor, 0 0 30px currentColor; }
        }
        
        .background-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .slide-number {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 700;
            z-index: 10;
        }
        
        .navigation {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        
        .nav-btn {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .nav-btn:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        
        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .indicators {
            display: flex;
            gap: 6px;
        }
        
        .indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.4);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .indicator.active {
            background: white;
            transform: scale(1.3);
        }
        
        .controls-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .control-group {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
        }
        
        .control-label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .control-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 8px;
            color: white;
            font-size: 12px;
            outline: none;
        }
        
        .slider-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .slider {
            flex: 1;
            height: 4px;
            border-radius: 2px;
            background: rgba(255, 255, 255, 0.2);
            outline: none;
            appearance: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
        }
        
        .slider-value {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.8);
            min-width: 35px;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
        }
        
        .gradient-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }
        
        .gradient-btn {
            height: 40px;
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .gradient-btn:hover {
            border-color: rgba(255, 255, 255, 0.5);
            transform: scale(1.05);
        }
        
        .gradient-btn.active {
            border-color: white;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }
        
        .template-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }
        
        .template-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .template-item:hover {
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.1);
        }
        
        .template-item.selected {
            border-color: white;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }
        
        .template-preview {
            width: 100%;
            height: 30px;
            border-radius: 4px;
            margin-bottom: 4px;
        }
        
        .template-name {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }
        
        .spinner {
            width: 30px;
            height: 30px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        .progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            border-radius: 2px;
            transition: width 0.3s ease;
            width: 0%;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            z-index: 10000;
            font-size: 14px;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            max-width: 300px;
            word-wrap: break-word;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .toast.show {
            opacity: 1;
            transform: translateX(0);
            animation: bounceIn 0.5s ease-out;
        }
        
        .toast.error {
            background: #f44336;
        }
        
        .toast.info {
            background: #2196F3;
        }
        
        .toast.warning {
            background: #ff9800;
        }
        
        .notifications-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 350px;
            height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border-left: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 10001;
            transition: right 0.3s ease;
            padding: 20px;
            overflow-y: auto;
        }
        
        .notifications-panel.open {
            right: 0;
        }
        
        .notification-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            border-left: 4px solid #4CAF50;
            animation: slideInRight 0.3s ease-out;
        }
        
        .notification-item.error {
            border-left-color: #f44336;
        }
        
        .notification-item.info {
            border-left-color: #2196F3;
        }
        
        .notification-item.warning {
            border-left-color: #ff9800;
        }
        
        .notification-time {
            font-size: 11px;
            opacity: 0.7;
            margin-top: 5px;
        }
        
        .welcome-screen {
            text-align: center;
            padding: 80px 20px;
        }
        
        .welcome-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }
        
        .welcome-title {
            font-size: 28px;
            margin-bottom: 15px;
            font-weight: 700;
        }
        
        .welcome-text {
            color: rgba(255, 255, 255, 0.7);
            font-size: 16px;
        }
        
        .hidden {
            display: none !important;
        }
        
        .font-inter { font-family: 'Inter', sans-serif; }
        .font-playfair { font-family: 'Playfair Display', serif; }
        .font-bebas { font-family: 'Bebas Neue', cursive; }
        .font-space { font-family: 'Space Grotesk', sans-serif; }
        
        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .canvas-container {
                max-width: 500px;
            }
        }
        
        @media (max-width: 768px) {
            .title {
                font-size: 32px;
            }
            
            .canvas-container {
                max-width: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="header">
            <h1 class="title">üöÄ FlashPost Ultimate AI</h1>
            <p class="subtitle">Advanced AI Pipeline ‚Ä¢ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–æ–Ω–∞ ‚Ä¢ –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è ‚Ä¢ 11 —Ç–∏–ø–æ–≤ —Å–ª–∞–π–¥–æ–≤</p>
        </div>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
        <div class="main-layout">
            <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å - –í–≤–æ–¥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
            <div class="panel">
                <h3 style="margin-bottom: 20px; font-size: 18px;">üí° –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—É—Å–µ–ª–∏</h3>
                
                <div class="input-group">
                    <label class="label">–¢–µ–º–∞ –¥–ª—è –ò–ò –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:</label>
                    <textarea 
                        id="topicInput" 
                        class="input-field" 
                        rows="3"
                        placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: '–ó–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ –¥–ª—è –∑–∞–Ω—è—Ç—ã—Ö –ª—é–¥–µ–π'"
                    ></textarea>
                </div>
                
                <button class="btn btn-primary" id="generateBtn">
                    üöÄ Advanced AI Pipeline
                </button>
                
                <div class="input-group">
                    <label class="label">–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –≥–æ—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç:</label>
                    <textarea 
                        id="manualInput" 
                        class="input-field" 
                        rows="4"
                        placeholder="–°–ª–∞–π–¥ 1: –ó–∞–≥–æ–ª–æ–≤–æ–∫&#10;–û–ø–∏—Å–∞–Ω–∏–µ...&#10;&#10;–°–ª–∞–π–¥ 2: –ó–∞–≥–æ–ª–æ–≤–æ–∫&#10;–û–ø–∏—Å–∞–Ω–∏–µ..."
                    ></textarea>
                </div>
                
                <button class="btn btn-primary" id="manualBtn">
                    üìù –°–æ–∑–¥–∞—Ç—å –∏–∑ —Ç–µ–∫—Å—Ç–∞
                </button>
                
                <!-- –ó–∞–≥—Ä—É–∑–∫–∞ -->
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p id="loadingText">–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–∞—Ä—É—Å–µ–ª—å...</p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>
                
                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—É—Å–µ–ª—å—é -->
                <div id="carouselControls" class="hidden" style="margin-top: 25px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
                    <h4 style="margin-bottom: 15px; font-size: 16px;">üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h4>
                    
                    <button class="btn btn-secondary" id="addSlideBtn">
                        ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–ª–∞–π–¥
                    </button>
                    <button class="btn btn-secondary" id="duplicateBtn">
                        üìã –î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å
                    </button>
                    <button class="btn btn-secondary" id="deleteSlideBtn">
                        üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Å–ª–∞–π–¥
                    </button>
                    <button class="btn btn-secondary" id="expandBtn">
                        üöÄ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏–¥–µ—é
                    </button>
                    <button class="btn btn-secondary" id="downloadBtn">
                        üíæ –°–∫–∞—á–∞—Ç—å —Å–ª–∞–π–¥
                    </button>
                    <button class="btn btn-secondary" id="downloadAllBtn">
                        üì¶ –°–∫–∞—á–∞—Ç—å –≤—Å–µ
                    </button>
                    <button class="btn btn-secondary" id="saveTemplateBtn">
                        üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —à–∞–±–ª–æ–Ω
                    </button>
                    <button class="btn btn-secondary" id="saveProjectBtn">
                        üìÅ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
                    </button>
                    <button class="btn btn-secondary" id="loadProjectBtn">
                        üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
                    </button>
                    <button class="btn btn-secondary" id="newCarouselBtn">
                        üîÑ –ù–æ–≤–∞—è –∫–∞—Ä—É—Å–µ–ª—å
                    </button>
                </div>
            </div>
            
            <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å - –†–µ–¥–∞–∫—Ç–æ—Ä -->
            <div class="panel">
                <div id="welcomeScreen" class="welcome-screen">
                    <div class="welcome-icon">ü§ñ</div>
                    <h3 class="welcome-title">Advanced AI Pipeline –≥–æ—Ç–æ–≤</h3>
                    <p class="welcome-text">–í–≤–µ–¥–∏—Ç–µ —Ç–µ–º—É –∏ –ø–æ–ª—É—á–∏—Ç–µ –∫–∞—Ä—É—Å–µ–ª—å —Å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ —Ç–æ–Ω–∞–º–∏,<br>–∞–Ω–∞–ª–∏–∑–æ–º –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –∏ 8-11 —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å–ª–∞–π–¥–∞–º–∏</p>
                </div>
                
                <div id="editorScreen" class="hidden">
                    <div class="canvas-container">
                        <div class="slide-canvas" id="slideCanvas">
                            <!-- –¢–µ–∫—Å—Ç–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                        <div class="slide-number" id="slideNumber">1/5</div>
                    </div>
                    
                    <div class="navigation">
                        <button class="nav-btn" id="prevBtn">‚Äπ</button>
                        <div class="indicators" id="indicators"></div>
                        <button class="nav-btn" id="nextBtn">‚Ä∫</button>
                    </div>
                    
                    <div style="text-align: center; margin-top: 15px;">
                        <button class="btn btn-secondary" id="addTextBtn">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç
                        </button>
                        <button class="btn btn-secondary" id="centerTextBtn">
                            üìê –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ
                        </button>
                        <button class="btn btn-secondary" id="clearSlideBtn">
                            üßπ –û—á–∏—Å—Ç–∏—Ç—å —Å–ª–∞–π–¥
                        </button>
                        <button class="btn btn-secondary" id="testFontsBtn">
                            üî§ –¢–µ—Å—Ç —à—Ä–∏—Ñ—Ç–æ–≤
                        </button>
                        <button class="btn btn-secondary" id="helpBtn">
                            ‚ùì –ü–æ–º–æ—â—å
                        </button>
                        <button class="btn btn-secondary" id="notificationsBtn">
                            üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                        </button>
                        <button class="btn btn-secondary" id="statsBtn">
                            üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
            <div class="panel">
                <h3 style="margin-bottom: 20px; font-size: 18px;">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                
                <div class="controls-panel">
                    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–∫—Å—Ç–∞ -->
                    <div class="control-group" id="textControls" style="display: none;">
                        <label class="control-label">–¢–µ–∫—Å—Ç:</label>
                        <textarea class="control-input" id="textInput" rows="3"></textarea>
                        
                        <label class="control-label">–®—Ä–∏—Ñ—Ç:</label>
                        <select class="control-input" id="fontSelect">
                            <option value="Inter">Inter</option>
                            <option value="Playfair Display">Playfair Display</option>
                            <option value="Bebas Neue">Bebas Neue</option>
                            <option value="Space Grotesk">Space Grotesk</option>
                            <option value="Montserrat">Montserrat</option>
                            <option value="Roboto">Roboto</option>
                            <option value="Open Sans">Open Sans</option>
                            <option value="Lato">Lato</option>
                            <option value="Poppins">Poppins</option>
                            <option value="Nunito">Nunito</option>
                            <option value="Source Sans Pro">Source Sans Pro</option>
                            <option value="Raleway">Raleway</option>
                            <option value="Ubuntu">Ubuntu</option>
                            <option value="Fira Sans">Fira Sans</option>
                            <option value="Merriweather">Merriweather</option>
                            <option value="PT Sans">PT Sans</option>
                            <option value="Oswald">Oswald</option>
                            <option value="Rubik">Rubik</option>
                            <option value="Work Sans">Work Sans</option>
                            <option value="Comfortaa">Comfortaa</option>
                        </select>
                        
                        <label class="control-label">–†–∞–∑–º–µ—Ä:</label>
                        <div class="slider-group">
                            <input type="range" class="slider" id="sizeSlider" min="12" max="60" value="24">
                            <span class="slider-value" id="sizeValue">24px</span>
                        </div>
                        
                        <label class="control-label">–¢–æ–ª—â–∏–Ω–∞:</label>
                        <select class="control-input" id="weightSelect">
                            <option value="300">Light</option>
                            <option value="400">Normal</option>
                            <option value="500">Medium</option>
                            <option value="600">Semi-bold</option>
                            <option value="700">Bold</option>
                            <option value="800">Extra-bold</option>
                        </select>
                        
                        <label class="control-label">–¶–≤–µ—Ç:</label>
                        <input type="color" class="control-input" id="colorInput" value="#ffffff">
                        
                        <div style="display: flex; gap: 8px; margin-top: 10px;">
                            <button class="btn btn-secondary" id="saveTextBtn" style="flex: 1; margin: 0;">
                                üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                            </button>
                            <button class="btn btn-secondary" id="deleteTextBtn" style="flex: 1; margin: 0; background: #f44336;">
                                üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                            </button>
                        </div>
                    </div>
                    
                    <!-- –§–æ–Ω—ã -->
                    <div class="control-group">
                        <label class="control-label">–§–æ–Ω —Å–ª–∞–π–¥–∞:</label>
                        <div class="gradient-grid">
                            <div class="gradient-btn" data-gradient="linear-gradient(135deg, #833ab4 0%, #fd1d1d 50%, #fcb045 100%)" style="background: linear-gradient(135deg, #833ab4 0%, #fd1d1d 50%, #fcb045 100%);"></div>
                            <div class="gradient-btn" data-gradient="linear-gradient(135deg, #667eea 0%, #764ba2 100%)" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
                            <div class="gradient-btn" data-gradient="linear-gradient(135deg, #f093fb 0%, #f5576c 100%)" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"></div>
                            <div class="gradient-btn" data-gradient="linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);"></div>
                            <div class="gradient-btn" data-gradient="linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);"></div>
                            <div class="gradient-btn" data-gradient="linear-gradient(135deg, #fa709a 0%, #fee140 100%)" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);"></div>
                        </div>
                        
                        <button class="btn btn-secondary" id="uploadBackgroundBtn" style="width: 100%; margin-top: 10px;">
                            üñºÔ∏è –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ–Ω –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ
                        </button>
                        
                        <div style="display: flex; gap: 8px; margin-top: 10px;">
                            <button class="btn btn-secondary" id="uploadFirstSlideBtn" style="flex: 1; margin: 0;">
                                1Ô∏è‚É£ –§–æ–Ω –¥–ª—è 1-–≥–æ —Å–ª–∞–π–¥–∞
                            </button>
                            <button class="btn btn-secondary" id="uploadOthersBtn" style="flex: 1; margin: 0;">
                                üìö –§–æ–Ω –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö
                            </button>
                        </div>
                        
                        <div style="display: flex; gap: 8px; margin-top: 10px;">
                            <button class="btn btn-secondary" id="applyToAllBtn" style="flex: 1; margin: 0;">
                                üéØ –ö–æ –≤—Å–µ–º —Å–ª–∞–π–¥–∞–º
                            </button>
                            <button class="btn btn-secondary" id="applyToFirstBtn" style="flex: 1; margin: 0;">
                                1Ô∏è‚É£ –¢–æ–ª—å–∫–æ –∫ –ø–µ—Ä–≤–æ–º—É
                            </button>
                        </div>
                        
                        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–æ–Ω–∞ -->
                        <div id="backgroundControls" style="margin-top: 15px; display: none;">
                            <label class="control-label">–ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ:</label>
                            <div class="slider-group">
                                <input type="range" class="slider" id="backgroundDarken" min="0" max="100" value="0">
                                <span class="slider-value" id="darkenValue">0%</span>
                            </div>
                            
                            <label class="control-label">–†–∞–∑–º—ã—Ç–∏–µ:</label>
                            <div class="slider-group">
                                <input type="range" class="slider" id="backgroundBlur" min="0" max="20" value="0">
                                <span class="slider-value" id="blurValue">0px</span>
                            </div>
                            
                            <label class="control-label">–ú–∞—Å—à—Ç–∞–±:</label>
                            <div class="slider-group">
                                <input type="range" class="slider" id="backgroundScale" min="50" max="200" value="100">
                                <span class="slider-value" id="scaleValue">100%</span>
                            </div>
                            
                            <label class="control-label">–ü–æ–∑–∏—Ü–∏—è X:</label>
                            <div class="slider-group">
                                <input type="range" class="slider" id="backgroundX" min="-100" max="100" value="0">
                                <span class="slider-value" id="xValue">0%</span>
                            </div>
                            
                            <label class="control-label">–ü–æ–∑–∏—Ü–∏—è Y:</label>
                            <div class="slider-group">
                                <input type="range" class="slider" id="backgroundY" min="-100" max="100" value="0">
                                <span class="slider-value" id="yValue">0%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –®–∞–±–ª–æ–Ω—ã -->
                    <div class="control-group">
                        <label class="control-label">–®–∞–±–ª–æ–Ω—ã:</label>
                        <div class="template-grid" id="templateGrid">
                            <div class="template-item" data-template="1">
                                <div class="template-preview" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
                                <div class="template-name">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π</div>
                            </div>
                            <div class="template-item" data-template="2">
                                <div class="template-preview" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"></div>
                                <div class="template-name">–ú–∏–Ω–∏–º–∞–ª–∏–∑–º</div>
                            </div>
                            <div class="template-item" data-template="3">
                                <div class="template-preview" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);"></div>
                                <div class="template-name">–Ø—Ä–∫–∏–π</div>
                            </div>
                            <div class="template-item" data-template="new">
                                <div class="template-preview" style="background: #f8f9fa; display: flex; align-items: center; justify-content: center; color: #6c757d;">+</div>
                                <div class="template-name">–ù–æ–≤—ã–π</div>
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 8px; margin-top: 10px;">
                            <button class="btn btn-secondary" id="saveTemplateBtn2" style="flex: 1; margin: 0;">
                                üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                            </button>
                            <button class="btn btn-secondary" id="loadTemplateBtn" style="flex: 1; margin: 0;">
                                üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å
                            </button>
                        </div>
                    </div>
                    
                    <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
                    <div class="control-group">
                        <label class="control-label">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:</label>
                        <button class="btn btn-secondary" id="autoLayoutBtn" style="width: 100%; margin: 0 0 8px 0;">
                            üéØ –ê–≤—Ç–æ-—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ
                        </button>
                        <button class="btn btn-secondary" id="resetSlideBtn" style="width: 100%; margin: 0 0 8px 0;">
                            üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Å–ª–∞–π–¥
                        </button>
                        <button class="btn btn-secondary" id="applyStyleToAllBtn" style="width: 100%; margin: 0;">
                            üé® –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å—Ç–∏–ª—å –∫–æ –≤—Å–µ–º
                        </button>
                    </div>
                    
                    <!-- –í—ã–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ -->
                    <div class="control-group">
                        <label class="control-label">–í—ã–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤:</label>
                        <input type="text" class="control-input" id="keywordsInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é">
                        
                        <div style="margin: 10px 0;">
                            <label class="control-label">–¢–∏–ø –≤—ã–¥–µ–ª–µ–Ω–∏—è:</label>
                            <select class="control-input" id="highlightType">
                                <option value="glow">–°–≤–µ—á–µ–Ω–∏–µ</option>
                                <option value="background">–§–æ–Ω</option>
                                <option value="underline">–ü–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ</option>
                                <option value="bold">–ñ–∏—Ä–Ω—ã–π</option>
                            </select>
                        </div>
                        
                        <div style="margin: 10px 0;">
                            <label class="control-label">–¶–≤–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–∏—è:</label>
                            <input type="color" class="control-input" id="highlightColor" value="#ffff00">
                        </div>
                        
                        <div style="display: flex; gap: 8px;">
                            <button class="btn btn-secondary" id="applyHighlightBtn" style="flex: 1; margin: 0;">
                                ‚ú® –ü—Ä–∏–º–µ–Ω–∏—Ç—å
                            </button>
                            <button class="btn btn-secondary" id="autoHighlightBtn" style="flex: 1; margin: 0;">
                                ü§ñ –ê–≤—Ç–æ
                            </button>
                            <button class="btn btn-secondary" id="autoDetectBtn" style="flex: 1; margin: 0;">
                                üîç –ù–∞–π—Ç–∏
                            </button>
                            <button class="btn btn-secondary" id="clearHighlightBtn" style="flex: 1; margin: 0;">
                                üßπ –û—á–∏—Å—Ç–∏—Ç—å
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== –°–ò–°–¢–ï–ú–ê FREE/PRO –ü–õ–ê–ù–û–í =====
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–∞–Ω–æ–≤
        const PLANS = {
            FREE: {
                name: 'FREE',
                aiGenerationsPerDay: 3,
                exportFormats: ['PNG'],
                exportQualities: ['720p'],
                maxSlides: 10,
                templatesLimit: 5
            },
            PRO: {
                name: 'PRO',
                aiGenerationsPerDay: -1, // –±–µ–∑–ª–∏–º–∏—Ç
                exportFormats: ['PNG', 'JPEG', 'PDF'],
                exportQualities: ['720p', '1080p', '4K'],
                maxSlides: -1, // –±–µ–∑–ª–∏–º–∏—Ç
                templatesLimit: -1 // –±–µ–∑–ª–∏–º–∏—Ç
            }
        };
        
        // –¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é FREE)
        let currentPlan = PLANS.FREE;
        
        // –°—á–µ—Ç—á–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        let dailyUsage = {
            aiGenerations: 0,
            lastResetDate: new Date().toDateString()
        };
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–∑ localStorage
        function loadUsageData() {
            try {
                const saved = localStorage.getItem('flashpost_usage');
                if (saved) {
                    const data = JSON.parse(saved);
                    const today = new Date().toDateString();
                    
                    if (data.lastResetDate === today) {
                        dailyUsage = data;
                    } else {
                        // –ù–æ–≤—ã–π –¥–µ–Ω—å - —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫–∏
                        dailyUsage = {
                            aiGenerations: 0,
                            lastResetDate: today
                        };
                        saveUsageData();
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:', error);
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        function saveUsageData() {
            try {
                localStorage.setItem('flashpost_usage', JSON.stringify(dailyUsage));
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:', error);
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤
        function checkLimit(action) {
            switch (action) {
                case 'aiGeneration':
                    if (currentPlan.aiGenerationsPerDay === -1) return true;
                    return dailyUsage.aiGenerations < currentPlan.aiGenerationsPerDay;
                    
                case 'slides':
                    if (currentPlan.maxSlides === -1) return true;
                    return currentSlides.length < currentPlan.maxSlides;
                    
                case 'templates':
                    if (currentPlan.templatesLimit === -1) return true;
                    return templates.length < currentPlan.templatesLimit;
                    
                default:
                    return true;
            }
        }
        
        // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        function incrementUsage(action) {
            switch (action) {
                case 'aiGeneration':
                    dailyUsage.aiGenerations++;
                    saveUsageData();
                    break;
            }
        }
        
        // –ü–æ–∫–∞–∑ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ PRO
        function showUpgradeModal() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;
            
            modal.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    padding: 40px;
                    border-radius: 20px;
                    text-align: center;
                    color: white;
                    max-width: 400px;
                    margin: 20px;
                ">
                    <h2 style="margin-bottom: 20px; font-size: 24px;">üöÄ –û–±–Ω–æ–≤–∏—Ç—å—Å—è –¥–æ PRO?</h2>
                    <p style="margin-bottom: 20px; opacity: 0.9;">
                        –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –ª–∏–º–∏—Ç–∞ FREE –ø–ª–∞–Ω–∞.<br>
                        PRO –ø–ª–∞–Ω –≤–∫–ª—é—á–∞–µ—Ç:
                    </p>
                    <ul style="text-align: left; margin-bottom: 30px; opacity: 0.9;">
                        <li>‚úÖ –ë–µ–∑–ª–∏–º–∏—Ç–Ω–∞—è AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è</li>
                        <li>‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤ PNG, JPEG, PDF</li>
                        <li>‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ –¥–æ 4K</li>
                        <li>‚úÖ –ë–µ–∑–ª–∏–º–∏—Ç —Å–ª–∞–π–¥–æ–≤ –∏ —à–∞–±–ª–æ–Ω–æ–≤</li>
                    </ul>
                    <div style="display: flex; gap: 10px;">
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                                style="flex: 1; padding: 12px; border: none; border-radius: 8px; background: rgba(255,255,255,0.2); color: white; cursor: pointer;">
                            –ü–æ–∑–∂–µ
                        </button>
                        <button onclick="upgradeToPro(); this.parentElement.parentElement.parentElement.remove();" 
                                style="flex: 1; padding: 12px; border: none; border-radius: 8px; background: #28a745; color: white; cursor: pointer; font-weight: 600;">
                            –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ PRO (–¥–µ–º–æ)
        function upgradeToPro() {
            currentPlan = PLANS.PRO;
            showNotification('üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ PRO –ø–ª–∞–Ω!\n–í—Å–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–Ω—è—Ç—ã!', 'success');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updatePlanIndicator();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –ø–ª–∞–Ω–∞ –≤ UI
        function updatePlanIndicator() {
            const indicator = document.getElementById('planIndicator');
            if (!indicator) {
                // –°–æ–∑–¥–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–ª–∞–Ω–∞
                const planDiv = document.createElement('div');
                planDiv.id = 'planIndicator';
                planDiv.style.cssText = `
                    position: fixed;
                    top: 20px;
                    left: 20px;
                    background: ${currentPlan.name === 'PRO' ? '#28a745' : '#6c757d'};
                    color: white;
                    padding: 8px 16px;
                    border-radius: 20px;
                    font-size: 12px;
                    font-weight: 600;
                    z-index: 1000;
                `;
                planDiv.textContent = `${currentPlan.name} –ü–õ–ê–ù`;
                document.body.appendChild(planDiv);
            } else {
                indicator.style.background = currentPlan.name === 'PRO' ? '#28a745' : '#6c757d';
                indicator.textContent = `${currentPlan.name} –ü–õ–ê–ù`;
            }
        }
        
        // ===== –û–°–ù–û–í–ù–û–ô –ö–û–î –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø =====
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentSlides = [];
        let currentSlideIndex = 0;
        let selectedElement = null;
        let textElementCounter = 0;
        let isGenerating = false;
        let isDragging = false;
        let dragOffset = { x: 0, y: 0 };
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–æ–Ω–∞
        let backgroundSettings = {
            darken: 0,
            blur: 0,
            scale: 100,
            x: 0,
            y: 0
        };
        
        // –ò—Å—Ç–æ—Ä–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        let notificationHistory = [];
        
        // –°–∏—Å—Ç–µ–º–∞ —à–∞–±–ª–æ–Ω–æ–≤
        let templates = [
            { 
                id: 1, 
                name: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π', 
                background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                textStyle: { font: 'Inter', size: 24, weight: 600, color: '#ffffff' }
            },
            { 
                id: 2, 
                name: '–ú–∏–Ω–∏–º–∞–ª–∏–∑–º', 
                background: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
                textStyle: { font: 'Inter', size: 20, weight: 400, color: '#ffffff' }
            },
            { 
                id: 3, 
                name: '–Ø—Ä–∫–∏–π', 
                background: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
                textStyle: { font: 'Bebas Neue', size: 32, weight: 400, color: '#ffffff' }
            }
        ];

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const topicInput = document.getElementById('topicInput');
        const manualInput = document.getElementById('manualInput');
        const generateBtn = document.getElementById('generateBtn');
        const manualBtn = document.getElementById('manualBtn');
        const loading = document.getElementById('loading');
        const loadingText = document.getElementById('loadingText');
        const welcomeScreen = document.getElementById('welcomeScreen');
        const editorScreen = document.getElementById('editorScreen');
        const carouselControls = document.getElementById('carouselControls');
        const slideCanvas = document.getElementById('slideCanvas');
        const slideNumber = document.getElementById('slideNumber');
        const indicators = document.getElementById('indicators');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const textControls = document.getElementById('textControls');
        const textInput = document.getElementById('textInput');
        const fontSelect = document.getElementById('fontSelect');
        const sizeSlider = document.getElementById('sizeSlider');
        const sizeValue = document.getElementById('sizeValue');
        const weightSelect = document.getElementById('weightSelect');
        const colorInput = document.getElementById('colorInput');
        const saveTextBtn = document.getElementById('saveTextBtn');
        const deleteTextBtn = document.getElementById('deleteTextBtn');

        // –¶–≤–µ—Ç–∞ –¥–ª—è —Å–ª–∞–π–¥–æ–≤
        const slideGradients = [
            'linear-gradient(135deg, #833ab4 0%, #fd1d1d 50%, #fcb045 100%)',
            'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
            'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
            'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
            'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',
            'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
            'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)',
            'linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)',
            'linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)',
            'linear-gradient(135deg, #ff8a80 0%, #ea6100 100%)'
        ];

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
        function showToast(message, type = 'success') {
            showNotification(message, type);
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
        function showLoading(show, text = '–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–∞—Ä—É—Å–µ–ª—å...', progress = 0) {
            const progressFill = document.getElementById('progressFill');
            
            if (show) {
                loading.classList.remove('hidden');
                loadingText.textContent = text;
                generateBtn.disabled = true;
                manualBtn.disabled = true;
                
                if (progressFill) {
                    progressFill.style.width = progress + '%';
                }
            } else {
                loading.classList.add('hidden');
                generateBtn.disabled = false;
                manualBtn.disabled = false;
                
                if (progressFill) {
                    progressFill.style.width = '0%';
                }
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        function updateProgress(progress, text) {
            const progressFill = document.getElementById('progressFill');
            if (progressFill) {
                progressFill.style.width = progress + '%';
            }
            if (text) {
                loadingText.textContent = text;
            }
        }
        // üöÄ ADVANCED AI PIPELINE - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏
        async function generateWithAI(topic) {
            console.log('üöÄ ADVANCED AI: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PRO MODE –∫–∞—Ä—É—Å–µ–ª–∏ –¥–ª—è —Ç–µ–º—ã:', topic);
            
            // –°–∏–º—É–ª—è—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ AI
            await new Promise(resolve => setTimeout(resolve, 3000));
            
            try {
                console.log('üìã –≠–¢–ê–ü A: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è outline...');
                // –≠–¢–ê–ü A: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è outline (8-11 —Å–ª–∞–π–¥–æ–≤)
                const outline = generateCarouselOutline(topic);
                console.log('‚úÖ Outline —Å–æ–∑–¥–∞–Ω:', outline);
                
                console.log('‚úçÔ∏è –≠–¢–ê–ü B: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞...');
                // –≠–¢–ê–ü B: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ outline
                const content = generateCarouselContent(topic, outline);
                console.log('‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω:', content);
                
                console.log('üé® –≠–¢–ê–ü C: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —Å–ª–∞–π–¥—ã...');
                // –≠–¢–ê–ü C: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —Å–ª–∞–π–¥—ã —Å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏
                const slides = convertToAdvancedSlides(content);
                console.log('‚úÖ –°–ª–∞–π–¥—ã —Å–æ–∑–¥–∞–Ω—ã:', slides);
                
                if (!slides || slides.length === 0) {
                    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Å–ª–∞–π–¥—ã');
                }
                
                console.log(`‚úÖ ADVANCED AI: –°–æ–∑–¥–∞–Ω–æ ${slides.length} —Å–ª–∞–π–¥–æ–≤`);
                return slides;
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ Advanced AI Pipeline:', error);
                console.error('–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:', error.stack);
                throw error;
            }
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è outline –∫–∞—Ä—É—Å–µ–ª–∏ (ADVANCED AI PIPELINE)
        function generateCarouselOutline(topic) {
            console.log('üìã ADVANCED AI: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è outline –¥–ª—è —Ç–µ–º—ã:', topic);
            
            const slideCount = Math.floor(Math.random() * 4) + 8; // 8-11 —Å–ª–∞–π–¥–æ–≤
            
            const slideTypes = [
                { type: "hook", required: true, weight: 1.0 },
                { type: "context", required: true, weight: 0.8 },
                { type: "problem", required: true, weight: 1.0 },
                { type: "solution", required: true, weight: 1.0 },
                { type: "benefits", required: true, weight: 0.9 },
                { type: "proof", required: true, weight: 0.8 },
                { type: "action", required: true, weight: 1.0 },
                { type: "cta", required: true, weight: 1.0 },
                { type: "agitation", required: false, weight: 0.7 },
                { type: "objections", required: false, weight: 0.6 },
                { type: "bonus", required: false, weight: 0.5 }
            ];
            
            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª–∞–π–¥—ã –¥–ª—è –Ω—É–∂–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
            let selectedSlides = slideTypes.filter(s => s.required);
            const remainingSlots = slideCount - selectedSlides.length;
            
            if (remainingSlots > 0) {
                const optionalSlides = slideTypes
                    .filter(s => !s.required)
                    .sort((a, b) => b.weight - a.weight)
                    .slice(0, remainingSlots);
                selectedSlides = [...selectedSlides, ...optionalSlides];
            }
            
            const outline = {
                topic: topic,
                totalSlides: selectedSlides.length,
                structure: selectedSlides.map(s => s.type).join(' ‚Üí '),
                targetAudience: analyzeTargetAudience(topic),
                outline: selectedSlides.map((slideType, index) => ({
                    slideNumber: index + 1,
                    type: slideType.type,
                    mainIdea: `${slideType.type} –¥–ª—è ${topic}`,
                    purpose: `–¶–µ–ª—å —Å–ª–∞–π–¥–∞ ${slideType.type}`,
                    emotionalTone: getEmotionalTone(slideType.type)
                }))
            };
            
            console.log('‚úÖ ADVANCED OUTLINE —Å–æ–∑–¥–∞–Ω:', outline.outline.length, '—Å–ª–∞–π–¥–æ–≤');
            return outline;
        }

        // –ê–Ω–∞–ª–∏–∑ —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏
        function analyzeTargetAudience(topic) {
            const audienceMap = {
                '–º–∞—Ä–∫–µ—Ç–∏–Ω–≥': '–º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥–∏ –∏ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–∏',
                '–±–∏–∑–Ω–µ—Å': '–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–∏ –∏ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–∏', 
                '–∑–¥–æ—Ä–æ–≤—å–µ': '–ª—é–¥–∏, –∑–∞–±–æ—Ç—è—â–∏–µ—Å—è –æ –∑–¥–æ—Ä–æ–≤—å–µ',
                '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': '—Å—Ç—É–¥–µ–Ω—Ç—ã –∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏',
                '—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏': 'IT-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã –∏ —ç–Ω—Ç—É–∑–∏–∞—Å—Ç—ã',
                '—Ñ–∏–Ω–∞–Ω—Å—ã': '–∏–Ω–≤–µ—Å—Ç–æ—Ä—ã –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç—ã',
                '–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è': '–ª—é–¥–∏, –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ—Å—è —Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ–º',
                '—Å–ø–æ—Ä—Ç': '—Å–ø–æ—Ä—Ç—Å–º–µ–Ω—ã –∏ —Ñ–∏—Ç–Ω–µ—Å-—ç–Ω—Ç—É–∑–∏–∞—Å—Ç—ã',
                '–¥–∏–∑–∞–π–Ω': '–¥–∏–∑–∞–π–Ω–µ—Ä—ã –∏ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–µ –ª—é–¥–∏',
                '–∫—É–ª–∏–Ω–∞—Ä–∏—è': '–ª—é–±–∏—Ç–µ–ª–∏ –≥–æ—Ç–æ–≤–∏—Ç—å',
                '–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è': '–ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏ –∏ —Ç—É—Ä–∏—Å—Ç—ã'
            };
            
            const topicLower = topic.toLowerCase();
            for (const [key, audience] of Object.entries(audienceMap)) {
                if (topicLower.includes(key)) {
                    return audience;
                }
            }
            return '—à–∏—Ä–æ–∫–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è';
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–æ–Ω–∞ –¥–ª—è —Ç–∏–ø–∞ —Å–ª–∞–π–¥–∞
        function getEmotionalTone(slideType) {
            const tones = {
                hook: '—É–¥–∏–≤–ª–µ–Ω–∏–µ, –ª—é–±–æ–ø—ã—Ç—Å—Ç–≤–æ',
                context: '–ø–æ–Ω–∏–º–∞–Ω–∏–µ, —Å–æ–ø—Ä–∏—á–∞—Å—Ç–Ω–æ—Å—Ç—å', 
                problem: '–±–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ, –æ—Å–æ–∑–Ω–∞–Ω–∏–µ',
                agitation: '—Ç—Ä–µ–≤–æ–≥–∞, —Å—Ä–æ—á–Ω–æ—Å—Ç—å',
                solution: '–æ–±–ª–µ–≥—á–µ–Ω–∏–µ, –Ω–∞–¥–µ–∂–¥–∞',
                benefits: '–≤–æ–æ–¥—É—à–µ–≤–ª–µ–Ω–∏–µ, –ø—Ä–µ–¥–≤–∫—É—à–µ–Ω–∏–µ',
                proof: '–¥–æ–≤–µ—Ä–∏–µ, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å',
                objections: '–ø–æ–Ω–∏–º–∞–Ω–∏–µ, —É–±–µ–∂–¥–µ–Ω–∏–µ',
                action: '–º–æ—Ç–∏–≤–∞—Ü–∏—è, –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å',
                bonus: '–ø—Ä–∏—è—Ç–Ω–æ–µ —É–¥–∏–≤–ª–µ–Ω–∏–µ',
                cta: '—Ä–µ—à–∏–º–æ—Å—Ç—å, –¥–µ–π—Å—Ç–≤–∏–µ'
            };
            return tones[slideType] || '–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π';
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ outline
        function generateCarouselContent(topic, outline) {
            console.log('‚úçÔ∏è ADVANCED AI: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ outline...');
            
            const content = {
                topic: topic,
                targetAudience: outline.targetAudience,
                slides: outline.outline.map(outlineSlide => {
                    const slideContent = generateAdvancedSlideContent(outlineSlide.type, topic);
                    
                    return {
                        slideNumber: outlineSlide.slideNumber,
                        type: outlineSlide.type,
                        title: slideContent.title,
                        text: slideContent.text,
                        keywordType: slideContent.keywordType,
                        emotionalTone: outlineSlide.emotionalTone
                    };
                })
            };
            
            console.log('‚úÖ ADVANCED CONTENT —Å–æ–∑–¥–∞–Ω:', content.slides.length, '—Å–ª–∞–π–¥–æ–≤');
            return content;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Å–ª–∞–π–¥–∞
        function generateAdvancedSlideContent(slideType, topic) {
            const templates = {
                hook: {
                    title: `${topic}`,
                    text: `–ó–Ω–∞–ª–∏ –ª–∏ –≤—ã, —á—Ç–æ ${topic.toLowerCase()} –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –∂–∏–∑–Ω—å –∑–∞ 30 –¥–Ω–µ–π?\n\n–ë–æ–ª–µ–µ 80% –ª—é–¥–µ–π –Ω–µ –∑–Ω–∞—é—Ç —ç—Ç–æ–≥–æ —Å–µ–∫—Ä–µ—Ç–∞\n–ê —Ç–µ, –∫—Ç–æ –∑–Ω–∞—é—Ç ‚Äî —É–∂–µ –ø–æ–ª—É—á–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã\n–£–∑–Ω–∞–π—Ç–µ –ø—Ä–∞–≤–¥—É –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å`,
                    keywordType: 'emotional',
                    keywords: ['–∏–∑–º–µ–Ω–∏—Ç—å –∂–∏–∑–Ω—å', '30 –¥–Ω–µ–π', '—Å–µ–∫—Ä–µ—Ç', '—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã', '–ø—Ä–∞–≤–¥—É']
                },
                context: {
                    title: '–°–∏—Ç—É–∞—Ü–∏—è',
                    text: `–í 2024 –≥–æ–¥—É ${topic.toLowerCase()} —Å—Ç–∞–ª –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–º\n\n–ë–æ–ª–µ–µ 70% —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ\n–û—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–µ—Ä—è—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å\n–í—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å ‚Äî —Å–µ–π—á–∞—Å`,
                    keywordType: 'conceptual',
                    keywords: ['2024 –≥–æ–¥—É', '–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–º', '70% —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤', '–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏', '—Å–µ–π—á–∞—Å']
                },
                problem: {
                    title: '–ü—Ä–æ–±–ª–µ–º–∞',
                    text: `95% –ª—é–¥–µ–π —Å–æ–≤–µ—Ä—à–∞—é—Ç –æ–¥–Ω—É –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É\n\n–û–Ω–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç –≤–∞–∂–Ω–æ—Å—Ç—å ${topic.toLowerCase()}\n–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–æ—Ç–µ—Ä–µ –≤—Ä–µ–º–µ–Ω–∏ –∏ —Ä–µ—Å—É—Ä—Å–æ–≤\n–ê —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ—â–µ, —á–µ–º –∫–∞–∂–µ—Ç—Å—è`,
                    keywordType: 'conceptual',
                    keywords: ['95% –ª—é–¥–µ–π', '–∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É', '–∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç', '–ø–æ—Ç–µ—Ä–µ –≤—Ä–µ–º–µ–Ω–∏', '—Ä–µ—à–µ–Ω–∏–µ']
                },
                agitation: {
                    title: '–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è',
                    text: `–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –±–µ–∑ ${topic.toLowerCase()} ‚Äî —ç—Ç–æ –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏\n\n–í–∞—à–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ\n–û–Ω–∏ –ø–æ–ª—É—á–∞—é—Ç –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã\n–ê –≤—ã –æ—Å—Ç–∞–µ—Ç–µ—Å—å –ø–æ–∑–∞–¥–∏`,
                    keywordType: 'emotional',
                    keywords: ['–ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏', '–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã', '–ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã', '–æ—Å—Ç–∞–µ—Ç–µ—Å—å –ø–æ–∑–∞–¥–∏']
                },
                solution: {
                    title: '–†–µ—à–µ–Ω–∏–µ',
                    text: `${topic} ‚Äî —ç—Ç–æ –≤–∞—à –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É\n\n–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç\n–¢—ã—Å—è—á–∏ –ª—é–¥–µ–π —É–∂–µ –ø–æ–ª—É—á–∏–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã\n–¢–µ–ø–µ—Ä—å –≤–∞—à–∞ –æ—á–µ—Ä–µ–¥—å`,
                    keywordType: 'conceptual',
                    keywords: ['–∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É', '–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞', '—Ç—ã—Å—è—á–∏ –ª—é–¥–µ–π', '–≤–∞—à–∞ –æ—á–µ—Ä–µ–¥—å']
                },
                benefits: {
                    title: '–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞',
                    text: `–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π ${topic.toLowerCase()} –¥–∞–µ—Ç:\n\n‚Ä¢ –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ 300%\n‚Ä¢ –≠–∫–æ–Ω–æ–º–∏—é –≤—Ä–µ–º–µ–Ω–∏ –≤ 5 —Ä–∞–∑\n‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–æ—Å—Ç –¥–æ—Ö–æ–¥–æ–≤\n‚Ä¢ –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –∑–∞–≤—Ç—Ä–∞—à–Ω–µ–º –¥–Ω–µ`,
                    keywordType: 'conceptual',
                    keywords: ['300%', '5 —Ä–∞–∑', '—Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–æ—Å—Ç', '—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å']
                },
                proof: {
                    title: '–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞',
                    text: `–†–µ–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç ${topic.toLowerCase()}:\n\n‚Ä¢ –ö–æ–º–ø–∞–Ω–∏—è –ê: +250% —Ä–æ—Å—Ç–∞ –∑–∞ –≥–æ–¥\n‚Ä¢ –≠–∫—Å–ø–µ—Ä—Ç –ë: –¥–æ—Ö–æ–¥ –≤—ã—Ä–æ—Å –≤ 4 —Ä–∞–∑–∞\n‚Ä¢ –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ: 89% —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–æ–≤–æ–ª—å–Ω—ã`,
                    keywordType: 'conceptual',
                    keywords: ['+250% —Ä–æ—Å—Ç–∞', '4 —Ä–∞–∑–∞', '89% —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤', '–¥–æ–≤–æ–ª—å–Ω—ã']
                },
                objections: {
                    title: '–°–æ–º–Ω–µ–Ω–∏—è?',
                    text: `"${topic} —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ" ‚Äî —ç—Ç–æ –º–∏—Ñ\n\n–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –≤—Å—ë –ø—Ä–æ—â–µ, —á–µ–º –∫–∞–∂–µ—Ç—Å—è\n–ù—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –∑–Ω–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥\n–¢—ã—Å—è—á–∏ –ª—é–¥–µ–π —É–∂–µ —É–±–µ–¥–∏–ª–∏—Å—å –≤ —ç—Ç–æ–º`,
                    keywordType: 'conceptual',
                    keywords: ['–º–∏—Ñ', '–ø—Ä–æ—â–µ', '–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥', '—É–±–µ–¥–∏–ª–∏—Å—å']
                },
                action: {
                    title: '–î–µ–π—Å—Ç–≤–∏–µ',
                    text: `–ö–∞–∫ –Ω–∞—á–∞—Ç—å —Å ${topic.toLowerCase()} —É–∂–µ —Å–µ–≥–æ–¥–Ω—è:\n\n1Ô∏è‚É£ –ò–∑—É—á–∏—Ç–µ –æ—Å–Ω–æ–≤—ã (30 –º–∏–Ω—É—Ç)\n2Ô∏è‚É£ –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –º–µ—Ç–æ–¥\n3Ô∏è‚É£ –°–¥–µ–ª–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π —à–∞–≥\n4Ô∏è‚É£ –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã`,
                    keywordType: 'conceptual',
                    keywords: ['—É–∂–µ —Å–µ–≥–æ–¥–Ω—è', '30 –º–∏–Ω—É—Ç', '–ø–µ—Ä–≤—ã–π —à–∞–≥', '—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã']
                },
                bonus: {
                    title: '–ë–æ–Ω—É—Å',
                    text: `–°–∫—Ä—ã—Ç—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ ${topic.toLowerCase()}:\n\nüéÅ –£–ª—É—á—à–µ–Ω–∏–µ –¥—Ä—É–≥–∏—Ö —Å—Ñ–µ—Ä –∂–∏–∑–Ω–∏\nüéÅ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏ —Å–≤—è–∑–∏\nüéÅ –ü–æ–≤—ã—à–µ–Ω–∏–µ —Å–∞–º–æ–æ—Ü–µ–Ω–∫–∏\nüéÅ –í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ –¥–ª—è –æ–∫—Ä—É–∂–∞—é—â–∏—Ö`,
                    keywordType: 'emotional',
                    keywords: ['—Å–∫—Ä—ã—Ç—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞', '–Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏', '—Å–∞–º–æ–æ—Ü–µ–Ω–∫–∏', '–≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ']
                },
                cta: {
                    title: '–î–µ–π—Å—Ç–≤—É–π—Ç–µ!',
                    text: `–ì–æ—Ç–æ–≤—ã –∏–∑–º–µ–Ω–∏—Ç—å –∂–∏–∑–Ω—å —Å ${topic.toLowerCase()}?\n\nüëç –õ–∞–π–∫, –µ—Å–ª–∏ –º–∞—Ç–µ—Ä–∏–∞–ª –ø–æ–ª–µ–∑–µ–Ω\nüí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –≤–∞—à–∏–º –æ–ø—ã—Ç–æ–º\nüì§ –†–µ–ø–æ—Å—Ç –¥—Ä—É–∑—å—è–º\nüîî –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è`,
                    keywordType: 'emotional',
                    keywords: ['–∏–∑–º–µ–Ω–∏—Ç—å –∂–∏–∑–Ω—å', '–ø–æ–ª–µ–∑–µ–Ω', '–æ–ø—ã—Ç–æ–º', '–ø–æ–¥–ø–∏—Å–∫–∞']
                }
            };
            
            return templates[slideType] || templates.hook;
        }

        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Å–ª–∞–π–¥—ã —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏
        function convertToAdvancedSlides(content) {
            console.log('üîÑ ADVANCED AI: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Å–ª–∞–π–¥—ã...');
            
            // –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –ø–∞–ª–∏—Ç—Ä–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–ª–∞–π–¥–æ–≤
            const advancedGradients = {
                'hook': [
                    'linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)',
                    'linear-gradient(135deg, #fd79a8 0%, #e84393 100%)',
                    'linear-gradient(135deg, #ff7675 0%, #d63031 100%)'
                ],
                'context': [
                    'linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)',
                    'linear-gradient(135deg, #81ecec 0%, #00cec9 100%)',
                    'linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%)'
                ],
                'problem': [
                    'linear-gradient(135deg, #636e72 0%, #2d3436 100%)',
                    'linear-gradient(135deg, #a55eea 0%, #8b5cf6 100%)',
                    'linear-gradient(135deg, #fd79a8 0%, #e84393 100%)'
                ],
                'agitation': [
                    'linear-gradient(135deg, #e17055 0%, #d63031 100%)',
                    'linear-gradient(135deg, #fd79a8 0%, #e84393 100%)',
                    'linear-gradient(135deg, #ff7675 0%, #d63031 100%)'
                ],
                'solution': [
                    'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',
                    'linear-gradient(135deg, #55efc4 0%, #00b894 100%)',
                    'linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)'
                ],
                'benefits': [
                    'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',
                    'linear-gradient(135deg, #fdcb6e 0%, #e17055 100%)',
                    'linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%)'
                ],
                'proof': [
                    'linear-gradient(135deg, #0984e3 0%, #74b9ff 100%)',
                    'linear-gradient(135deg, #00cec9 0%, #55efc4 100%)',
                    'linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%)'
                ],
                'objections': [
                    'linear-gradient(135deg, #81ecec 0%, #74b9ff 100%)',
                    'linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%)',
                    'linear-gradient(135deg, #55efc4 0%, #00b894 100%)'
                ],
                'action': [
                    'linear-gradient(135deg, #fdcb6e 0%, #e17055 100%)',
                    'linear-gradient(135deg, #fd79a8 0%, #e84393 100%)',
                    'linear-gradient(135deg, #ff7675 0%, #d63031 100%)'
                ],
                'bonus': [
                    'linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%)',
                    'linear-gradient(135deg, #fab1a0 0%, #e17055 100%)',
                    'linear-gradient(135deg, #fd79a8 0%, #e84393 100%)'
                ],
                'cta': [
                    'linear-gradient(135deg, #fd79a8 0%, #e84393 100%)',
                    'linear-gradient(135deg, #ff7675 0%, #d63031 100%)',
                    'linear-gradient(135deg, #fdcb6e 0%, #e17055 100%)'
                ],
                'default': [
                    'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                    'linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)'
                ]
            };

            const slides = content.slides.map((slide, index) => {
                // –í—ã–±–∏—Ä–∞–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è —Ç–∏–ø–∞ —Å–ª–∞–π–¥–∞
                const gradientOptions = advancedGradients[slide.type] || advancedGradients.default;
                const selectedGradient = gradientOptions[Math.floor(Math.random() * gradientOptions.length)];
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã –∏ –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–∞ —Å–ª–∞–π–¥–∞
                const layout = getAdvancedSlideLayout(slide.type, slide.text);
                
                // –ü–æ–ª—É—á–∞–µ–º –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è —Å–ª–∞–π–¥–∞
                const slideKeywords = generateAdvancedSlideContent(slide.type, content.topic).keywords || [];
                
                return {
                    id: `advanced_slide_${Date.now()}_${index}`,
                    title: slide.title,
                    text: slide.text,
                    background: selectedGradient,
                    slideType: slide.type,
                    keywordType: slide.keywordType,
                    emotionalTone: slide.emotionalTone,
                    keywords: slideKeywords, // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
                    elements: [
                        // –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–ª–∞–π–¥–∞
                        {
                            id: `advanced_title_${Date.now()}_${index}`,
                            text: slide.title,
                            x: layout.title.x,
                            y: layout.title.y,
                            font: 'Inter',
                            size: layout.title.fontSize,
                            weight: 800,
                            color: '#ffffff'
                        },
                        // –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å–ª–∞–π–¥–∞ —Å –∞–≤—Ç–æ–≤—ã–¥–µ–ª–µ–Ω–∏–µ–º –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
                        {
                            id: `advanced_content_${Date.now()}_${index}`,
                            text: applyAutoKeywordHighlighting(slide.text, slideKeywords),
                            originalText: slide.text, // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç
                            x: layout.content.x,
                            y: layout.content.y,
                            font: 'Inter',
                            size: layout.content.fontSize,
                            weight: layout.content.fontWeight,
                            color: '#ffffff'
                        }
                    ]
                };
            });
            
            console.log(`‚úÖ ADVANCED AI: –°–æ–∑–¥–∞–Ω–æ ${slides.length} –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Å–ª–∞–π–¥–æ–≤`);
            return slides;
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –¥–ª—è AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
        function applyAutoKeywordHighlighting(text, keywords) {
            if (!keywords || keywords.length === 0) return text;
            
            let highlightedText = text;
            
            keywords.forEach(keyword => {
                const regex = new RegExp(`(${keyword})`, 'gi');
                highlightedText = highlightedText.replace(regex, (match) => {
                    return `<span class="keyword-highlight keyword-glow" style="color: #ffd700;">${match}</span>`;
                });
            });
            
            return highlightedText;
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π —Ä–∞—Å–∫–ª–∞–¥–∫–∏ —Å–ª–∞–π–¥–∞
        function getAdvancedSlideLayout(slideType, text) {
            // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–ª–∏–Ω—É —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π —Ä–∞—Å–∫–ª–∞–¥–∫–∏
            const textLength = text.length;
            const lineCount = text.split('\n').length;
            
            const layouts = {
                'hook': {
                    title: { x: 50, y: 15, fontSize: 28 },
                    content: { x: 50, y: 55, fontSize: 18, fontWeight: 500 }
                },
                'context': {
                    title: { x: 50, y: 18, fontSize: 24 },
                    content: { x: 50, y: 55, fontSize: 17, fontWeight: 500 }
                },
                'problem': {
                    title: { x: 50, y: 15, fontSize: 26 },
                    content: { x: 50, y: 55, fontSize: 17, fontWeight: 500 }
                },
                'agitation': {
                    title: { x: 50, y: 12, fontSize: 27 },
                    content: { x: 50, y: 55, fontSize: 17, fontWeight: 600 }
                },
                'solution': {
                    title: { x: 50, y: 18, fontSize: 25 },
                    content: { x: 50, y: 55, fontSize: 17, fontWeight: 500 }
                },
                'benefits': {
                    title: { x: 50, y: 15, fontSize: 26 },
                    content: { x: 50, y: 55, fontSize: 16, fontWeight: 500 }
                },
                'proof': {
                    title: { x: 50, y: 18, fontSize: 24 },
                    content: { x: 50, y: 55, fontSize: 16, fontWeight: 500 }
                },
                'objections': {
                    title: { x: 50, y: 20, fontSize: 24 },
                    content: { x: 50, y: 55, fontSize: 17, fontWeight: 500 }
                },
                'action': {
                    title: { x: 50, y: 15, fontSize: 26 },
                    content: { x: 50, y: 55, fontSize: 16, fontWeight: 500 }
                },
                'bonus': {
                    title: { x: 50, y: 18, fontSize: 25 },
                    content: { x: 50, y: 55, fontSize: 17, fontWeight: 500 }
                },
                'cta': {
                    title: { x: 50, y: 12, fontSize: 28 },
                    content: { x: 50, y: 55, fontSize: 17, fontWeight: 600 }
                }
            };
            
            const layout = layouts[slideType] || layouts.hook;
            
            // –ê–¥–∞–ø—Ç–∏—Ä—É–µ–º —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–ª–∏–Ω—ã —Ç–µ–∫—Å—Ç–∞
            if (textLength > 200) {
                layout.content.fontSize = Math.max(layout.content.fontSize - 2, 14);
            } else if (textLength < 100) {
                layout.content.fontSize = Math.min(layout.content.fontSize + 1, 20);
            }
            
            return layout;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª–∞–π–¥–æ–≤ –∏–∑ —Ç–µ–∫—Å—Ç–∞
        function generateFromText(text) {
            const paragraphs = text.split('\n\n').filter(p => p.trim().length > 0);
            
            return paragraphs.map((paragraph, index) => {
                const lines = paragraph.split('\n').filter(line => line.trim().length > 0);
                const title = lines[0] || `–°–ª–∞–π–¥ ${index + 1}`;
                const content = lines.slice(1).join(' ') || paragraph;
                
                return {
                    id: `slide_${Date.now()}_${index}`,
                    title: title,
                    text: content,
                    background: slideGradients[index % slideGradients.length],
                    elements: [
                        {
                            id: `title_${Date.now()}_${index}`,
                            text: title,
                            x: 50,
                            y: 25,
                            font: 'Inter',
                            size: 32,
                            weight: 800,
                            color: '#ffffff'
                        },
                        {
                            id: `text_${Date.now()}_${index}`,
                            text: content,
                            x: 50,
                            y: 60,
                            font: 'Inter',
                            size: 16,
                            weight: 500,
                            color: '#ffffff'
                        }
                    ]
                };
            });
        }
        // –ü–æ–∫–∞–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
        function showEditor() {
            welcomeScreen.classList.add('hidden');
            editorScreen.classList.remove('hidden');
            carouselControls.classList.remove('hidden');
            renderSlide();
        }

        // –°–∫—Ä—ã—Ç–∏–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
        function hideEditor() {
            editorScreen.classList.add('hidden');
            carouselControls.classList.add('hidden');
            welcomeScreen.classList.remove('hidden');
            deselectElement();
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–ª–∞–π–¥–∞
        function renderSlide() {
            if (currentSlides.length === 0) return;

            const slide = currentSlides[currentSlideIndex];
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–æ–Ω
            if (slide.backgroundImage) {
                applyBackgroundToSlide(slide);
                showBackgroundControls();
            } else {
                slideCanvas.style.background = slide.background;
                slideCanvas.style.transform = 'none';
                slideCanvas.style.filter = 'none';
                document.getElementById('backgroundControls').style.display = 'none';
            }
            
            slideCanvas.innerHTML = '';

            slide.elements.forEach(element => {
                const textElement = document.createElement('div');
                textElement.className = 'text-element';
                
                const fontFamily = `'${element.font}', sans-serif`;
                console.log(`–ü—Ä–∏–º–µ–Ω—è–µ–º —à—Ä–∏—Ñ—Ç: ${fontFamily} –∫ —ç–ª–µ–º–µ–Ω—Ç—É:`, element.text);
                
                textElement.style.cssText = `
                    left: ${element.x}%;
                    top: ${element.y}%;
                    font-family: ${fontFamily};
                    font-size: ${element.size}px;
                    font-weight: ${element.weight};
                    color: ${element.color};
                    transform: translate(-50%, -50%);
                `;
                
                // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ HTML –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
                if (element.text.includes('<span class="keyword-highlight')) {
                    textElement.innerHTML = element.text;
                } else {
                    textElement.textContent = element.text;
                }
                
                textElement.dataset.elementId = element.id;
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è drag & drop
                textElement.addEventListener('mousedown', startDrag);
                textElement.addEventListener('click', (e) => {
                    e.stopPropagation();
                    selectElement(element.id);
                });
                
                slideCanvas.appendChild(textElement);
            });

            updateNavigation();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function updateNavigation() {
            slideNumber.textContent = `${currentSlideIndex + 1}/${currentSlides.length}`;

            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
            indicators.innerHTML = '';
            currentSlides.forEach((_, index) => {
                const indicator = document.createElement('div');
                indicator.className = `indicator ${index === currentSlideIndex ? 'active' : ''}`;
                indicator.addEventListener('click', () => {
                    currentSlideIndex = index;
                    renderSlide();
                });
                indicators.appendChild(indicator);
            });

            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            prevBtn.disabled = currentSlideIndex === 0;
            nextBtn.disabled = currentSlideIndex === currentSlides.length - 1;
        }

        // –í—ã–±–æ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞
        function selectElement(elementId) {
            // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            document.querySelectorAll('.text-element').forEach(el => {
                el.classList.remove('selected');
            });

            // –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç
            const elementDiv = document.querySelector(`[data-element-id="${elementId}"]`);
            if (elementDiv) {
                elementDiv.classList.add('selected');
            }

            // –ù–∞—Ö–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç –≤ –¥–∞–Ω–Ω—ã—Ö
            const slide = currentSlides[currentSlideIndex];
            const element = slide.elements.find(e => e.id === elementId);
            
            if (element) {
                selectedElement = element;
                
                // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É
                textInput.value = element.text;
                fontSelect.value = element.font;
                sizeSlider.value = element.size;
                sizeValue.textContent = element.size + 'px';
                weightSelect.value = element.weight;
                colorInput.value = element.color;
                
                textControls.style.display = 'block';
            }
        }

        // –°–Ω—è—Ç–∏–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è
        function deselectElement() {
            document.querySelectorAll('.text-element').forEach(el => {
                el.classList.remove('selected');
            });
            selectedElement = null;
            textControls.style.display = 'none';
        }
        // Drag & Drop —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
        function startDrag(e) {
            e.preventDefault();
            const element = e.target;
            const elementId = element.dataset.elementId;
            
            if (!elementId) return;
            
            isDragging = true;
            element.classList.add('dragging');
            
            const rect = slideCanvas.getBoundingClientRect();
            const elementRect = element.getBoundingClientRect();
            
            dragOffset.x = e.clientX - elementRect.left - elementRect.width / 2;
            dragOffset.y = e.clientY - elementRect.top - elementRect.height / 2;
            
            selectElement(elementId);
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
        }

        function drag(e) {
            if (!isDragging || !selectedElement) return;
            
            const rect = slideCanvas.getBoundingClientRect();
            const x = ((e.clientX - rect.left - dragOffset.x) / rect.width) * 100;
            const y = ((e.clientY - rect.top - dragOffset.y) / rect.height) * 100;
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ —Å–ª–∞–π–¥–∞
            selectedElement.x = Math.max(5, Math.min(95, x));
            selectedElement.y = Math.max(5, Math.min(95, y));
            
            const elementDiv = document.querySelector(`[data-element-id="${selectedElement.id}"]`);
            if (elementDiv) {
                elementDiv.style.left = selectedElement.x + '%';
                elementDiv.style.top = selectedElement.y + '%';
            }
        }

        function stopDrag() {
            if (isDragging) {
                isDragging = false;
                document.querySelectorAll('.text-element').forEach(el => {
                    el.classList.remove('dragging');
                });
                
                document.removeEventListener('mousemove', drag);
                document.removeEventListener('mouseup', stopDrag);
            }
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
        function addTextElement() {
            if (currentSlides.length === 0) return;
            
            const slide = currentSlides[currentSlideIndex];
            const newElement = {
                id: `element_${Date.now()}_${textElementCounter++}`,
                text: '–ù–æ–≤—ã–π —Ç–µ–∫—Å—Ç',
                x: 50,
                y: 50,
                font: 'Inter',
                size: 24,
                weight: 500,
                color: '#ffffff'
            };
            
            slide.elements.push(newElement);
            renderSlide();
            selectElement(newElement.id);
            showToast('–¢–µ–∫—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω!');
        }

        // –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        function centerAllElements() {
            if (currentSlides.length === 0) return;
            
            const slide = currentSlides[currentSlideIndex];
            slide.elements.forEach((element, index) => {
                element.x = 50;
                element.y = 30 + (index * 15);
            });
            
            renderSlide();
            showToast('–í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã!');
        }

        // –û—á–∏—Å—Ç–∫–∞ —Å–ª–∞–π–¥–∞
        function clearSlide() {
            if (currentSlides.length === 0) return;
            
            const slide = currentSlides[currentSlideIndex];
            slide.elements = [];
            
            deselectElement();
            renderSlide();
            showToast('–°–ª–∞–π–¥ –æ—á–∏—â–µ–Ω!');
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç–∞
        function saveElement() {
            if (!selectedElement) return;
            
            selectedElement.text = textInput.value;
            selectedElement.font = fontSelect.value;
            selectedElement.size = parseInt(sizeSlider.value);
            selectedElement.weight = parseInt(weightSelect.value);
            selectedElement.color = colorInput.value;
            
            renderSlide();
            selectElement(selectedElement.id); // –ü–µ—Ä–µ—Å–µ–ª–µ–∫—Ç–∏–º –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
            showToast('–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞
        function deleteElement() {
            if (!selectedElement || currentSlides.length === 0) return;
            
            const slide = currentSlides[currentSlideIndex];
            slide.elements = slide.elements.filter(el => el.id !== selectedElement.id);
            
            deselectElement();
            renderSlide();
            showToast('–≠–ª–µ–º–µ–Ω—Ç —É–¥–∞–ª–µ–Ω!');
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–ª–∞–π–¥–∞
        function addSlide() {
            const newSlide = {
                id: `slide_${Date.now()}`,
                title: `–°–ª–∞–π–¥ ${currentSlides.length + 1}`,
                text: '–ù–æ–≤—ã–π —Å–ª–∞–π–¥\n–î–æ–±–∞–≤—å—Ç–µ –≤–∞—à –∫–æ–Ω—Ç–µ–Ω—Ç –∑–¥–µ—Å—å',
                background: slideGradients[currentSlides.length % slideGradients.length],
                elements: [
                    {
                        id: `title_${Date.now()}`,
                        text: `–°–ª–∞–π–¥ ${currentSlides.length + 1}`,
                        x: 50,
                        y: 30,
                        font: 'Inter',
                        size: 32,
                        weight: 800,
                        color: '#ffffff'
                    },
                    {
                        id: `text_${Date.now()}`,
                        text: '–ù–æ–≤—ã–π —Å–ª–∞–π–¥\n–î–æ–±–∞–≤—å—Ç–µ –≤–∞—à –∫–æ–Ω—Ç–µ–Ω—Ç –∑–¥–µ—Å—å',
                        x: 50,
                        y: 70,
                        font: 'Inter',
                        size: 18,
                        weight: 500,
                        color: '#ffffff'
                    }
                ]
            };
            
            currentSlides.push(newSlide);
            currentSlideIndex = currentSlides.length - 1;
            renderSlide();
            showToast('–°–ª–∞–π–¥ –¥–æ–±–∞–≤–ª–µ–Ω!');
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç–∞
        function saveElement() {
            if (!selectedElement) return;
            
            selectedElement.text = textInput.value;
            selectedElement.font = fontSelect.value;
            selectedElement.size = parseInt(sizeSlider.value);
            selectedElement.weight = parseInt(weightSelect.value);
            selectedElement.color = colorInput.value;
            
            renderSlide();
            selectElement(selectedElement.id);
            showToast('–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞
        function deleteElement() {
            if (!selectedElement) return;
            
            const slide = currentSlides[currentSlideIndex];
            slide.elements = slide.elements.filter(el => el.id !== selectedElement.id);
            
            deselectElement();
            renderSlide();
            showToast('–≠–ª–µ–º–µ–Ω—Ç —É–¥–∞–ª–µ–Ω!');
        }

        // –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        function centerAllElements() {
            if (currentSlides.length === 0) return;
            
            const slide = currentSlides[currentSlideIndex];
            slide.elements.forEach((element, index) => {
                element.x = 50;
                element.y = 20 + (index * 25);
            });
            
            renderSlide();
            showToast('–≠–ª–µ–º–µ–Ω—Ç—ã —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã!');
        }

        // –û—á–∏—Å—Ç–∫–∞ —Å–ª–∞–π–¥–∞
        function clearSlide() {
            if (currentSlides.length === 0) return;
            
            const slide = currentSlides[currentSlideIndex];
            slide.elements = [];
            
            deselectElement();
            renderSlide();
            showToast('–°–ª–∞–π–¥ –æ—á–∏—â–µ–Ω!');
        }
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–ª–∞–π–¥–∞
        function addSlide() {
            const newSlide = {
                id: `slide_${Date.now()}`,
                title: `–°–ª–∞–π–¥ ${currentSlides.length + 1}`,
                text: '–ù–æ–≤—ã–π —Å–ª–∞–π–¥',
                background: slideGradients[currentSlides.length % slideGradients.length],
                elements: [
                    {
                        id: `element_${Date.now()}`,
                        text: `–°–ª–∞–π–¥ ${currentSlides.length + 1}`,
                        x: 50,
                        y: 50,
                        font: 'Inter',
                        size: 32,
                        weight: 700,
                        color: '#ffffff'
                    }
                ]
            };
            
            currentSlides.push(newSlide);
            currentSlideIndex = currentSlides.length - 1;
            renderSlide();
            showToast('–°–ª–∞–π–¥ –¥–æ–±–∞–≤–ª–µ–Ω!');
        }

        // –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–∞–π–¥–∞
        function duplicateSlide() {
            if (currentSlides.length === 0) return;
            
            const currentSlide = currentSlides[currentSlideIndex];
            const duplicatedSlide = {
                ...currentSlide,
                id: `slide_${Date.now()}`,
                elements: currentSlide.elements.map(el => ({
                    ...el,
                    id: `element_${Date.now()}_${Math.random()}`
                }))
            };
            
            currentSlides.splice(currentSlideIndex + 1, 0, duplicatedSlide);
            currentSlideIndex++;
            renderSlide();
            showToast('–°–ª–∞–π–¥ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω!');
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —Å–ª–∞–π–¥–∞
        function deleteSlide() {
            if (currentSlides.length <= 1) {
                showToast('–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–ª–∞–π–¥!', 'error');
                return;
            }
            
            currentSlides.splice(currentSlideIndex, 1);
            if (currentSlideIndex >= currentSlides.length) {
                currentSlideIndex = currentSlides.length - 1;
            }
            
            renderSlide();
            showToast('–°–ª–∞–π–¥ —É–¥–∞–ª–µ–Ω!');
        }

        // –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏–¥–µ–∏ —Å Advanced AI
        async function expandIdea() {
            if (currentSlides.length === 0) return;
            
            const topic = currentSlides[0].title;
            showLoading(true, 'üöÄ ADVANCED AI: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ–º –∏–¥–µ—é...');
            
            setTimeout(() => {
                loadingText.textContent = 'üß† –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç...';
            }, 500);
            
            setTimeout(() => {
                loadingText.textContent = 'üí° –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã...';
            }, 1200);
            
            setTimeout(() => {
                loadingText.textContent = 'üéØ –°–æ–∑–¥–∞–µ–º —Ü–µ–ª–µ–≤—ã–µ —Å–ª–∞–π–¥—ã...';
            }, 1800);
            
            try {
                const additionalSlides = await generateAdvancedAdditionalSlides(topic);
                currentSlides = [...currentSlides, ...additionalSlides];
                
                renderSlide();
                showToast(`üéâ ADVANCED AI –¥–æ–±–∞–≤–∏–ª ${additionalSlides.length} —Å–ª–∞–π–¥–æ–≤!\n–ù–æ–≤—ã–µ —Ç–∏–ø—ã: ${additionalSlides.map(s => s.slideType).join(', ')}`);
            } catch (error) {
                showToast('–û—à–∏–±–∫–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏–¥–µ–∏', 'error');
            } finally {
                showLoading(false);
            }
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–ª–∞–π–¥–æ–≤
        async function generateAdvancedAdditionalSlides(topic) {
            await new Promise(resolve => setTimeout(resolve, 2500));
            
            const advancedTemplates = [
                {
                    type: 'case_study',
                    title: '–ö–µ–π—Å-—Å—Ç–∞–¥–∏',
                    text: `–†–µ–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä —É—Å–ø–µ—Ö–∞ —Å ${topic.toLowerCase()}\n\n–ö–æ–º–ø–∞–Ω–∏—è X —É–≤–µ–ª–∏—á–∏–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ 400%\n–ò—Å–ø–æ–ª—å–∑—É—è —ç—Ç–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∑–∞ 3 –º–µ—Å—è—Ü–∞\n–í–æ—Ç –∫–∞–∫ –æ–Ω–∏ —ç—Ç–æ —Å–¥–µ–ª–∞–ª–∏`,
                    keywordType: 'conceptual',
                    gradient: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'
                },
                {
                    type: 'mistakes',
                    title: '–¢–æ–ø-5 –æ—à–∏–±–æ–∫',
                    text: `–°–∞–º—ã–µ –¥–æ—Ä–æ–≥–∏–µ –æ—à–∏–±–∫–∏ –≤ ${topic.toLowerCase()}\n\n‚ùå –û—à–∏–±–∫–∞ #1: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥\n‚ùå –û—à–∏–±–∫–∞ #2: –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å–Ω–æ–≤\n‚ùå –û—à–∏–±–∫–∞ #3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–∏—Å—Ç–µ–º—ã\n‚ùå –û—à–∏–±–∫–∞ #4: –ù–µ—Ç –∏–∑–º–µ—Ä–µ–Ω–∏–π\n‚ùå –û—à–∏–±–∫–∞ #5: –°–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ`,
                    keywordType: 'emotional',
                    gradient: 'linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)'
                },
                {
                    type: 'tools',
                    title: '–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã',
                    text: `–õ—É—á—à–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è ${topic.toLowerCase()}\n\nüõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç A - –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö\nüõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç B - –¥–ª—è –ø—Ä–æ—Ñ–∏\nüõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç C - –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏\nüõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç D - –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏`,
                    keywordType: 'conceptual',
                    gradient: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)'
                },
                {
                    type: 'trends',
                    title: '–¢—Ä–µ–Ω–¥—ã 2024',
                    text: `–ì–ª–∞–≤–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã –≤ ${topic.toLowerCase()} –Ω–∞ 2024 –≥–æ–¥\n\nüìà –¢—Ä–µ–Ω–¥ #1: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤\nüìà –¢—Ä–µ–Ω–¥ #2: –ò–ò-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è\nüìà –¢—Ä–µ–Ω–¥ #3: –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è\nüìà –¢—Ä–µ–Ω–¥ #4: –≠–∫–æ–ª–æ–≥–∏—á–Ω–æ—Å—Ç—å`,
                    keywordType: 'conceptual',
                    gradient: 'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)'
                },
                {
                    type: 'checklist',
                    title: '–ß–µ–∫-–ª–∏—Å—Ç',
                    text: `–ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è —É—Å–ø–µ—Ö–∞ –≤ ${topic.toLowerCase()}\n\n‚òëÔ∏è –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ü–µ–ª–∏\n‚òëÔ∏è –ò–∑—É—á–∏—Ç—å –æ—Å–Ω–æ–≤—ã\n‚òëÔ∏è –í—ã–±—Ä–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã\n‚òëÔ∏è –°–æ–∑–¥–∞—Ç—å –ø–ª–∞–Ω\n‚òëÔ∏è –ù–∞—á–∞—Ç—å –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å\n‚òëÔ∏è –ò–∑–º–µ—Ä—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã`,
                    keywordType: 'conceptual',
                    gradient: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)'
                }
            ];
            
            const startIndex = currentSlides.length;
            return advancedTemplates.map((template, index) => ({
                id: `expand_advanced_${Date.now()}_${index}`,
                title: template.title,
                text: template.text,
                background: template.gradient,
                slideType: template.type,
                keywordType: template.keywordType,
                emotionalTone: '–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–π, –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π',
                elements: [
                    {
                        id: `expand_advanced_title_${Date.now()}_${index}`,
                        text: template.title,
                        x: 50,
                        y: 20,
                        font: 'Inter',
                        size: 32,
                        weight: 800,
                        color: '#ffffff'
                    },
                    {
                        id: `expand_advanced_text_${Date.now()}_${index}`,
                        text: template.text,
                        x: 50,
                        y: 60,
                        font: 'Inter',
                        size: 16,
                        weight: 500,
                        color: '#ffffff'
                    }
                ]
            }));
        }
        // –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Å–ª–∞–π–¥–∞ —Å –≤—ã–±–æ—Ä–æ–º —Ñ–æ—Ä–º–∞—Ç–∞ –∏ –∫–∞—á–µ—Å—Ç–≤–∞
        async function downloadSlide() {
            if (currentSlides.length === 0) return;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —Ñ–æ—Ä–º–∞—Ç–∞
            showExportModal(false);
        }

        // –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–ª–∞–π–¥–æ–≤ —Å –≤—ã–±–æ—Ä–æ–º —Ñ–æ—Ä–º–∞—Ç–∞ –∏ –∫–∞—á–µ—Å—Ç–≤–∞
        async function downloadAllSlides() {
            if (currentSlides.length === 0) return;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —Ñ–æ—Ä–º–∞—Ç–∞
            showExportModal(true);
        }

        // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —Ñ–æ—Ä–º–∞—Ç–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞
        function showExportModal(isAllSlides) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;
            
            const availableFormats = currentPlan.exportFormats;
            const availableQualities = currentPlan.exportQualities;
            
            modal.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    padding: 40px;
                    border-radius: 20px;
                    text-align: center;
                    color: white;
                    max-width: 400px;
                    margin: 20px;
                ">
                    <h2 style="margin-bottom: 20px; font-size: 24px;">üì• –≠–∫—Å–ø–æ—Ä—Ç ${isAllSlides ? '–≤—Å–µ—Ö —Å–ª–∞–π–¥–æ–≤' : '—Å–ª–∞–π–¥–∞'}</h2>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 10px; font-weight: 600;">–§–æ—Ä–º–∞—Ç:</label>
                        <select id="exportFormat" style="width: 100%; padding: 8px; border-radius: 8px; border: none;">
                            ${availableFormats.map(format => `<option value="${format}">${format}</option>`).join('')}
                        </select>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <label style="display: block; margin-bottom: 10px; font-weight: 600;">–ö–∞—á–µ—Å—Ç–≤–æ:</label>
                        <select id="exportQuality" style="width: 100%; padding: 8px; border-radius: 8px; border: none;">
                            ${availableQualities.map(quality => {
                                const sizes = {
                                    '720p': '1280x1280',
                                    '1080p': '1920x1920', 
                                    '4K': '3840x3840'
                                };
                                return `<option value="${quality}">${quality} (${sizes[quality]})</option>`;
                            }).join('')}
                        </select>
                    </div>
                    
                    ${currentPlan.name === 'FREE' ? `
                        <p style="margin-bottom: 20px; opacity: 0.8; font-size: 12px;">
                            FREE –ø–ª–∞–Ω: —Ç–æ–ª—å–∫–æ PNG 720p<br>
                            <a href="#" onclick="showUpgradeModal(); this.closest('.modal').remove();" style="color: #ffd700;">–û–±–Ω–æ–≤–∏—Ç—å—Å—è –¥–æ PRO</a>
                        </p>
                    ` : ''}
                    
                    <div style="display: flex; gap: 10px;">
                        <button onclick="this.closest('div').parentElement.remove()" 
                                style="flex: 1; padding: 12px; border: none; border-radius: 8px; background: rgba(255,255,255,0.2); color: white; cursor: pointer;">
                            –û—Ç–º–µ–Ω–∞
                        </button>
                        <button onclick="executeExport(${isAllSlides}); this.closest('div').parentElement.remove();" 
                                style="flex: 1; padding: 12px; border: none; border-radius: 8px; background: #28a745; color: white; cursor: pointer; font-weight: 600;">
                            –≠–∫—Å–ø–æ—Ä—Ç
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–∞
        async function executeExport(isAllSlides) {
            const format = document.getElementById('exportFormat').value;
            const quality = document.getElementById('exportQuality').value;
            
            const qualitySettings = {
                '720p': { scale: 1.5, width: 1280, height: 1280 },
                '1080p': { scale: 2, width: 1920, height: 1920 },
                '4K': { scale: 4, width: 3840, height: 3840 }
            };
            
            const settings = qualitySettings[quality];
            
            if (isAllSlides) {
                await exportAllSlides(format, settings);
            } else {
                await exportSingleSlide(format, settings);
            }
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –æ–¥–Ω–æ–≥–æ —Å–ª–∞–π–¥–∞ (–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø)
        async function exportSingleSlide(format, settings) {
            console.log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º —ç–∫—Å–ø–æ—Ä—Ç —Å–ª–∞–π–¥–∞:', { format, settings });
            
            try {
                showLoading(true, `–≠–∫—Å–ø–æ—Ä—Ç –≤ ${format} ${settings.width}x${settings.height}...`);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫
                if (typeof html2canvas === 'undefined') {
                    throw new Error('html2canvas –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
                }
                
                if (format === 'PDF' && typeof window.jspdf === 'undefined') {
                    throw new Error('jsPDF –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
                }
                
                // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —Å–ª–∞–π–¥–∞
                if (!slideCanvas) {
                    throw new Error('–≠–ª–µ–º–µ–Ω—Ç slideCanvas –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }
                
                // –í—Ä–µ–º–µ–Ω–Ω–æ —Å–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                const elementsToHide = [
                    document.getElementById('slideNumber'),
                    ...document.querySelectorAll('.nav-btn'),
                    ...document.querySelectorAll('.indicator')
                ].filter(el => el);
                
                const originalStyles = elementsToHide.map(el => ({
                    element: el,
                    display: el.style.display,
                    visibility: el.style.visibility
                }));
                
                elementsToHide.forEach(el => {
                    el.style.display = 'none';
                    el.style.visibility = 'hidden';
                });
                
                console.log('üì± –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∫—Ä—ã—Ç—ã');
                
                // –ñ–¥–µ–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ html2canvas —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
                const html2canvasOptions = {
                    backgroundColor: format === 'JPEG' ? '#ffffff' : null,
                    scale: Math.min(settings.scale, 2), // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –º–∞—Å—à—Ç–∞–±
                    width: settings.width,
                    height: settings.height,
                    useCORS: true,
                    allowTaint: true,
                    foreignObjectRendering: true,
                    logging: false,
                    removeContainer: true,
                    imageTimeout: 10000,
                    onclone: function(clonedDoc) {
                        console.log('üìã –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–æ');
                        
                        // –ò—Å–ø—Ä–∞–≤–ª—è–µ–º —à—Ä–∏—Ñ—Ç—ã –≤ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ
                        const clonedElements = clonedDoc.querySelectorAll('*');
                        clonedElements.forEach(el => {
                            const computedStyle = window.getComputedStyle(el);
                            if (computedStyle.fontFamily) {
                                el.style.fontFamily = computedStyle.fontFamily;
                            }
                        });
                    }
                };
                
                console.log('üé® –ó–∞–ø—É—Å–∫–∞–µ–º html2canvas...');
                
                // –°–æ–∑–¥–∞–µ–º canvas
                const canvas = await html2canvas(slideCanvas, html2canvasOptions);
                
                console.log('‚úÖ html2canvas –∑–∞–≤–µ—Ä—à–µ–Ω:', {
                    width: canvas.width,
                    height: canvas.height
                });
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                originalStyles.forEach(({ element, display, visibility }) => {
                    element.style.display = display;
                    element.style.visibility = visibility;
                });
                
                // –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª
                const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
                const filename = `flashpost_slide_${currentSlideIndex + 1}_${timestamp}`;
                
                if (format === 'PNG') {
                    const dataURL = canvas.toDataURL('image/png');
                    downloadFile(dataURL, `${filename}.png`);
                    
                } else if (format === 'JPEG') {
                    const dataURL = canvas.toDataURL('image/jpeg', 0.92);
                    downloadFile(dataURL, `${filename}.jpeg`);
                    
                } else if (format === 'PDF') {
                    const { jsPDF } = window.jspdf;
                    
                    const pdf = new jsPDF({
                        orientation: settings.width > settings.height ? 'landscape' : 'portrait',
                        unit: 'px',
                        format: [settings.width, settings.height],
                        compress: true
                    });
                    
                    const imgData = canvas.toDataURL('image/png', 1.0);
                    pdf.addImage(imgData, 'PNG', 0, 0, settings.width, settings.height, undefined, 'FAST');
                    pdf.save(`${filename}.pdf`);
                    
                    showToast(`üìÑ –°–ª–∞–π–¥ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ PDF!`);
                    updateStats('exportsCompleted');
                    return;
                }
                
                showToast(`üì• –°–ª–∞–π–¥ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ ${format}!`);
                updateStats('exportsCompleted');
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞:', error);
                
                let errorMessage = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞';
                
                if (error.message.includes('html2canvas') || error.message.includes('–Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω')) {
                    errorMessage = '–û—à–∏–±–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.';
                } else if (error.message.includes('jsPDF')) {
                    errorMessage = '–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è PDF. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ PNG –∏–ª–∏ JPEG.';
                } else if (error.message.includes('Memory') || error.message.includes('out of memory')) {
                    errorMessage = '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–º–µ–Ω—å—à–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ.';
                } else if (error.message.includes('CORS')) {
                    errorMessage = '–û—à–∏–±–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã.';
                }
                
                showToast(`‚ùå ${errorMessage}`, 'error');
                
                // –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç
                setTimeout(() => {
                    if (confirm('–≠–∫—Å–ø–æ—Ä—Ç –Ω–µ —É–¥–∞–ª—Å—è. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å –±–∞–∑–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ (720p)?')) {
                        const simpleSettings = { scale: 1, width: 720, height: 720 };
                        exportSingleSlide('PNG', simpleSettings);
                    }
                }, 2000);
                
            } finally {
                showLoading(false);
            }
        }
        
        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
        function downloadFile(dataURL, filename) {
            try {
                const link = document.createElement('a');
                link.href = dataURL;
                link.download = filename;
                link.style.display = 'none';
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                console.log(`‚úÖ –§–∞–π–ª ${filename} —Å–∫–∞—á–∞–Ω`);
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è:', error);
                
                // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥
                try {
                    const blob = dataURLToBlob(dataURL);
                    const url = URL.createObjectURL(blob);
                    
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = filename;
                    link.click();
                    
                    URL.revokeObjectURL(url);
                    console.log(`‚úÖ –§–∞–π–ª —Å–∫–∞—á–∞–Ω (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥)`);
                } catch (altError) {
                    showToast('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª', 'error');
                }
            }
        }
        
        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è dataURL –≤ Blob
        function dataURLToBlob(dataURL) {
            const arr = dataURL.split(',');
            const mime = arr[0].match(/:(.*?);/)[1];
            const bstr = atob(arr[1]);
            let n = bstr.length;
            const u8arr = new Uint8Array(n);
            
            while (n--) {
                u8arr[n] = bstr.charCodeAt(n);
            }
            
            return new Blob([u8arr], { type: mime });
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö —Å–ª–∞–π–¥–æ–≤ (–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø)
        async function exportAllSlides(format, settings) {
            console.log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º —ç–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö —Å–ª–∞–π–¥–æ–≤:', { format, settings, count: currentSlides.length });
            
            try {
                showLoading(true, `–≠–∫—Å–ø–æ—Ä—Ç ${currentSlides.length} —Å–ª–∞–π–¥–æ–≤...`);
                
                const originalSlideIndex = currentSlideIndex;
                const slideNumberEl = document.getElementById('slideNumber');
                let exportedCount = 0;
                
                for (let i = 0; i < currentSlides.length; i++) {
                    try {
                        console.log(`üìÑ –≠–∫—Å–ø–æ—Ä—Ç —Å–ª–∞–π–¥–∞ ${i + 1}/${currentSlides.length}`);
                        
                        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ —Å–ª–∞–π–¥
                        currentSlideIndex = i;
                        renderSlide();
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
                        const progress = Math.round((i / currentSlides.length) * 80) + 10;
                        updateProgress(progress, `–≠–∫—Å–ø–æ—Ä—Ç —Å–ª–∞–π–¥–∞ ${i + 1}/${currentSlides.length}...`);
                        
                        // –ñ–¥–µ–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
                        await new Promise(resolve => setTimeout(resolve, 800));
                        
                        // –°–∫—Ä—ã–≤–∞–µ–º –Ω–æ–º–µ—Ä —Å–ª–∞–π–¥–∞
                        slideNumberEl.style.display = 'none';
                        
                        // –°–æ–∑–¥–∞–µ–º canvas –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Å–ª–∞–π–¥–∞
                        const canvas = await html2canvas(slideCanvas, {
                            backgroundColor: format === 'JPEG' ? '#ffffff' : null,
                            scale: Math.min(settings.scale, 1.5), // –£–º–µ–Ω—å—à–∞–µ–º –º–∞—Å—à—Ç–∞–± –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
                            width: settings.width,
                            height: settings.height,
                            useCORS: true,
                            allowTaint: true,
                            logging: false,
                            imageTimeout: 8000
                        });
                        
                        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–º–µ—Ä —Å–ª–∞–π–¥–∞
                        slideNumberEl.style.display = 'block';
                        
                        // –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª
                        const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
                        const filename = `flashpost_slide_${i + 1}_${timestamp}`;
                        
                        if (format === 'PNG') {
                            const dataURL = canvas.toDataURL('image/png');
                            downloadFile(dataURL, `${filename}.png`);
                        } else if (format === 'JPEG') {
                            const dataURL = canvas.toDataURL('image/jpeg', 0.9);
                            downloadFile(dataURL, `${filename}.jpeg`);
                        } else if (format === 'PDF') {
                            const { jsPDF } = window.jspdf;
                            const pdf = new jsPDF({
                                orientation: 'portrait',
                                unit: 'px',
                                format: [settings.width, settings.height]
                            });
                            
                            const imgData = canvas.toDataURL('image/png');
                            pdf.addImage(imgData, 'PNG', 0, 0, settings.width, settings.height);
                            pdf.save(`${filename}.pdf`);
                        }
                        
                        exportedCount++;
                        
                        // –ü–∞—É–∑–∞ –º–µ–∂–¥—É —ç–∫—Å–ø–æ—Ä—Ç–∞–º–∏
                        await new Promise(resolve => setTimeout(resolve, 500));
                        
                    } catch (slideError) {
                        console.error(`‚ùå –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å–ª–∞–π–¥–∞ ${i + 1}:`, slideError);
                        showToast(`‚ö†Ô∏è –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å–ª–∞–π–¥–∞ ${i + 1}`, 'warning');
                        // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —ç–∫—Å–ø–æ—Ä—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª–∞–π–¥–æ–≤
                    }
                }
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Å–ª–∞–π–¥
                currentSlideIndex = originalSlideIndex;
                renderSlide();
                
                updateProgress(100, '–≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!');
                
                if (exportedCount > 0) {
                    showToast(`‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${exportedCount}/${currentSlides.length} —Å–ª–∞–π–¥–æ–≤ –≤ ${format}!`);
                    updateStats('exportsCompleted');
                } else {
                    showToast('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∏ –æ–¥–Ω–æ–≥–æ —Å–ª–∞–π–¥–∞', 'error');
                }
                
            } catch (error) {
                console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤—Å–µ—Ö —Å–ª–∞–π–¥–æ–≤:', error);
                showToast('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞', 'error');
            } finally {
                showLoading(false);
            }
        }

        // ===== –°–ò–°–¢–ï–ú–ê –®–ê–ë–õ–û–ù–û–í =====
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
        function saveTemplate() {
            if (currentSlides.length === 0) {
                showToast('–ù–µ—Ç —Å–ª–∞–π–¥–æ–≤ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ —à–∞–±–ª–æ–Ω', 'error');
                return;
            }
            
            if (!checkLimit('templates')) {
                showUpgradeModal();
                return;
            }
            
            const name = prompt('–ù–∞–∑–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞:', `–®–∞–±–ª–æ–Ω ${templates.length + 1}`);
            if (!name) return;
            
            const currentSlide = currentSlides[currentSlideIndex];
            const newTemplate = {
                id: templates.length + 1,
                name: name,
                background: currentSlide.background,
                textStyle: currentSlide.elements.length > 0 ? {
                    font: currentSlide.elements[0].font,
                    size: currentSlide.elements[0].size,
                    weight: currentSlide.elements[0].weight,
                    color: currentSlide.elements[0].color
                } : { font: 'Inter', size: 24, weight: 600, color: '#ffffff' }
            };
            
            templates.push(newTemplate);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem('flashpost_templates', JSON.stringify(templates));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateTemplateGrid();
            showToast(`üíæ –®–∞–±–ª–æ–Ω "${name}" —Å–æ—Ö—Ä–∞–Ω–µ–Ω!`);
        }
        
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
        function applyTemplate(templateId) {
            const template = templates.find(t => t.id === templateId);
            if (!template) return;
            
            if (currentSlides.length === 0) {
                showToast('–°–æ–∑–¥–∞–π—Ç–µ —Å–ª–∞–π–¥—ã –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–∞', 'error');
                return;
            }
            
            const currentSlide = currentSlides[currentSlideIndex];
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–æ–Ω
            currentSlide.background = template.background;
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏ –∫ —Ç–µ–∫—Å—Ç–æ–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–∞–º
            currentSlide.elements.forEach(element => {
                element.font = template.textStyle.font;
                element.size = template.textStyle.size;
                element.weight = template.textStyle.weight;
                element.color = template.textStyle.color;
            });
            
            renderSlide();
            showToast(`üé® –ü—Ä–∏–º–µ–Ω–µ–Ω —à–∞–±–ª–æ–Ω: ${template.name}`);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ç–∫–∏ —à–∞–±–ª–æ–Ω–æ–≤
        function updateTemplateGrid() {
            const grid = document.getElementById('templateGrid');
            grid.innerHTML = '';
            
            templates.forEach(template => {
                const item = document.createElement('div');
                item.className = 'template-item';
                item.dataset.template = template.id;
                item.innerHTML = `
                    <div class="template-preview" style="background: ${template.background};"></div>
                    <div class="template-name">${template.name}</div>
                `;
                item.onclick = () => selectTemplate(template.id);
                grid.appendChild(item);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É "–ù–æ–≤—ã–π"
            const newItem = document.createElement('div');
            newItem.className = 'template-item';
            newItem.dataset.template = 'new';
            newItem.innerHTML = `
                <div class="template-preview" style="background: #f8f9fa; display: flex; align-items: center; justify-content: center; color: #6c757d;">+</div>
                <div class="template-name">–ù–æ–≤—ã–π</div>
            `;
            newItem.onclick = () => saveTemplate();
            grid.appendChild(newItem);
        }
        
        // –í—ã–±–æ—Ä —à–∞–±–ª–æ–Ω–∞
        function selectTemplate(templateId) {
            // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏—Ö —à–∞–±–ª–æ–Ω–æ–≤
            document.querySelectorAll('.template-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω
            const selectedItem = document.querySelector(`[data-template="${templateId}"]`);
            if (selectedItem) {
                selectedItem.classList.add('selected');
            }
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —à–∞–±–ª–æ–Ω
            if (templateId !== 'new') {
                applyTemplate(templateId);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤ –∏–∑ localStorage
        function loadTemplates() {
            try {
                const saved = localStorage.getItem('flashpost_templates');
                if (saved) {
                    const savedTemplates = JSON.parse(saved);
                    // –û–±—ä–µ–¥–∏–Ω—è–µ–º —Å –±–∞–∑–æ–≤—ã–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏, –∏–∑–±–µ–≥–∞—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
                    const baseIds = templates.map(t => t.id);
                    const newTemplates = savedTemplates.filter(t => !baseIds.includes(t.id));
                    templates = [...templates, ...newTemplates];
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —à–∞–±–ª–æ–Ω–æ–≤:', error);
            }
            updateTemplateGrid();
        }
        
        // ===== –†–ê–ë–û–¢–ê –° –§–û–ù–ê–ú–ò =====
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞–∫ —Ñ–æ–Ω
        function uploadBackground() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                if (currentSlides.length === 0) {
                    showToast('–°–æ–∑–¥–∞–π—Ç–µ —Å–ª–∞–π–¥—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ–Ω–∞', 'error');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const currentSlide = currentSlides[currentSlideIndex];
                    currentSlide.backgroundImage = e.target.result;
                    currentSlide.backgroundSettings = { ...backgroundSettings };
                    
                    applyBackgroundToSlide(currentSlide);
                    showBackgroundControls();
                    showToast('üñºÔ∏è –§–æ–Ω –∑–∞–≥—Ä—É–∂–µ–Ω!');
                };
                reader.readAsDataURL(file);
            };
            
            input.click();
        }
        
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ –∫ —Å–ª–∞–π–¥—É
        function applyBackgroundToSlide(slide) {
            const canvas = document.getElementById('slideCanvas');
            const settings = slide.backgroundSettings || backgroundSettings;
            
            if (slide.backgroundImage) {
                const transform = `scale(${settings.scale / 100}) translate(${settings.x}%, ${settings.y}%)`;
                const filter = `blur(${settings.blur}px) brightness(${1 - settings.darken / 100})`;
                
                canvas.style.background = `url(${slide.backgroundImage})`;
                canvas.style.backgroundSize = 'cover';
                canvas.style.backgroundPosition = 'center';
                canvas.style.transform = transform;
                canvas.style.filter = filter;
            } else if (slide.background) {
                canvas.style.background = slide.background;
                canvas.style.transform = 'none';
                canvas.style.filter = 'none';
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—ã —Ñ–æ–Ω–∞
        function showBackgroundControls() {
            const controls = document.getElementById('backgroundControls');
            const currentSlide = currentSlides[currentSlideIndex];
            
            if (currentSlide && currentSlide.backgroundImage) {
                controls.style.display = 'block';
                
                const settings = currentSlide.backgroundSettings || backgroundSettings;
                document.getElementById('backgroundDarken').value = settings.darken;
                document.getElementById('backgroundBlur').value = settings.blur;
                document.getElementById('backgroundScale').value = settings.scale;
                document.getElementById('backgroundX').value = settings.x;
                document.getElementById('backgroundY').value = settings.y;
                
                updateBackgroundValues();
            } else {
                controls.style.display = 'none';
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤ —Ñ–æ–Ω–∞
        function updateBackgroundValues() {
            document.getElementById('darkenValue').textContent = document.getElementById('backgroundDarken').value + '%';
            document.getElementById('blurValue').textContent = document.getElementById('backgroundBlur').value + 'px';
            document.getElementById('scaleValue').textContent = document.getElementById('backgroundScale').value + '%';
            document.getElementById('xValue').textContent = document.getElementById('backgroundX').value + '%';
            document.getElementById('yValue').textContent = document.getElementById('backgroundY').value + '%';
        }
        
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ –∫–æ –≤—Å–µ–º —Å–ª–∞–π–¥–∞–º
        function applyBackgroundToAll() {
            if (currentSlides.length === 0) return;
            
            const currentSlide = currentSlides[currentSlideIndex];
            const backgroundToApply = currentSlide.background || currentSlide.backgroundImage;
            const settingsToApply = currentSlide.backgroundSettings || backgroundSettings;
            
            if (!backgroundToApply) {
                showToast('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ–Ω –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Å–ª–∞–π–¥–∞', 'error');
                return;
            }
            
            currentSlides.forEach(slide => {
                if (currentSlide.backgroundImage) {
                    slide.backgroundImage = currentSlide.backgroundImage;
                    slide.backgroundSettings = { ...settingsToApply };
                } else {
                    slide.background = backgroundToApply;
                }
            });
            
            renderSlide();
            showToast(`–§–æ–Ω –ø—Ä–∏–º–µ–Ω–µ–Ω –∫–æ –≤—Å–µ–º ${currentSlides.length} —Å–ª–∞–π–¥–∞–º!`);
        }
        
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ —Ç–æ–ª—å–∫–æ –∫ –ø–µ—Ä–≤–æ–º—É —Å–ª–∞–π–¥—É
        function applyBackgroundToFirst() {
            if (currentSlides.length === 0) return;
            
            const currentSlide = currentSlides[currentSlideIndex];
            const backgroundToApply = currentSlide.background || currentSlide.backgroundImage;
            const settingsToApply = currentSlide.backgroundSettings || backgroundSettings;
            
            if (!backgroundToApply) {
                showToast('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ–Ω –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Å–ª–∞–π–¥–∞', 'error');
                return;
            }
            
            const firstSlide = currentSlides[0];
            if (currentSlide.backgroundImage) {
                firstSlide.backgroundImage = currentSlide.backgroundImage;
                firstSlide.backgroundSettings = { ...settingsToApply };
            } else {
                firstSlide.background = backgroundToApply;
            }
            
            if (currentSlideIndex === 0) {
                renderSlide();
            }
            
            showToast('–§–æ–Ω –ø—Ä–∏–º–µ–Ω–µ–Ω –∫ –ø–µ—Ä–≤–æ–º—É —Å–ª–∞–π–¥—É!');
        }
        
        // ===== –í–´–î–ï–õ–ï–ù–ò–ï –ö–õ–Æ–ß–ï–í–´–• –°–õ–û–í =====
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
        function autoHighlightKeywords(text) {
            // –°–ø–∏—Å–æ–∫ –≤–∞–∂–Ω—ã—Ö —Å–ª–æ–≤ –¥–ª—è –∞–≤—Ç–æ–≤—ã–¥–µ–ª–µ–Ω–∏—è
            const autoKeywords = [
                '–≤–∞–∂–Ω–æ', '–≤–Ω–∏–º–∞–Ω–∏–µ', '—Å—Ä–æ—á–Ω–æ', '–Ω–æ–≤—ã–π', '–±–µ—Å–ø–ª–∞—Ç–Ω–æ', '—Å–∫–∏–¥–∫–∞', '–∞–∫—Ü–∏—è',
                '—Ä–µ–∑—É–ª—å—Ç–∞—Ç', '—É—Å–ø–µ—Ö', '–ø—Ä–∏–±—ã–ª—å', '–¥–æ—Ö–æ–¥', '—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ', '–±—ã—Å—Ç—Ä–æ',
                '–≥–∞—Ä–∞–Ω—Ç–∏—è', '–∫–∞—á–µ—Å—Ç–≤–æ', '–ª—É—á—à–∏–π', '—Ç–æ–ø', '—ç–∫—Å–∫–ª—é–∑–∏–≤', '—É–Ω–∏–∫–∞–ª—å–Ω—ã–π',
                '–ø—Ä–æ–±–ª–µ–º–∞', '—Ä–µ—à–µ–Ω–∏–µ', '—Å–µ–∫—Ä–µ—Ç', '–º–µ—Ç–æ–¥', '—Å–ø–æ—Å–æ–±', '—Å–∏—Å—Ç–µ–º–∞'
            ];
            
            let highlightedText = text;
            
            autoKeywords.forEach(keyword => {
                const regex = new RegExp(`\\b(${keyword})\\b`, 'gi');
                highlightedText = highlightedText.replace(regex, (match) => {
                    return `<span class="keyword-highlight keyword-glow" style="color: #ffff00;">${match}</span>`;
                });
            });
            
            return highlightedText;
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –∏–∑ —Ç–µ–∫—Å—Ç–∞
        function detectKeywords(text) {
            // –£–±–∏—Ä–∞–µ–º –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è –∏ –ø—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
            const cleanText = text.toLowerCase().replace(/[^\w\s–∞-—è—ë]/gi, ' ');
            
            // –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —Å–ª–æ–≤–∞
            const words = cleanText.split(/\s+/).filter(word => word.length > 2);
            
            // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —á–∞—Å—Ç–æ—Ç—É —Å–ª–æ–≤
            const wordCount = {};
            words.forEach(word => {
                wordCount[word] = (wordCount[word] || 0) + 1;
            });
            
            // –ò—Å–∫–ª—é—á–∞–µ–º —Å—Ç–æ–ø-—Å–ª–æ–≤–∞
            const stopWords = [
                '—ç—Ç–æ', '–¥–ª—è', '–∫–∞–∫', '—á—Ç–æ', '–≤—Å–µ', '–∏–ª–∏', '–ø—Ä–∏', '—Ç–∞–∫', '–µ–≥–æ', '–æ–Ω–∞', '–æ–Ω–∏',
                '–º—ã', '–≤—ã', '–æ–Ω', '–æ–Ω–∞', '–æ–Ω–æ', '–∏—Ö', '–Ω–∞—à', '–≤–∞—à', '—Å–≤–æ–π', '—Ç–æ—Ç', '—ç—Ç–æ—Ç',
                '–∫–æ—Ç–æ—Ä—ã–π', '–∫–∞–∫–æ–π', '–≥–¥–µ', '–∫–æ–≥–¥–∞', '–ø–æ—á–µ–º—É', '–∑–∞—á–µ–º', '–µ—Å–ª–∏', '—á—Ç–æ–±—ã',
                '–º–æ–∂–µ—Ç', '–¥–æ–ª–∂–µ–Ω', '–Ω—É–∂–Ω–æ', '–º–æ–∂–Ω–æ', '–µ—Å—Ç—å', '–±—ã–ª', '–±—ã–ª–∞', '–±—ã–ª–æ', '–±—ã–ª–∏',
                '–±—É–¥–µ—Ç', '–±—É–¥—É', '–±—É–¥–µ–º', '–±—É–¥–µ—Ç–µ', '–±—É–¥—É—Ç', '–∏–º–µ–µ—Ç', '–∏–º–µ–ª', '–∏–º–µ–ª–∞',
                '—Ç–∞–∫–∂–µ', '—Ç–æ–ª—å–∫–æ', '—É–∂–µ', '–µ—â–µ', '–¥–∞–∂–µ', '–æ—á–µ–Ω—å', '–±–æ–ª–µ–µ', '–º–µ–Ω–µ–µ',
                '—Å–∞–º—ã–π', '—Ç–∞–∫–æ–π', '–¥—Ä—É–≥–æ–π', '–Ω–æ–≤—ã–π', '—Å—Ç–∞—Ä—ã–π', '–±–æ–ª—å—à–æ–π', '–º–∞–ª–µ–Ω—å–∫–∏–π'
            ];
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º —Å—Ç–æ–ø-—Å–ª–æ–≤–∞ –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —á–∞—Å—Ç–æ—Ç–µ
            const filteredWords = Object.entries(wordCount)
                .filter(([word, count]) => !stopWords.includes(word) && count >= 2)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10) // –ë–µ—Ä–µ–º —Ç–æ–ø-10
                .map(([word]) => word);
            
            return filteredWords;
        }
        
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
        function applyKeywordHighlight() {
            const keywords = document.getElementById('keywordsInput').value.trim();
            const highlightType = document.getElementById('highlightType').value;
            const highlightColor = document.getElementById('highlightColor').value;
            
            if (!keywords) {
                showToast('–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è', 'error');
                return;
            }
            
            if (currentSlides.length === 0) return;
            
            const keywordList = keywords.split(',').map(k => k.trim()).filter(k => k.length > 0);
            const currentSlide = currentSlides[currentSlideIndex];
            
            currentSlide.elements.forEach(element => {
                element.originalText = element.originalText || element.text;
                let highlightedText = element.originalText;
                
                keywordList.forEach(keyword => {
                    const regex = new RegExp(`\\b(${keyword})\\b`, 'gi');
                    highlightedText = highlightedText.replace(regex, (match) => {
                        return `<span class="keyword-highlight keyword-${highlightType}" style="color: ${highlightColor};">${match}</span>`;
                    });
                });
                
                element.text = highlightedText;
            });
            
            renderSlide();
            showToast(`–í—ã–¥–µ–ª–µ–Ω–æ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤: ${keywordList.length}`);
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –≤—ã–¥–µ–ª–µ–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
        function clearKeywordHighlight() {
            if (currentSlides.length === 0) return;
            
            const currentSlide = currentSlides[currentSlideIndex];
            
            currentSlide.elements.forEach(element => {
                if (element.originalText) {
                    element.text = element.originalText;
                }
            });
            
            renderSlide();
            showToast('–í—ã–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –æ—á–∏—â–µ–Ω–æ');
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ–Ω–∞ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Å–ª–∞–π–¥–∞
        function uploadBackgroundForFirst() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                if (currentSlides.length === 0) {
                    showToast('–°–æ–∑–¥–∞–π—Ç–µ —Å–ª–∞–π–¥—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ–Ω–∞', 'error');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const firstSlide = currentSlides[0];
                    firstSlide.backgroundImage = e.target.result;
                    firstSlide.backgroundSettings = { ...backgroundSettings };
                    
                    if (currentSlideIndex === 0) {
                        applyBackgroundToSlide(firstSlide);
                        showBackgroundControls();
                    }
                    
                    showToast('üñºÔ∏è –§–æ–Ω –∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Å–ª–∞–π–¥–∞!');
                };
                reader.readAsDataURL(file);
            };
            
            input.click();
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ–Ω–∞ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª–∞–π–¥–æ–≤ (–∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–≥–æ)
        function uploadBackgroundForOthers() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                if (currentSlides.length <= 1) {
                    showToast('–ù—É–∂–Ω–æ –±–æ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ —Å–ª–∞–π–¥–∞ –¥–ª—è —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏', 'error');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º –∫–æ –≤—Å–µ–º —Å–ª–∞–π–¥–∞–º –∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–≥–æ
                    for (let i = 1; i < currentSlides.length; i++) {
                        const slide = currentSlides[i];
                        slide.backgroundImage = e.target.result;
                        slide.backgroundSettings = { ...backgroundSettings };
                    }
                    
                    // –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π —Å–ª–∞–π–¥ –Ω–µ –ø–µ—Ä–≤—ã–π, –æ–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                    if (currentSlideIndex > 0) {
                        applyBackgroundToSlide(currentSlides[currentSlideIndex]);
                        showBackgroundControls();
                    }
                    
                    showToast(`üñºÔ∏è –§–æ–Ω –∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è ${currentSlides.length - 1} —Å–ª–∞–π–¥–æ–≤ (–∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–≥–æ)!`);
                };
                reader.readAsDataURL(file);
            };
            
            input.click();
        }
        function applyStyleToAll() {
            if (!selectedElement || currentSlides.length === 0) {
                showToast('–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–∏–ª—è', 'error');
                return;
            }
            
            const styleToApply = {
                font: selectedElement.font,
                size: selectedElement.size,
                weight: selectedElement.weight,
                color: selectedElement.color
            };
            
            let appliedCount = 0;
            
            currentSlides.forEach(slide => {
                slide.elements.forEach(element => {
                    element.font = styleToApply.font;
                    element.size = styleToApply.size;
                    element.weight = styleToApply.weight;
                    element.color = styleToApply.color;
                    appliedCount++;
                });
            });
            
            renderSlide();
            showToast(`–°—Ç–∏–ª—å –ø—Ä–∏–º–µ–Ω–µ–Ω –∫ ${appliedCount} —ç–ª–µ–º–µ–Ω—Ç–∞–º –Ω–∞ –≤—Å–µ—Ö —Å–ª–∞–π–¥–∞—Ö!`);
        }
        
        // ===== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø =====
        
        // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (—É–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å –∏—Å—Ç–æ—Ä–∏–µ–π)
        function showNotification(message, type = 'success') {
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
            const notification = {
                id: Date.now(),
                message: message,
                type: type,
                timestamp: new Date().toLocaleString()
            };
            
            notificationHistory.unshift(notification);
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é 50 —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
            if (notificationHistory.length > 50) {
                notificationHistory = notificationHistory.slice(0, 50);
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem('flashpost_notifications', JSON.stringify(notificationHistory));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º toast
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : type === 'warning' ? '#ffc107' : '#007bff'};
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                font-size: 14px;
                font-weight: 600;
                z-index: 10000;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                max-width: 300px;
                word-wrap: break-word;
                animation: slideInRight 0.3s ease-out;
            `;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É
            const icon = type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
            toast.innerHTML = `${icon} ${message}`;
            
            document.body.appendChild(toast);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
            setTimeout(() => {
                toast.classList.add('show');
            }, 100);
            
            // –°–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                toast.style.animation = 'slideOutRight 0.3s ease-in';
                setTimeout(() => {
                    if (document.body.contains(toast)) {
                        document.body.removeChild(toast);
                    }
                }, 300);
            }, 3000);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            updateNotificationBadge();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function updateNotificationBadge() {
            const btn = document.getElementById('notificationsBtn');
            const unreadCount = notificationHistory.length;
            
            if (unreadCount > 0) {
                btn.innerHTML = `üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (${unreadCount > 99 ? '99+' : unreadCount})`;
            } else {
                btn.innerHTML = 'üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è';
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–∞–Ω–µ–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function showNotificationsPanel() {
            // –°–æ–∑–¥–∞–µ–º –ø–∞–Ω–µ–ª—å –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
            let panel = document.getElementById('notificationsPanel');
            if (!panel) {
                panel = document.createElement('div');
                panel.id = 'notificationsPanel';
                panel.className = 'notifications-panel';
                document.body.appendChild(panel);
            }
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
            panel.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="color: white; margin: 0;">üîî –ò—Å—Ç–æ—Ä–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h3>
                    <button onclick="closeNotificationsPanel()" style="
                        background: rgba(255,255,255,0.2);
                        border: none;
                        color: white;
                        padding: 8px 12px;
                        border-radius: 6px;
                        cursor: pointer;
                    ">‚úï</button>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <button onclick="clearNotificationHistory()" style="
                        background: #dc3545;
                        border: none;
                        color: white;
                        padding: 8px 16px;
                        border-radius: 6px;
                        cursor: pointer;
                        font-size: 12px;
                    ">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
                </div>
                
                <div id="notificationsList">
                    ${notificationHistory.length === 0 ? 
                        '<p style="color: rgba(255,255,255,0.7); text-align: center; padding: 20px;">–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</p>' :
                        notificationHistory.map(notif => `
                            <div class="notification-item ${notif.type}">
                                <div>${notif.message}</div>
                                <div class="notification-time">${notif.timestamp}</div>
                            </div>
                        `).join('')
                    }
                </div>
            `;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å
            panel.classList.add('open');
        }
        
        // –ó–∞–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function closeNotificationsPanel() {
            const panel = document.getElementById('notificationsPanel');
            if (panel) {
                panel.classList.remove('open');
            }
        }
        
        // –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function clearNotificationHistory() {
            notificationHistory = [];
            localStorage.removeItem('flashpost_notifications');
            updateNotificationBadge();
            showNotificationsPanel(); // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–Ω–µ–ª—å
            showNotification('–ò—Å—Ç–æ—Ä–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ—á–∏—â–µ–Ω–∞', 'info');
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function loadNotificationHistory() {
            try {
                const saved = localStorage.getItem('flashpost_notifications');
                if (saved) {
                    notificationHistory = JSON.parse(saved);
                    updateNotificationBadge();
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:', error);
            }
        }
        
        // ===== –°–ò–°–¢–ï–ú–ê –°–¢–ê–¢–ò–°–¢–ò–ö–ò =====
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats(action) {
            const stats = JSON.parse(localStorage.getItem('flashpost_stats') || '{}');
            const today = new Date().toDateString();
            
            if (!stats[today]) {
                stats[today] = {
                    aiGenerations: 0,
                    slidesCreated: 0,
                    projectsSaved: 0,
                    exportsCompleted: 0,
                    fontsChanged: 0,
                    templatesUsed: 0
                };
            }
            
            if (stats[today][action] !== undefined) {
                stats[today][action]++;
            }
            
            localStorage.setItem('flashpost_stats', JSON.stringify(stats));
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        function showStatsModal() {
            const stats = JSON.parse(localStorage.getItem('flashpost_stats') || '{}');
            const today = new Date().toDateString();
            const todayStats = stats[today] || {};
            
            // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            let totalStats = {
                aiGenerations: 0,
                slidesCreated: 0,
                projectsSaved: 0,
                exportsCompleted: 0,
                fontsChanged: 0,
                templatesUsed: 0
            };
            
            Object.values(stats).forEach(dayStats => {
                Object.keys(totalStats).forEach(key => {
                    totalStats[key] += dayStats[key] || 0;
                });
            });
            
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;
            
            modal.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    padding: 30px;
                    border-radius: 20px;
                    color: white;
                    max-width: 500px;
                    max-height: 80vh;
                    overflow-y: auto;
                    margin: 20px;
                ">
                    <h2 style="margin-bottom: 20px;">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h2>
                    
                    <h3 style="margin: 20px 0 10px 0;">üìÖ –°–µ–≥–æ–¥–Ω—è:</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px;">
                        <div>ü§ñ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–π:</div><div><strong>${todayStats.aiGenerations || 0}</strong></div>
                        <div>üìÑ –°–ª–∞–π–¥–æ–≤ —Å–æ–∑–¥–∞–Ω–æ:</div><div><strong>${todayStats.slidesCreated || 0}</strong></div>
                        <div>üíæ –ü—Ä–æ–µ–∫—Ç–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ:</div><div><strong>${todayStats.projectsSaved || 0}</strong></div>
                        <div>üì• –≠–∫—Å–ø–æ—Ä—Ç–æ–≤:</div><div><strong>${todayStats.exportsCompleted || 0}</strong></div>
                        <div>üî§ –°–º–µ–Ω —à—Ä–∏—Ñ—Ç–æ–≤:</div><div><strong>${todayStats.fontsChanged || 0}</strong></div>
                        <div>üé® –®–∞–±–ª–æ–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ:</div><div><strong>${todayStats.templatesUsed || 0}</strong></div>
                    </div>
                    
                    <h3 style="margin: 20px 0 10px 0;">üìà –í—Å–µ–≥–æ:</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px;">
                        <div>ü§ñ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–π:</div><div><strong>${totalStats.aiGenerations}</strong></div>
                        <div>üìÑ –°–ª–∞–π–¥–æ–≤ —Å–æ–∑–¥–∞–Ω–æ:</div><div><strong>${totalStats.slidesCreated}</strong></div>
                        <div>üíæ –ü—Ä–æ–µ–∫—Ç–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ:</div><div><strong>${totalStats.projectsSaved}</strong></div>
                        <div>üì• –≠–∫—Å–ø–æ—Ä—Ç–æ–≤:</div><div><strong>${totalStats.exportsCompleted}</strong></div>
                        <div>üî§ –°–º–µ–Ω —à—Ä–∏—Ñ—Ç–æ–≤:</div><div><strong>${totalStats.fontsChanged}</strong></div>
                        <div>üé® –®–∞–±–ª–æ–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ:</div><div><strong>${totalStats.templatesUsed}</strong></div>
                    </div>
                    
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin: 20px 0;">
                        <h4 style="margin-bottom: 10px;">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è:</h4>
                        ${totalStats.aiGenerations >= 10 ? 'ü•â –ù–æ–≤–∏—á–æ–∫ AI (10+ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π)<br>' : ''}
                        ${totalStats.aiGenerations >= 50 ? 'ü•à –ú–∞—Å—Ç–µ—Ä AI (50+ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π)<br>' : ''}
                        ${totalStats.aiGenerations >= 100 ? 'ü•á –≠–∫—Å–ø–µ—Ä—Ç AI (100+ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π)<br>' : ''}
                        ${totalStats.slidesCreated >= 100 ? 'üìÑ –°–æ–∑–¥–∞—Ç–µ–ª—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (100+ —Å–ª–∞–π–¥–æ–≤)<br>' : ''}
                        ${totalStats.projectsSaved >= 10 ? 'üíæ –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä (10+ –ø—Ä–æ–µ–∫—Ç–æ–≤)<br>' : ''}
                        ${totalStats.exportsCompleted >= 50 ? 'üì• –≠–∫—Å–ø–æ—Ä—Ç–µ—Ä (50+ —ç–∫—Å–ø–æ—Ä—Ç–æ–≤)<br>' : ''}
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button onclick="clearStats(); this.parentElement.parentElement.parentElement.remove()" 
                                style="padding: 8px 16px; margin-right: 10px; border: none; border-radius: 8px; background: #dc3545; color: white; cursor: pointer;">
                            üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å
                        </button>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                                style="padding: 12px 24px; border: none; border-radius: 8px; background: rgba(255,255,255,0.2); color: white; cursor: pointer; font-weight: 600;">
                            –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        // –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        function clearStats() {
            localStorage.removeItem('flashpost_stats');
            showNotification('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—á–∏—â–µ–Ω–∞', 'info');
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–∞—Ä—É—Å–µ–ª–∏
        function newCarousel() {
            currentSlides = [];
            currentSlideIndex = 0;
            hideEditor();
            deselectElement();
            topicInput.value = '';
            manualInput.value = '';
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        function autoLayout() {
            if (currentSlides.length === 0) return;
            
            const slide = currentSlides[currentSlideIndex];
            slide.elements.forEach((element, index) => {
                element.x = 50;
                element.y = 15 + (index * 20);
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–±–∏—Ä–∞–µ–º —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞
                if (index === 0) {
                    element.size = Math.max(28, Math.min(40, 400 / element.text.length));
                    element.weight = 800;
                } else {
                    element.size = Math.max(14, Math.min(20, 300 / element.text.length));
                    element.weight = 500;
                }
            });
            
            renderSlide();
            showToast('–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ!');
        }

        // –°–±—Ä–æ—Å —Å–ª–∞–π–¥–∞ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
        function resetSlide() {
            if (currentSlides.length === 0) return;
            
            const slide = currentSlides[currentSlideIndex];
            slide.elements = [
                {
                    id: `reset_title_${Date.now()}`,
                    text: slide.title,
                    x: 50,
                    y: 30,
                    font: 'Inter',
                    size: 32,
                    weight: 800,
                    color: '#ffffff'
                },
                {
                    id: `reset_text_${Date.now()}`,
                    text: slide.text,
                    x: 50,
                    y: 70,
                    font: 'Inter',
                    size: 18,
                    weight: 500,
                    color: '#ffffff'
                }
            ];
            
            deselectElement();
            renderSlide();
            showToast('–°–ª–∞–π–¥ —Å–±—Ä–æ—à–µ–Ω!');
        }
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        generateBtn.addEventListener('click', async () => {
            console.log('üöÄ –ö–Ω–æ–ø–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–∞–∂–∞—Ç–∞');
            
            const topic = topicInput.value.trim();
            console.log('üìù –í–≤–µ–¥–µ–Ω–Ω–∞—è —Ç–µ–º–∞:', topic);
            
            if (!topic) {
                showToast('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–º—É –¥–ª—è –∫–∞—Ä—É—Å–µ–ª–∏', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–∏–º–∏—Ç AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
            if (!checkLimit('aiGeneration')) {
                console.log('‚ö†Ô∏è –õ–∏–º–∏—Ç AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–µ–≤—ã—à–µ–Ω');
                showUpgradeModal();
                return;
            }
            
            if (isGenerating) {
                console.log('‚ö†Ô∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–∂–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ');
                return;
            }
            
            isGenerating = true;
            console.log('üîÑ –ù–∞—á–∏–Ω–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é...');
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
            incrementUsage('aiGeneration');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç—Ç–∞–ø—ã Advanced AI Pipeline
            showLoading(true, 'üöÄ ADVANCED AI Pipeline –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω...', 10);
            
            setTimeout(() => {
                updateProgress(30, 'üìã –≠—Ç–∞–ø A: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è outline (8-11 —Å–ª–∞–π–¥–æ–≤)...');
            }, 800);
            
            setTimeout(() => {
                updateProgress(60, '‚úçÔ∏è –≠—Ç–∞–ø B: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ —Ç–æ–Ω–∞–º–∏...');
            }, 1600);
            
            setTimeout(() => {
                updateProgress(90, 'üé® –≠—Ç–∞–ø C: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤...');
            }, 2400);
            
            try {
                console.log('ü§ñ –í—ã–∑—ã–≤–∞–µ–º generateWithAI...');
                currentSlides = await generateWithAI(topic);
                console.log('‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞, —Å–ª–∞–π–¥–æ–≤:', currentSlides.length);
                
                currentSlideIndex = 0;
                
                updateProgress(100, '‚úÖ –ö–∞—Ä—É—Å–µ–ª—å –≥–æ—Ç–æ–≤–∞!');
                updateStats('aiGenerations');
                updateStats('slidesCreated');
                
                setTimeout(() => {
                    console.log('üé® –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä...');
                    showEditor();
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–∑–¥–∞–Ω–Ω–æ–π –∫–∞—Ä—É—Å–µ–ª–∏
                    const slideTypes = currentSlides.map(s => s.slideType).filter(Boolean);
                    const uniqueTypes = [...new Set(slideTypes)];
                    
                    const remainingGenerations = currentPlan.aiGenerationsPerDay === -1 ? 
                        '‚àû' : 
                        (currentPlan.aiGenerationsPerDay - dailyUsage.aiGenerations);
                    
                    showToast(`üéâ ADVANCED AI —Å–æ–∑–¥–∞–ª ${currentSlides.length} —Å–ª–∞–π–¥–æ–≤!\n–¢–∏–ø—ã: ${uniqueTypes.join(', ')}\n–û—Å—Ç–∞–ª–æ—Å—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–π: ${remainingGenerations}`, 'success');
                }, 500);
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:', error);
                showToast('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: ' + error.message, 'error');
            } finally {
                setTimeout(() => {
                    showLoading(false);
                    isGenerating = false;
                    console.log('üèÅ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
                }, 1000);
            }
        });

        manualBtn.addEventListener('click', () => {
            const text = manualInput.value.trim();
            if (!text) {
                showToast('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–∞–π–¥–æ–≤', 'error');
                return;
            }
            
            try {
                currentSlides = generateFromText(text);
                currentSlideIndex = 0;
                showEditor();
                showToast(`–°–æ–∑–¥–∞–Ω–æ ${currentSlides.length} —Å–ª–∞–π–¥–æ–≤!`);
            } catch (error) {
                showToast('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–∞–π–¥–æ–≤', 'error');
            }
        });

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è
        prevBtn.addEventListener('click', () => {
            if (currentSlideIndex > 0) {
                currentSlideIndex--;
                renderSlide();
                deselectElement();
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentSlideIndex < currentSlides.length - 1) {
                currentSlideIndex++;
                renderSlide();
                deselectElement();
            }
        });

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª–∞–π–¥–∞–º–∏
        document.getElementById('addSlideBtn').addEventListener('click', () => {
            if (!checkLimit('slides')) {
                showUpgradeModal();
                return;
            }
            addSlide();
        });
        document.getElementById('duplicateBtn').addEventListener('click', duplicateSlide);
        document.getElementById('deleteSlideBtn').addEventListener('click', deleteSlide);
        document.getElementById('expandBtn').addEventListener('click', expandIdea);
        document.getElementById('downloadBtn').addEventListener('click', downloadSlide);
        document.getElementById('downloadAllBtn').addEventListener('click', downloadAllSlides);
        document.getElementById('saveTemplateBtn').addEventListener('click', saveTemplate);
        document.getElementById('saveProjectBtn').addEventListener('click', saveProject);
        document.getElementById('loadProjectBtn').addEventListener('click', () => {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±–æ—Ä: –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ —Ñ–∞–π–ª–∞ –∏–ª–∏ –∏–∑ —Å–ø–∏—Å–∫–∞
            const choice = confirm('–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –∏–∑ —Ñ–∞–π–ª–∞? (–û—Ç–º–µ–Ω–∞ = –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤)');
            if (choice) {
                loadProject();
            } else {
                showProjectsList();
            }
        });
        document.getElementById('newCarouselBtn').addEventListener('click', newCarousel);

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–º
        document.getElementById('addTextBtn').addEventListener('click', addTextElement);
        document.getElementById('centerTextBtn').addEventListener('click', centerAllElements);
        document.getElementById('clearSlideBtn').addEventListener('click', clearSlide);
        saveTextBtn.addEventListener('click', saveElement);
        deleteTextBtn.addEventListener('click', deleteElement);

        // –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
        document.getElementById('autoLayoutBtn').addEventListener('click', autoLayout);
        document.getElementById('resetSlideBtn').addEventListener('click', resetSlide);
        
        // –ù–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ñ–æ–Ω–æ–≤ –∏ —à–∞–±–ª–æ–Ω–æ–≤
        document.getElementById('uploadBackgroundBtn').addEventListener('click', uploadBackground);
        document.getElementById('saveTemplateBtn2').addEventListener('click', saveTemplate);
        document.getElementById('loadTemplateBtn').addEventListener('click', () => {
            showNotification('–í—ã–±–µ—Ä–∏—Ç–µ —à–∞–±–ª–æ–Ω –∏–∑ —Å–µ—Ç–∫–∏ –≤—ã—à–µ', 'info');
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ–æ–Ω–æ–≤
        document.getElementById('applyToAllBtn').addEventListener('click', applyBackgroundToAll);
        document.getElementById('applyToFirstBtn').addEventListener('click', applyBackgroundToFirst);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ–Ω–æ–≤
        document.getElementById('uploadFirstSlideBtn').addEventListener('click', uploadBackgroundForFirst);
        document.getElementById('uploadOthersBtn').addEventListener('click', uploadBackgroundForOthers);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤ —Ñ–æ–Ω–∞
        document.getElementById('backgroundDarken').addEventListener('input', (e) => {
            if (currentSlides.length === 0) return;
            const currentSlide = currentSlides[currentSlideIndex];
            if (!currentSlide.backgroundSettings) currentSlide.backgroundSettings = { ...backgroundSettings };
            currentSlide.backgroundSettings.darken = parseInt(e.target.value);
            applyBackgroundToSlide(currentSlide);
            updateBackgroundValues();
        });
        
        document.getElementById('backgroundBlur').addEventListener('input', (e) => {
            if (currentSlides.length === 0) return;
            const currentSlide = currentSlides[currentSlideIndex];
            if (!currentSlide.backgroundSettings) currentSlide.backgroundSettings = { ...backgroundSettings };
            currentSlide.backgroundSettings.blur = parseInt(e.target.value);
            applyBackgroundToSlide(currentSlide);
            updateBackgroundValues();
        });
        
        document.getElementById('backgroundScale').addEventListener('input', (e) => {
            if (currentSlides.length === 0) return;
            const currentSlide = currentSlides[currentSlideIndex];
            if (!currentSlide.backgroundSettings) currentSlide.backgroundSettings = { ...backgroundSettings };
            currentSlide.backgroundSettings.scale = parseInt(e.target.value);
            applyBackgroundToSlide(currentSlide);
            updateBackgroundValues();
        });
        
        document.getElementById('backgroundX').addEventListener('input', (e) => {
            if (currentSlides.length === 0) return;
            const currentSlide = currentSlides[currentSlideIndex];
            if (!currentSlide.backgroundSettings) currentSlide.backgroundSettings = { ...backgroundSettings };
            currentSlide.backgroundSettings.x = parseInt(e.target.value);
            applyBackgroundToSlide(currentSlide);
            updateBackgroundValues();
        });
        
        document.getElementById('backgroundY').addEventListener('input', (e) => {
            if (currentSlides.length === 0) return;
            const currentSlide = currentSlides[currentSlideIndex];
            if (!currentSlide.backgroundSettings) currentSlide.backgroundSettings = { ...backgroundSettings };
            currentSlide.backgroundSettings.y = parseInt(e.target.value);
            applyBackgroundToSlide(currentSlide);
            updateBackgroundValues();
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
        document.getElementById('applyHighlightBtn').addEventListener('click', applyKeywordHighlight);
        document.getElementById('autoHighlightBtn').addEventListener('click', () => {
            if (currentSlides.length === 0) return;
            
            const currentSlide = currentSlides[currentSlideIndex];
            currentSlide.elements.forEach(element => {
                element.originalText = element.originalText || element.text;
                element.text = autoHighlightKeywords(element.originalText);
            });
            
            renderSlide();
            showToast('–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ!');
        });
        document.getElementById('autoDetectBtn').addEventListener('click', () => {
            if (currentSlides.length === 0) {
                showToast('–°–æ–∑–¥–∞–π—Ç–µ —Å–ª–∞–π–¥—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤', 'error');
                return;
            }
            
            // –°–æ–±–∏—Ä–∞–µ–º –≤–µ—Å—å —Ç–µ–∫—Å—Ç —Å–æ —Å–ª–∞–π–¥–æ–≤
            let allText = '';
            currentSlides.forEach(slide => {
                slide.elements.forEach(element => {
                    const cleanText = element.originalText || element.text;
                    // –£–±–∏—Ä–∞–µ–º HTML —Ç–µ–≥–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
                    const textOnly = cleanText.replace(/<[^>]*>/g, '');
                    allText += textOnly + ' ';
                });
            });
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
            const detectedKeywords = detectKeywords(allText);
            
            if (detectedKeywords.length > 0) {
                document.getElementById('keywordsInput').value = detectedKeywords.join(', ');
                showToast(`üîç –ù–∞–π–¥–µ–Ω–æ ${detectedKeywords.length} –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤: ${detectedKeywords.slice(0, 3).join(', ')}${detectedKeywords.length > 3 ? '...' : ''}`);
            } else {
                showToast('–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–≤–µ—Å—Ç–∏ –∏—Ö –≤—Ä—É—á–Ω—É—é.', 'warning');
            }
        });
        document.getElementById('clearHighlightBtn').addEventListener('click', clearKeywordHighlight);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∏–ª—è –∫–æ –≤—Å–µ–º
        document.getElementById('applyStyleToAllBtn').addEventListener('click', applyStyleToAll);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —à—Ä–∏—Ñ—Ç–æ–≤
        document.getElementById('testFontsBtn').addEventListener('click', testFonts);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–º–æ—â–∏
        document.getElementById('helpBtn').addEventListener('click', showHelpModal);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        document.getElementById('notificationsBtn').addEventListener('click', showNotificationsPanel);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        document.getElementById('statsBtn').addEventListener('click', showStatsModal);
        
        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à—Ä–∏—Ñ—Ç–æ–≤
        function testFonts() {
            if (currentSlides.length === 0) {
                // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Å–ª–∞–π–¥
                const testSlide = {
                    id: `test_slide_${Date.now()}`,
                    title: '–¢–µ—Å—Ç —à—Ä–∏—Ñ—Ç–æ–≤',
                    text: '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —à—Ä–∏—Ñ—Ç–æ–≤',
                    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                    elements: []
                };
                
                currentSlides = [testSlide];
                currentSlideIndex = 0;
                showEditor();
            }
            
            const testFonts = [
                'Inter', 'Playfair Display', 'Bebas Neue', 'Space Grotesk', 
                'Montserrat', 'Roboto', 'Open Sans', 'Lato', 'Poppins', 
                'Nunito'
            ];
            
            const currentSlide = currentSlides[currentSlideIndex];
            currentSlide.elements = [];
            
            testFonts.forEach((font, index) => {
                const element = {
                    id: `test_font_${index}`,
                    text: `${font}: –¢–µ—Å—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç`,
                    x: 50,
                    y: 10 + (index * 8),
                    font: font,
                    size: 16,
                    weight: 500,
                    color: '#ffffff'
                };
                
                currentSlide.elements.push(element);
            });
            
            renderSlide();
            showToast(`–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç –¥–ª—è ${testFonts.length} —à—Ä–∏—Ñ—Ç–æ–≤!`);
        }
        
        // ===== –°–ò–°–¢–ï–ú–ê –ü–†–û–ï–ö–¢–û–í =====
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
        function saveProject() {
            if (currentSlides.length === 0) {
                showToast('–ù–µ—Ç —Å–ª–∞–π–¥–æ–≤ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
                return;
            }
            
            const projectName = prompt('–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:', `–ü—Ä–æ–µ–∫—Ç ${new Date().toLocaleDateString()}`);
            if (!projectName) return;
            
            const project = {
                name: projectName,
                created: new Date().toISOString(),
                slides: currentSlides,
                currentIndex: currentSlideIndex,
                version: '1.0'
            };
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            const savedProjects = JSON.parse(localStorage.getItem('flashpost_projects') || '[]');
            savedProjects.push(project);
            localStorage.setItem('flashpost_projects', JSON.stringify(savedProjects));
            
            // –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ —Ñ–∞–π–ª
            const dataStr = JSON.stringify(project, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `${projectName.replace(/[^a-zA-Z0-9]/g, '_')}.flashpost`;
            link.click();
            
            URL.revokeObjectURL(url);
            
            updateStats('projectsSaved');
            showToast(`üíæ –ü—Ä–æ–µ–∫—Ç "${projectName}" —Å–æ—Ö—Ä–∞–Ω–µ–Ω!`);
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
        function loadProject() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.flashpost,.json';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const project = JSON.parse(e.target.result);
                        
                        if (project.slides && Array.isArray(project.slides)) {
                            currentSlides = project.slides;
                            currentSlideIndex = project.currentIndex || 0;
                            
                            showEditor();
                            showToast(`üìÇ –ü—Ä–æ–µ–∫—Ç "${project.name}" –∑–∞–≥—Ä—É–∂–µ–Ω!`);
                        } else {
                            showToast('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –ø—Ä–æ–µ–∫—Ç–∞', 'error');
                        }
                    } catch (error) {
                        showToast('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞', 'error');
                        console.error('Load project error:', error);
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
        function showProjectsList() {
            const savedProjects = JSON.parse(localStorage.getItem('flashpost_projects') || '[]');
            
            if (savedProjects.length === 0) {
                showToast('–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤', 'info');
                return;
            }
            
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;
            
            modal.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    padding: 30px;
                    border-radius: 20px;
                    color: white;
                    max-width: 500px;
                    max-height: 70vh;
                    overflow-y: auto;
                    margin: 20px;
                ">
                    <h2 style="margin-bottom: 20px;">üìÅ –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã</h2>
                    <div id="projectsList">
                        ${savedProjects.map((project, index) => `
                            <div style="
                                background: rgba(255,255,255,0.1);
                                padding: 15px;
                                margin: 10px 0;
                                border-radius: 10px;
                                cursor: pointer;
                                transition: all 0.3s ease;
                            " onclick="loadProjectFromList(${index}); this.parentElement.parentElement.parentElement.remove();"
                            onmouseover="this.style.background='rgba(255,255,255,0.2)'"
                            onmouseout="this.style.background='rgba(255,255,255,0.1)'">
                                <div style="font-weight: 600; margin-bottom: 5px;">${project.name}</div>
                                <div style="font-size: 12px; opacity: 0.8;">
                                    ${new Date(project.created).toLocaleString()} ‚Ä¢ ${project.slides.length} —Å–ª–∞–π–¥–æ–≤
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                                style="padding: 10px 20px; border: none; border-radius: 8px; background: rgba(255,255,255,0.2); color: white; cursor: pointer;">
                            –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
        function loadProjectFromList(index) {
            const savedProjects = JSON.parse(localStorage.getItem('flashpost_projects') || '[]');
            const project = savedProjects[index];
            
            if (project) {
                currentSlides = project.slides;
                currentSlideIndex = project.currentIndex || 0;
                showEditor();
                showToast(`üìÇ –ü—Ä–æ–µ–∫—Ç "${project.name}" –∑–∞–≥—Ä—É–∂–µ–Ω!`);
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–º–æ—â—å
        function showHelpModal() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;
            
            modal.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    padding: 30px;
                    border-radius: 20px;
                    color: white;
                    max-width: 600px;
                    max-height: 80vh;
                    overflow-y: auto;
                    margin: 20px;
                ">
                    <h2 style="margin-bottom: 20px;">‚å®Ô∏è –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ FlashPost Ultimate</h2>
                    
                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px; margin-bottom: 20px;">
                        <div style="font-weight: 600;">‚Üê ‚Üí</div>
                        <div>–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å–ª–∞–π–¥–∞–º</div>
                        
                        <div style="font-weight: 600;">Ctrl + T</div>
                        <div>–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç</div>
                        
                        <div style="font-weight: 600;">Ctrl + S</div>
                        <div>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞</div>
                        
                        <div style="font-weight: 600;">Ctrl + Shift + S</div>
                        <div>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</div>
                        
                        <div style="font-weight: 600;">Ctrl + O</div>
                        <div>–û—Ç–∫—Ä—ã—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤</div>
                        
                        <div style="font-weight: 600;">Ctrl + N</div>
                        <div>–ù–æ–≤–∞—è –∫–∞—Ä—É—Å–µ–ª—å</div>
                        
                        <div style="font-weight: 600;">Ctrl + Shift + N</div>
                        <div>–ù–æ–≤—ã–π —Å–ª–∞–π–¥</div>
                        
                        <div style="font-weight: 600;">Ctrl + D</div>
                        <div>–î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Å–ª–∞–π–¥</div>
                        
                        <div style="font-weight: 600;">Ctrl + E</div>
                        <div>–≠–∫—Å–ø–æ—Ä—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–ª–∞–π–¥–∞</div>
                        
                        <div style="font-weight: 600;">Ctrl + Shift + E</div>
                        <div>–≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö —Å–ª–∞–π–¥–æ–≤</div>
                        
                        <div style="font-weight: 600;">Ctrl + F</div>
                        <div>–¢–µ—Å—Ç —à—Ä–∏—Ñ—Ç–æ–≤</div>
                        
                        <div style="font-weight: 600;">Ctrl + H</div>
                        <div>–ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É</div>
                        
                        <div style="font-weight: 600;">Delete</div>
                        <div>–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç</div>
                        
                        <div style="font-weight: 600;">Escape</div>
                        <div>–°–Ω—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ</div>
                    </div>
                    
                    <h3 style="margin: 20px 0 10px 0;">üé® –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:</h3>
                    <ul style="margin-left: 20px; line-height: 1.6;">
                        <li>üöÄ Advanced AI Pipeline —Å 11 —Ç–∏–ø–∞–º–∏ —Å–ª–∞–π–¥–æ–≤</li>
                        <li>üíé FREE/PRO –ø–ª–∞–Ω—ã —Å –ª–∏–º–∏—Ç–∞–º–∏</li>
                        <li>üî§ 20 Google Fonts —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∏—Ä–∏–ª–ª–∏—Ü—ã</li>
                        <li>üñºÔ∏è Drag & Drop –¥–ª—è —Ñ–æ–Ω–æ–≤ –∏ —Ç–µ–∫—Å—Ç–∞</li>
                        <li>‚ú® –í—ã–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π</li>
                        <li>üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ PNG, JPEG, PDF (720p, 1080p, 4K)</li>
                        <li>üéØ –°–∏—Å—Ç–µ–º–∞ —à–∞–±–ª–æ–Ω–æ–≤ –∏ –ø—Ä–æ–µ–∫—Ç–æ–≤</li>
                        <li>‚ö° –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–π</li>
                    </ul>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                                style="padding: 12px 24px; border: none; border-radius: 8px; background: rgba(255,255,255,0.2); color: white; cursor: pointer; font-weight: 600;">
                            –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —à—Ä–∏—Ñ—Ç–∞
        fontSelect.addEventListener('change', () => {
            console.log('–ò–∑–º–µ–Ω–µ–Ω–∏–µ —à—Ä–∏—Ñ—Ç–∞ –Ω–∞:', fontSelect.value);
            if (selectedElement) {
                selectedElement.font = fontSelect.value;
                console.log('–≠–ª–µ–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª–µ–Ω:', selectedElement);
                renderSlide();
                selectElement(selectedElement.id);
                showToast(`–®—Ä–∏—Ñ—Ç –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ ${fontSelect.value}`);
            } else {
                console.log('–ù–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞');
            }
        });
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–µ—Å–∞ —à—Ä–∏—Ñ—Ç–∞
        weightSelect.addEventListener('change', () => {
            if (selectedElement) {
                selectedElement.weight = parseInt(weightSelect.value);
                renderSlide();
                selectElement(selectedElement.id);
            }
        });
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–≤–µ—Ç–∞
        colorInput.addEventListener('change', () => {
            if (selectedElement) {
                selectedElement.color = colorInput.value;
                renderSlide();
                selectElement(selectedElement.id);
            }
        });
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç–µ–∫—Å—Ç–∞
        textInput.addEventListener('input', () => {
            if (selectedElement) {
                selectedElement.text = textInput.value;
                renderSlide();
                selectElement(selectedElement.id);
            }
        });

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–ª–∞–π–¥–µ—Ä–∞ —Ä–∞–∑–º–µ—Ä–∞
        sizeSlider.addEventListener('input', () => {
            sizeValue.textContent = sizeSlider.value + 'px';
            if (selectedElement) {
                selectedElement.size = parseInt(sizeSlider.value);
                renderSlide();
                selectElement(selectedElement.id);
            }
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
        document.querySelectorAll('.gradient-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                if (currentSlides.length === 0) return;
                
                // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å –¥—Ä—É–≥–∏—Ö –∫–Ω–æ–ø–æ–∫
                document.querySelectorAll('.gradient-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                const gradient = btn.dataset.gradient;
                const currentSlide = currentSlides[currentSlideIndex];
                currentSlide.background = gradient;
                
                // –û—á–∏—â–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–æ–Ω–∞
                delete currentSlide.backgroundImage;
                delete currentSlide.backgroundSettings;
                
                slideCanvas.style.background = gradient;
                slideCanvas.style.transform = 'none';
                slideCanvas.style.filter = 'none';
                
                // –°–∫—Ä—ã–≤–∞–µ–º –∫–æ–Ω—Ç—Ä–æ–ª—ã —Ñ–æ–Ω–∞
                document.getElementById('backgroundControls').style.display = 'none';
                
                showToast('–§–æ–Ω –∏–∑–º–µ–Ω–µ–Ω!');
            });
        });

        // –ö–ª–∏–∫ –ø–æ —Ö–æ–ª—Å—Ç—É –¥–ª—è —Å–Ω—è—Ç–∏—è –≤—ã–¥–µ–ª–µ–Ω–∏—è
        slideCanvas.addEventListener('click', (e) => {
            if (e.target === slideCanvas) {
                deselectElement();
            }
        });

        // ===== DRAG & DROP –î–õ–Ø –§–û–ù–û–í =====
        
        const canvasContainer = document.querySelector('.canvas-container');
        
        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            canvasContainer.addEventListener(eventName, preventDefaults, false);
            document.body.addEventListener(eventName, preventDefaults, false);
        });
        
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }
        
        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏
        ['dragenter', 'dragover'].forEach(eventName => {
            canvasContainer.addEventListener(eventName, highlight, false);
        });
        
        ['dragleave', 'drop'].forEach(eventName => {
            canvasContainer.addEventListener(eventName, unhighlight, false);
        });
        
        function highlight(e) {
            canvasContainer.classList.add('drag-over');
        }
        
        function unhighlight(e) {
            canvasContainer.classList.remove('drag-over');
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ drop
        canvasContainer.addEventListener('drop', handleDrop, false);
        
        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            
            if (files.length > 0) {
                handleBackgroundFile(files[0]);
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞ —Ñ–æ–Ω–∞
        function handleBackgroundFile(file) {
            if (!file.type.startsWith('image/')) {
                showToast('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ', 'error');
                return;
            }
            
            if (currentSlides.length === 0) {
                showToast('–°–æ–∑–¥–∞–π—Ç–µ —Å–ª–∞–π–¥—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ–Ω–∞', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const currentSlide = currentSlides[currentSlideIndex];
                currentSlide.background = `url(${e.target.result})`;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∏–ª—å —Å–ª–∞–π–¥–∞
                slideCanvas.style.background = `url(${e.target.result})`;
                slideCanvas.style.backgroundSize = 'cover';
                slideCanvas.style.backgroundPosition = 'center';
                
                showToast('üñºÔ∏è –§–æ–Ω –∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ drag & drop!');
            };
            reader.readAsDataURL(file);
        }

        // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
        document.addEventListener('keydown', (e) => {
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.tagName === 'SELECT') return;
            
            switch(e.key) {
                case 'ArrowLeft':
                    if (currentSlideIndex > 0) {
                        currentSlideIndex--;
                        renderSlide();
                        deselectElement();
                    }
                    break;
                case 'ArrowRight':
                    if (currentSlideIndex < currentSlides.length - 1) {
                        currentSlideIndex++;
                        renderSlide();
                        deselectElement();
                    }
                    break;
                case 'Delete':
                case 'Backspace':
                    if (selectedElement) {
                        e.preventDefault();
                        deleteElement();
                    }
                    break;
                case 'Escape':
                    deselectElement();
                    break;
                case 't':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        addTextElement();
                    }
                    break;
                case 's':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        if (e.shiftKey) {
                            saveProject(); // Ctrl+Shift+S = —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
                        } else if (selectedElement) {
                            saveElement(); // Ctrl+S = —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç
                        }
                    }
                    break;
                case 'o':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        showProjectsList(); // Ctrl+O = –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç
                    }
                    break;
                case 'n':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        if (e.shiftKey) {
                            addSlide(); // Ctrl+Shift+N = –Ω–æ–≤—ã–π —Å–ª–∞–π–¥
                        } else {
                            newCarousel(); // Ctrl+N = –Ω–æ–≤–∞—è –∫–∞—Ä—É—Å–µ–ª—å
                        }
                    }
                    break;
                case 'd':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        duplicateSlide(); // Ctrl+D = –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Å–ª–∞–π–¥
                    }
                    break;
                case 'e':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        if (e.shiftKey) {
                            downloadAllSlides(); // Ctrl+Shift+E = —ç–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö
                        } else {
                            downloadSlide(); // Ctrl+E = —ç–∫—Å–ø–æ—Ä—Ç —Å–ª–∞–π–¥–∞
                        }
                    }
                    break;
                case 'f':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        testFonts(); // Ctrl+F = —Ç–µ—Å—Ç —à—Ä–∏—Ñ—Ç–æ–≤
                    }
                    break;
                case 'h':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        showHelpModal(); // Ctrl+H = –ø–æ–º–æ—â—å
                    }
                    break;
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        console.log('üöÄ FlashPost Ultimate AI –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!');
        console.log('ü§ñ Advanced AI Pipeline –≤–∫–ª—é—á–∞–µ—Ç:');
        console.log('   üìã –≠—Ç–∞–ø A: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è outline (8-11 —Å–ª–∞–π–¥–æ–≤)');
        console.log('   ‚úçÔ∏è –≠—Ç–∞–ø B: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ —Ç–æ–Ω–∞–º–∏');
        console.log('   üé® –≠—Ç–∞–ø C: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤');
        console.log('');
        console.log('üéØ –¢–∏–ø—ã —Å–ª–∞–π–¥–æ–≤: hook, context, problem, agitation, solution, benefits, proof, objections, action, bonus, cta');
        console.log('üé≠ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–æ–Ω–∞: —É–¥–∏–≤–ª–µ–Ω–∏–µ, –ø–æ–Ω–∏–º–∞–Ω–∏–µ, –±–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ, —Ç—Ä–µ–≤–æ–≥–∞, –Ω–∞–¥–µ–∂–¥–∞, –≤–æ–æ–¥—É—à–µ–≤–ª–µ–Ω–∏–µ, –¥–æ–≤–µ—Ä–∏–µ, —É–±–µ–∂–¥–µ–Ω–∏–µ, –º–æ—Ç–∏–≤–∞—Ü–∏—è, —Ä–µ—à–∏–º–æ—Å—Ç—å');
        console.log('üë• –ê–Ω–∞–ª–∏–∑ —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–µ–º–µ');
        console.log('üé® –°–∏—Å—Ç–µ–º–∞ —à–∞–±–ª–æ–Ω–æ–≤: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —à–∞–±–ª–æ–Ω–æ–≤');
        console.log('üñºÔ∏è –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ–Ω–æ–≤: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π');
        console.log('üíé FREE/PRO –ø–ª–∞–Ω—ã: –ª–∏–º–∏—Ç—ã –∏ –ø—Ä–µ–º–∏—É–º —Ñ—É–Ω–∫—Ü–∏–∏');
        console.log('');
        console.log('–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏:');
        console.log('‚Üê ‚Üí - –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å–ª–∞–π–¥–∞–º');
        console.log('Ctrl+T - –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç');
        console.log('Ctrl+S - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è');
        console.log('Ctrl+Shift+S - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç');
        console.log('Ctrl+O - –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç');
        console.log('Ctrl+N - –Ω–æ–≤–∞—è –∫–∞—Ä—É—Å–µ–ª—å');
        console.log('Ctrl+Shift+N - –Ω–æ–≤—ã–π —Å–ª–∞–π–¥');
        console.log('Ctrl+D - –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Å–ª–∞–π–¥');
        console.log('Ctrl+E - —ç–∫—Å–ø–æ—Ä—Ç —Å–ª–∞–π–¥–∞');
        console.log('Ctrl+Shift+E - —ç–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö');
        console.log('Ctrl+F - —Ç–µ—Å—Ç —à—Ä–∏—Ñ—Ç–æ–≤');
        console.log('Ctrl+H - –ø–æ–º–æ—â—å');
        console.log('Delete - —É–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç');
        console.log('Escape - —Å–Ω—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ');
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —à—Ä–∏—Ñ—Ç–æ–≤
        console.log('üî§ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —à—Ä–∏—Ñ—Ç–æ–≤...');
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Google Fonts
        if (document.fonts) {
            document.fonts.ready.then(() => {
                console.log('‚úÖ Google Fonts –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã
                const testFonts = ['Inter', 'Playfair Display', 'Bebas Neue', 'Montserrat', 'Roboto'];
                testFonts.forEach(font => {
                    const isLoaded = document.fonts.check(`16px "${font}"`);
                    console.log(`${isLoaded ? '‚úÖ' : '‚ùå'} ${font}: ${isLoaded ? '–∑–∞–≥—Ä—É–∂–µ–Ω' : '–Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω'}`);
                });
            });
        } else {
            console.log('‚ö†Ô∏è Font Loading API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–ª–∞–Ω–æ–≤ –∏ –¥–∞–Ω–Ω—ã—Ö
        loadUsageData();
        updatePlanIndicator();
        loadNotificationHistory();
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —à–∞–±–ª–æ–Ω—ã –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        loadTemplates();
        
        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        setInterval(() => {
            if (currentSlides.length > 0) {
                try {
                    localStorage.setItem('flashpost_autosave', JSON.stringify({
                        slides: currentSlides,
                        currentIndex: currentSlideIndex,
                        timestamp: Date.now()
                    }));
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
                }
            }
        }, 30000);
        
        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        try {
            const autosave = localStorage.getItem('flashpost_autosave');
            if (autosave) {
                const data = JSON.parse(autosave);
                const timeDiff = Date.now() - data.timestamp;
                
                // –ï—Å–ª–∏ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤
                if (timeDiff < 24 * 60 * 60 * 1000 && data.slides && data.slides.length > 0) {
                    const restore = confirm('–ù–∞–π–¥–µ–Ω–æ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Å–µ—Å—Å–∏—é?');
                    if (restore) {
                        currentSlides = data.slides;
                        currentSlideIndex = data.currentIndex || 0;
                        showEditor();
                        showToast('–°–µ—Å—Å–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏–∑ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è!', 'success');
                    }
                }
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –ø–ª–∞–Ω–µ
        setTimeout(() => {
            if (currentPlan.name === 'FREE') {
                const remaining = currentPlan.aiGenerationsPerDay - dailyUsage.aiGenerations;
                showNotification(`üí° FREE –ø–ª–∞–Ω: –æ—Å—Ç–∞–ª–æ—Å—å ${remaining} AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–π —Å–µ–≥–æ–¥–Ω—è`, 'info');
            }
        }, 2000);
    </script>
</body>
</html>