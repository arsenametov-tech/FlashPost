<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç —É–ª—É—á—à–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤ - FlashPost</title>
    <link rel="stylesheet" href="app.css">
    <style>
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ */
        .test-controls {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 10000;
            max-width: 300px;
        }
        
        .test-controls h3 {
            margin: 0 0 10px 0;
            font-size: 14px;
            color: #833ab4;
        }
        
        .test-controls button {
            margin: 2px;
            padding: 6px 12px;
            border: 1px solid #833ab4;
            background: white;
            color: #833ab4;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            width: 100%;
        }
        
        .test-controls button:hover {
            background: #833ab4;
            color: white;
        }
        
        .debug-info {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 4px;
            font-size: 11px;
            font-family: monospace;
            z-index: 10000;
            max-width: 300px;
        }
        
        .debug-info div {
            margin: 2px 0;
        }
        
        .selected-block-info {
            background: rgba(131, 58, 180, 0.1);
            padding: 8px;
            border-radius: 4px;
            margin-top: 8px;
        }
        
        .blocks-list {
            max-height: 150px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 5px;
            margin: 5px 0;
        }
        
        .block-item {
            padding: 4px;
            margin: 2px 0;
            background: #f5f5f5;
            border-radius: 3px;
            font-size: 10px;
            cursor: pointer;
        }
        
        .block-item.active {
            background: #833ab4;
            color: white;
        }
        
        .block-item:hover {
            background: #e0e0e0;
        }
        
        .block-item.active:hover {
            background: #6d2d96;
        }
    </style>
</head>
<body>
    <div id="loading" class="loading">
        <div class="spinner"></div>
        <div class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞ FlashPost...</div>
    </div>

    <div id="app" class="app"></div>
    
    <!-- –ö–æ–Ω—Ç—Ä–æ–ª—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <div class="test-controls">
        <h3>üß™ –¢–µ—Å—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤</h3>
        
        <button onclick="testCreateCarousel()">1. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞—Ä—É—Å–µ–ª—å</button>
        <button onclick="testOpenEditor()">2. –û—Ç–∫—Ä—ã—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä</button>
        <button onclick="testAddTextBlock()">3. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫</button>
        <button onclick="testSelectFirstBlock()">4. –í—ã–±—Ä–∞—Ç—å –ø–µ—Ä–≤—ã–π –±–ª–æ–∫</button>
        <button onclick="testSelectSecondBlock()">5. –í—ã–±—Ä–∞—Ç—å –≤—Ç–æ—Ä–æ–π –±–ª–æ–∫</button>
        <button onclick="testDeleteSelectedBlock()">6. –£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π –±–ª–æ–∫</button>
        <button onclick="testUpdateBlockText()">7. –ò–∑–º–µ–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç –±–ª–æ–∫–∞</button>
        <button onclick="testUpdateBlockStyle()">8. –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∏–ª—å –±–ª–æ–∫–∞</button>
        <button onclick="showBlocksStructure()">9. –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–ª–æ–∫–æ–≤</button>
        
        <div class="blocks-list" id="testBlocksList"></div>
    </div>
    
    <!-- –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="debug-info" id="debugInfo">
        <div>–†–µ–∂–∏–º: <span id="currentMode">start</span></div>
        <div>–°–ª–∞–π–¥–æ–≤: <span id="slidesCount">0</span></div>
        <div>–¢–µ–∫—É—â–∏–π —Å–ª–∞–π–¥: <span id="currentSlide">0</span></div>
        <div>–ë–ª–æ–∫–æ–≤ –Ω–∞ —Å–ª–∞–π–¥–µ: <span id="blocksCount">0</span></div>
        <div>–í—ã–±—Ä–∞–Ω–Ω—ã–π –±–ª–æ–∫: <span id="selectedBlock">none</span></div>
        
        <div class="selected-block-info" id="selectedBlockInfo" style="display: none;">
            <div><strong>–í—ã–±—Ä–∞–Ω–Ω—ã–π –±–ª–æ–∫:</strong></div>
            <div>ID: <span id="blockId"></span></div>
            <div>–¢–µ–∫—Å—Ç: <span id="blockText"></span></div>
            <div>–®—Ä–∏—Ñ—Ç: <span id="blockFont"></span></div>
            <div>–†–∞–∑–º–µ—Ä: <span id="blockSize"></span></div>
            <div>–ü–æ–∑–∏—Ü–∏—è: <span id="blockPosition"></span></div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const app = new FlashPostApp();
        
        // –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function testCreateCarousel() {
            console.log('üß™ –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞—Ä—É—Å–µ–ª—å...');
            
            // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–ª–∞–π–¥—ã
            app.slides = [
                {
                    id: "slide_test_1",
                    title: "–¢–µ—Å—Ç–æ–≤—ã–π —Å–ª–∞–π–¥ 1",
                    text: "–ü–µ—Ä–≤—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Å–ª–∞–π–¥",
                    background: { type: "color", color: "#833ab4" },
                    textBlocks: [
                        {
                            id: "block_test_1",
                            text: "–ü–µ—Ä–≤—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫",
                            position: { x: 30, y: 30 },
                            width: 60,
                            font: "Inter",
                            size: 18,
                            weight: 700,
                            color: "#ffffff",
                            glow: false,
                            isKeyword: false,
                            keywordColor: "#ff6b6b",
                            highlightEnabled: true,
                            autoHighlight: true
                        }
                    ],
                    autoKeywords: ["—Ç–µ—Å—Ç–æ–≤—ã–π", "–±–ª–æ–∫"]
                },
                {
                    id: "slide_test_2",
                    title: "–¢–µ—Å—Ç–æ–≤—ã–π —Å–ª–∞–π–¥ 2",
                    text: "–í—Ç–æ—Ä–æ–π —Ç–µ—Å—Ç–æ–≤—ã–π —Å–ª–∞–π–¥",
                    background: { type: "color", color: "#28a745" },
                    textBlocks: [
                        {
                            id: "block_test_2",
                            text: "–í—Ç–æ—Ä–æ–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫",
                            position: { x: 50, y: 50 },
                            width: 70,
                            font: "Montserrat",
                            size: 16,
                            weight: 600,
                            color: "#ffffff",
                            glow: true,
                            isKeyword: false,
                            keywordColor: "#4ecdc4",
                            highlightEnabled: true,
                            autoHighlight: true
                        }
                    ],
                    autoKeywords: ["–≤—Ç–æ—Ä–æ–π", "—Å–ª–∞–π–¥"]
                }
            ];
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º slideStyles –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
            app.initializeSlideStyles();
            
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –≤—Å–µ –±–ª–æ–∫–∏
            app.slides.forEach((slide, index) => {
                app.syncAllTextBlocksToSlideStyles(index);
            });
            
            app.currentSlide = 0;
            app.currentEditingSlide = 0;
            
            app.enterPreviewMode();
            updateDebugInfo();
            
            console.log('‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è –∫–∞—Ä—É—Å–µ–ª—å —Å–æ–∑–¥–∞–Ω–∞');
        }
        
        function testOpenEditor() {
            if (app.slides.length === 0) {
                alert('–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞—Ä—É—Å–µ–ª—å!');
                return;
            }
            
            console.log('üß™ –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä...');
            app.enterEditMode();
            updateDebugInfo();
        }
        
        function testAddTextBlock() {
            if (!app.isMode("edit")) {
                alert('–°–Ω–∞—á–∞–ª–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä!');
                return;
            }
            
            console.log('üß™ –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫...');
            const newBlock = app.addTextBlock();
            updateDebugInfo();
            updateBlocksList();
            
            console.log('‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –±–ª–æ–∫:', newBlock.id);
        }
        
        function testSelectFirstBlock() {
            const blocks = app.getCurrentTextBlocks();
            if (blocks.length === 0) {
                alert('–ù–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞!');
                return;
            }
            
            console.log('üß™ –í—ã–±–∏—Ä–∞–µ–º –ø–µ—Ä–≤—ã–π –±–ª–æ–∫...');
            app.selectTextBlock(blocks[0].id);
            updateDebugInfo();
            updateBlocksList();
        }
        
        function testSelectSecondBlock() {
            const blocks = app.getCurrentTextBlocks();
            if (blocks.length < 2) {
                alert('–ù–µ—Ç –≤—Ç–æ—Ä–æ–≥–æ –±–ª–æ–∫–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞!');
                return;
            }
            
            console.log('üß™ –í—ã–±–∏—Ä–∞–µ–º –≤—Ç–æ—Ä–æ–π –±–ª–æ–∫...');
            app.selectTextBlock(blocks[1].id);
            updateDebugInfo();
            updateBlocksList();
        }
        
        function testDeleteSelectedBlock() {
            if (!app.selectedTextBlockId) {
                alert('–ù–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è!');
                return;
            }
            
            console.log('üß™ –£–¥–∞–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –±–ª–æ–∫...');
            app.deleteTextBlock(app.selectedTextBlockId);
            updateDebugInfo();
            updateBlocksList();
        }
        
        function testUpdateBlockText() {
            const selectedBlock = app.getSelectedTextBlock();
            if (!selectedBlock) {
                alert('–ù–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞!');
                return;
            }
            
            const newText = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç:', selectedBlock.text);
            if (newText !== null) {
                console.log('üß™ –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –±–ª–æ–∫–∞...');
                app.updateTextBlockProperty(selectedBlock.id, 'text', newText);
                updateDebugInfo();
            }
        }
        
        function testUpdateBlockStyle() {
            const selectedBlock = app.getSelectedTextBlock();
            if (!selectedBlock) {
                alert('–ù–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞!');
                return;
            }
            
            console.log('üß™ –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∏–ª—å –±–ª–æ–∫–∞...');
            app.updateTextBlockProperty(selectedBlock.id, 'size', 24);
            app.updateTextBlockProperty(selectedBlock.id, 'color', '#ff6b6b');
            app.updateTextBlockProperty(selectedBlock.id, 'font', 'Bebas Neue');
            updateDebugInfo();
        }
        
        function showBlocksStructure() {
            const currentSlide = app.slides[app.currentEditingSlide];
            if (!currentSlide) {
                alert('–ù–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–ª–∞–π–¥–∞!');
                return;
            }
            
            console.log('üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤:');
            console.log('–û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (slides):', currentSlide.textBlocks);
            console.log('–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å (slideStyles):', app.slideStyles[app.currentEditingSlide]?.textBlocks);
            
            alert(`–ë–ª–æ–∫–æ–≤ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ: ${currentSlide.textBlocks?.length || 0}\n–ë–ª–æ–∫–æ–≤ –≤ slideStyles: ${app.slideStyles[app.currentEditingSlide]?.textBlocks?.length || 0}`);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        function updateDebugInfo() {
            document.getElementById('currentMode').textContent = app.getMode();
            document.getElementById('slidesCount').textContent = app.slides.length;
            document.getElementById('currentSlide').textContent = app.currentEditingSlide + 1;
            
            const blocks = app.getCurrentTextBlocks();
            document.getElementById('blocksCount').textContent = blocks.length;
            
            const selectedBlock = app.getSelectedTextBlock();
            const selectedBlockInfo = document.getElementById('selectedBlockInfo');
            
            if (selectedBlock) {
                document.getElementById('selectedBlock').textContent = selectedBlock.id;
                document.getElementById('blockId').textContent = selectedBlock.id;
                document.getElementById('blockText').textContent = selectedBlock.text.substring(0, 20) + '...';
                document.getElementById('blockFont').textContent = selectedBlock.font;
                document.getElementById('blockSize').textContent = selectedBlock.size + 'px';
                document.getElementById('blockPosition').textContent = `${selectedBlock.position.x}%, ${selectedBlock.position.y}%`;
                selectedBlockInfo.style.display = 'block';
            } else {
                document.getElementById('selectedBlock').textContent = 'none';
                selectedBlockInfo.style.display = 'none';
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –±–ª–æ–∫–æ–≤
        function updateBlocksList() {
            const blocksList = document.getElementById('testBlocksList');
            const blocks = app.getCurrentTextBlocks();
            
            blocksList.innerHTML = '';
            
            blocks.forEach((block, index) => {
                const blockItem = document.createElement('div');
                blockItem.className = `block-item ${app.selectedTextBlockId === block.id ? 'active' : ''}`;
                blockItem.textContent = `${index + 1}. ${block.text.substring(0, 15)}... (${block.font}, ${block.size}px)`;
                blockItem.onclick = () => {
                    app.selectTextBlock(block.id);
                    updateDebugInfo();
                    updateBlocksList();
                };
                blocksList.appendChild(blockItem);
            });
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
        setInterval(() => {
            updateDebugInfo();
            updateBlocksList();
        }, 1000);
        
        // –ù–∞—á–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
        setTimeout(() => {
            updateDebugInfo();
            updateBlocksList();
        }, 500);
        
        console.log('üß™ –¢–µ—Å—Ç —É–ª—É—á—à–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤ –∑–∞–ø—É—â–µ–Ω');
        console.log('üìã –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ —Å–ø—Ä–∞–≤–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π');
    </script>
</body>
</html>