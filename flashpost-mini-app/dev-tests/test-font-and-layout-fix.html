<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlashPost - –¢–µ—Å—Ç —à—Ä–∏—Ñ—Ç–æ–≤ –∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è</title>
    <link rel="stylesheet" href="app.css">
    <style>
        :root {
            --tg-bg: #ffffff;
            --tg-text: #000000;
            --primary: #833ab4;
        }
        
        .debug-panel {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid #e5e5e5;
            border-radius: 8px;
            padding: 12px;
            font-size: 11px;
            z-index: 1000;
            max-width: 250px;
        }
        
        .debug-item {
            margin: 4px 0;
            padding: 4px 6px;
            background: #f8f9fa;
            border-radius: 3px;
            font-family: monospace;
        }
        
        .debug-item.success {
            background: #e8f5e8;
            color: #2e7d32;
        }
        
        .debug-item.error {
            background: #ffebee;
            color: #c62828;
        }
        
        .test-controls {
            position: fixed;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            z-index: 1000;
        }
        
        .test-btn {
            padding: 8px 16px;
            background: #833ab4;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .test-btn:hover {
            background: #6d2d96;
        }
        
        .test-btn.secondary {
            background: #6c757d;
        }
        
        .test-btn.secondary:hover {
            background: #5a6268;
        }
    </style>
</head>
<body>
    <div class="debug-panel">
        <h4>üîß –¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π</h4>
        <div class="debug-item" id="fontSliderStatus">–°–ª–∞–π–¥–µ—Ä: –ø—Ä–æ–≤–µ—Ä–∫–∞...</div>
        <div class="debug-item" id="fontSizeDisplay">–†–∞–∑–º–µ—Ä: 0px</div>
        <div class="debug-item" id="textBlocksCount">–ë–ª–æ–∫–æ–≤: 0</div>
        <div class="debug-item" id="globalSettingsPos">–ù–∞—Å—Ç—Ä–æ–π–∫–∏: –ø—Ä–æ–≤–µ—Ä–∫–∞...</div>
    </div>
    
    <div class="test-controls">
        <button class="test-btn" onclick="openEditorTest()">–û—Ç–∫—Ä—ã—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä</button>
        <button class="test-btn secondary" onclick="testFontSizeChange()">–¢–µ—Å—Ç —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞</button>
        <button class="test-btn secondary" onclick="checkGlobalSettings()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
    </div>

    <div id="app">
        <div style="padding: 40px; text-align: center;">
            <h2>–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤...</h2>
            <p>–ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —à—Ä–∏—Ñ—Ç–æ–≤ –∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –ø–∞–Ω–µ–ª–∏</p>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        const app = new FlashPostApp();
        
        // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        app.slides = [
            {
                title: "Hook",
                text: "üî• –¢–µ—Å—Ç–æ–≤—ã–π —Å–ª–∞–π–¥ 1\n\n–ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –±–ª–æ–∫–∞—Ö."
            },
            {
                title: "Problem", 
                text: "‚ùå –¢–µ—Å—Ç–æ–≤—ã–π —Å–ª–∞–π–¥ 2\n\n–ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤–Ω–∏–∑—É –ø–∞–Ω–µ–ª–∏."
            },
            {
                title: "Solution",
                text: "‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π —Å–ª–∞–π–¥ 3\n\n–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞ –º–µ–∂–¥—É —Å–ª–∞–π–¥–µ—Ä–æ–º –∏ –±–ª–æ–∫–∞–º–∏."
            }
        ];
        
        app.initializeSlideStyles();
        
        // –î–æ–±–∞–≤–ª—è–µ–º Instagram –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        const instagramInput = document.createElement('input');
        instagramInput.id = 'instagramInput';
        instagramInput.value = '@test_font_fix';
        instagramInput.style.display = 'none';
        document.body.appendChild(instagramInput);
        
        // –§—É–Ω–∫—Ü–∏–∏ –æ—Ç–ª–∞–¥–∫–∏
        function updateDebugInfo() {
            const fontSliderStatusEl = document.getElementById('fontSliderStatus');
            const fontSizeDisplayEl = document.getElementById('fontSizeDisplay');
            const textBlocksCountEl = document.getElementById('textBlocksCount');
            const globalSettingsPosEl = document.getElementById('globalSettingsPos');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ª–∞–π–¥–µ—Ä —à—Ä–∏—Ñ—Ç–∞
            const fontSizeSlider = document.getElementById('fontSizeSlider');
            const fontSizeValue = document.getElementById('fontSizeValue');
            
            if (fontSizeSlider && fontSizeValue) {
                fontSliderStatusEl.textContent = `–°–ª–∞–π–¥–µ—Ä: –Ω–∞–π–¥–µ–Ω (${fontSizeSlider.value})`;
                fontSliderStatusEl.className = 'debug-item success';
                fontSizeDisplayEl.textContent = `–†–∞–∑–º–µ—Ä: ${fontSizeValue.textContent}`;
            } else {
                fontSliderStatusEl.textContent = '–°–ª–∞–π–¥–µ—Ä: –Ω–µ –Ω–∞–π–¥–µ–Ω';
                fontSliderStatusEl.className = 'debug-item error';
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –±–ª–æ–∫–∏
            const textBlocks = document.querySelectorAll('.preview-text-block');
            textBlocksCountEl.textContent = `–ë–ª–æ–∫–æ–≤: ${textBlocks.length}`;
            
            if (textBlocks.length > 0) {
                const firstBlock = textBlocks[0];
                const fontSize = window.getComputedStyle(firstBlock).fontSize;
                fontSizeDisplayEl.textContent = `–†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞: ${fontSize}`;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
            const globalSettings = document.querySelector('.global-settings');
            if (globalSettings) {
                const toolSections = document.querySelectorAll('.tool-section');
                const globalIndex = Array.from(toolSections).indexOf(globalSettings);
                const isLast = globalIndex === toolSections.length - 1;
                
                globalSettingsPosEl.textContent = `–ù–∞—Å—Ç—Ä–æ–π–∫–∏: ${isLast ? '–≤–Ω–∏–∑—É ‚úì' : '–Ω–µ –≤–Ω–∏–∑—É ‚úó'}`;
                globalSettingsPosEl.className = `debug-item ${isLast ? 'success' : 'error'}`;
            } else {
                globalSettingsPosEl.textContent = '–ù–∞—Å—Ç—Ä–æ–π–∫–∏: –Ω–µ –Ω–∞–π–¥–µ–Ω—ã';
                globalSettingsPosEl.className = 'debug-item error';
            }
        }
        
        function openEditorTest() {
            console.log('üß™ –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...');
            app.openEditor();
            setTimeout(updateDebugInfo, 500);
        }
        
        function testFontSizeChange() {
            console.log('üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞...');
            const fontSizeSlider = document.getElementById('fontSizeSlider');
            
            if (fontSizeSlider) {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä
                const originalSize = fontSizeSlider.value;
                console.log('üìè –ò—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä:', originalSize);
                
                // –ò–∑–º–µ–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä –Ω–∞ 20px
                fontSizeSlider.value = 20;
                fontSizeSlider.dispatchEvent(new Event('input'));
                
                setTimeout(() => {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ä–∞–∑–º–µ—Ä –∏–∑–º–µ–Ω–∏–ª—Å—è –≤ –±–ª–æ–∫–∞—Ö
                    const textBlocks = document.querySelectorAll('.preview-text-block');
                    if (textBlocks.length > 0) {
                        const fontSize = window.getComputedStyle(textBlocks[0]).fontSize;
                        console.log('‚úÖ –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ –≤ –±–ª–æ–∫–µ:', fontSize);
                        
                        if (fontSize === '20px') {
                            console.log('‚úÖ –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ –∏–∑–º–µ–Ω–∏–ª—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!');
                        } else {
                            console.error('‚ùå –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è:', fontSize);
                        }
                    }
                    
                    updateDebugInfo();
                    
                    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        fontSizeSlider.value = originalSize;
                        fontSizeSlider.dispatchEvent(new Event('input'));
                        updateDebugInfo();
                    }, 2000);
                }, 300);
            } else {
                console.error('‚ùå –°–ª–∞–π–¥–µ—Ä —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω');
            }
        }
        
        function checkGlobalSettings() {
            console.log('üß™ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫...');
            const globalSettings = document.querySelector('.global-settings');
            const toolSections = document.querySelectorAll('.tool-section');
            
            if (globalSettings) {
                const rect = globalSettings.getBoundingClientRect();
                const editorTools = document.querySelector('.editor-tools');
                const editorRect = editorTools.getBoundingClientRect();
                
                console.log('üìç –ü–æ–∑–∏—Ü–∏—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫:', {
                    top: rect.top,
                    bottom: rect.bottom,
                    editorBottom: editorRect.bottom
                });
                
                const isAtBottom = Math.abs(rect.bottom - editorRect.bottom) < 50;
                console.log(isAtBottom ? '‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–Ω–∏–∑—É –ø–∞–Ω–µ–ª–∏' : '‚ùå –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ –≤–Ω–∏–∑—É');
            } else {
                console.error('‚ùå –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
            }
            
            updateDebugInfo();
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä
        setTimeout(() => {
            console.log('üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä...');
            openEditorTest();
        }, 1000);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
        setInterval(updateDebugInfo, 3000);
        
        console.log(`
üîß –¢–ï–°–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô –®–†–ò–§–¢–û–í –ò LAYOUT

–ü—Ä–æ–≤–µ—Ä—è–µ–º:
‚úÖ –†–∞–±–æ—Ç—É –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞
‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –º–µ–∂–¥—É —Å–ª–∞–π–¥–µ—Ä–æ–º –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ –±–ª–æ–∫–∞–º–∏
‚úÖ –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤–Ω–∏–∑—É –ø–∞–Ω–µ–ª–∏
‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–≤—å—é

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ —Å–ª–µ–≤–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!
        `);
        
        console.log('‚úÖ –¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≥–æ—Ç–æ–≤');
    </script>
</body>
</html>