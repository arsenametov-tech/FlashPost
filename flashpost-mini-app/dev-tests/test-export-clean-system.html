<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–∞ —á–∏—Å—Ç–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ - FlashPost</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Inter, sans-serif;
            background: linear-gradient(135deg, #833ab4 0%, #fd1d1d 25%, #fcb045 50%, #f77737 75%, #e1306c 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .title {
            text-align: center;
            margin-bottom: 20px;
            color: #333;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .btn {
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        
        .btn-primary {
            background: #833ab4;
            color: white;
        }
        
        .btn-primary:hover {
            background: #6d2d96;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        
        .btn-info:hover {
            background: #138496;
        }
        
        .btn-warning {
            background: #ffc107;
            color: #212529;
        }
        
        .btn-warning:hover {
            background: #e0a800;
        }
        
        .mode-indicator {
            background: #e9ecef;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }
        
        .mode-indicator.preview {
            background: #d4edda;
            color: #155724;
        }
        
        .mode-indicator.edit {
            background: #fff3cd;
            color: #856404;
        }
        
        .mode-indicator.export {
            background: #f8d7da;
            color: #721c24;
        }
        
        .slides-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .slide {
            position: relative;
            width: 100%;
            height: 400px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .slide-text {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            font-size: 18px;
            line-height: 1.4;
            color: white;
            text-shadow: 0 1px 3px rgba(0,0,0,0.3);
            font-family: Inter, sans-serif;
            font-weight: 600;
        }
        
        /* –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è - —Å –∫–æ–Ω—Ç—Ä–æ–ª–∞–º–∏ */
        .mode-edit .slide {
            border: 2px dashed #dee2e6;
        }
        
        .mode-edit .slide::after {
            content: '‚úèÔ∏è –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è';
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        /* –†–µ–∂–∏–º –ø—Ä–µ–≤—å—é - —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π */
        .mode-preview .slide {
            border: 2px solid #28a745;
        }
        
        .mode-preview .slide::after {
            content: 'üëÅÔ∏è –†–µ–∂–∏–º –ø—Ä–µ–≤—å—é';
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(40, 167, 69, 0.9);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        /* –†–µ–∂–∏–º —ç–∫—Å–ø–æ—Ä—Ç–∞ - —á–∏—Å—Ç—ã–µ —Å–ª–∞–π–¥—ã */
        .mode-export .slide {
            border: none;
            box-shadow: none;
        }
        
        .mode-export .slide::after {
            display: none;
        }
        
        .export-log {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 16px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #dee2e6;
        }
        
        .log-entry {
            margin-bottom: 4px;
            padding: 2px 0;
        }
        
        .log-step {
            color: #833ab4;
            font-weight: bold;
        }
        
        .log-success {
            color: #28a745;
        }
        
        .log-error {
            color: #dc3545;
        }
        
        .log-info {
            color: #17a2b8;
        }
        
        .exported-images {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }
        
        .exported-image {
            border: 2px solid #dee2e6;
            border-radius: 8px;
            overflow: hidden;
            background: white;
        }
        
        .exported-image img {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .exported-image .image-info {
            padding: 8px;
            font-size: 12px;
            color: #6c757d;
            text-align: center;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #833ab4, #fd1d1d);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .loading-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            max-width: 300px;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #833ab4;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">üì§ –°–∏—Å—Ç–µ–º–∞ —á–∏—Å—Ç–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞</h1>
        
        <div class="mode-indicator" id="modeIndicator">
            –†–µ–∂–∏–º: preview
        </div>
        
        <div class="controls">
            <button class="btn btn-info" onclick="setMode('preview')">üëÅÔ∏è –ü—Ä–µ–≤—å—é</button>
            <button class="btn btn-warning" onclick="setMode('edit')">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
            <button class="btn btn-primary" onclick="setMode('export')">üì§ –≠–∫—Å–ø–æ—Ä—Ç</button>
            <button class="btn btn-success" onclick="exportSlides()">üíæ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ</button>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <div class="slides-container mode-preview" id="slidesContainer">
            <!-- –°–ª–∞–π–¥—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã JS -->
        </div>
        
        <div class="export-log" id="exportLog">
            <div class="log-entry log-info">üìã –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —ç–∫—Å–ø–æ—Ä—Ç—É</div>
        </div>
        
        <div class="exported-images" id="exportedImages">
            <!-- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
        </div>
    </div>
    
    <!-- –ó–∞–≥—Ä—É–∑–æ—á–Ω—ã–π –æ–≤–µ—Ä–ª–µ–π -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <div id="loadingText">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Å–ª–∞–π–¥—ã...</div>
        </div>
    </div>

    <script>
        // ===== –°–ò–°–¢–ï–ú–ê –ß–ò–°–¢–û–ì–û –≠–ö–°–ü–û–†–¢–ê =====
        
        class CleanExportSystem {
            constructor() {
                this.mode = 'preview';
                this.slides = [];
                this.exportLog = [];
                this.exportedImages = [];
                
                console.log('üì§ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —á–∏—Å—Ç–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞');
                this.init();
            }
            
            init() {
                this.createTestSlides();
                this.render();
                this.logInfo('–°–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–ª–∞–π–¥–æ–≤
            createTestSlides() {
                this.slides = [
                    {
                        id: 'slide_1',
                        background: { color: '#ff6b6b' },
                        text: '–ü–µ—Ä–≤—ã–π —Å–ª–∞–π–¥ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞\n–ü—Ä–æ–≤–µ—Ä—è–µ–º —á–∏—Å—Ç—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥'
                    },
                    {
                        id: 'slide_2', 
                        background: { color: '#4ecdc4' },
                        text: '–í—Ç–æ—Ä–æ–π —Å–ª–∞–π–¥\n–ë–µ–∑ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞'
                    },
                    {
                        id: 'slide_3',
                        background: { color: '#45b7d1' },
                        text: '–¢—Ä–µ—Ç–∏–π —Å–ª–∞–π–¥\n–ì–æ—Ç–æ–≤ –∫ —ç–∫—Å–ø–æ—Ä—Ç—É –≤ PNG'
                    }
                ];
            }
            
            // ===== –£–ü–†–ê–í–õ–ï–ù–ò–ï –†–ï–ñ–ò–ú–ê–ú–ò =====
            
            async setMode(newMode) {
                const oldMode = this.mode;
                this.mode = newMode;
                
                this.logStep(`–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞: ${oldMode} ‚Üí ${newMode}`);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º UI
                this.updateModeIndicator();
                this.updateSlidesContainer();
                
                // –ñ–¥–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è DOM
                await this.nextTick();
                
                this.logSuccess(`‚úÖ –†–µ–∂–∏–º ${newMode} –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω`);
                
                return true;
            }
            
            updateModeIndicator() {
                const indicator = document.getElementById('modeIndicator');
                indicator.className = `mode-indicator ${this.mode}`;
                
                const modeNames = {
                    preview: 'üëÅÔ∏è –ü—Ä–µ–≤—å—é',
                    edit: '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ', 
                    export: 'üì§ –≠–∫—Å–ø–æ—Ä—Ç'
                };
                
                indicator.textContent = `–†–µ–∂–∏–º: ${modeNames[this.mode]}`;
            }
            
            updateSlidesContainer() {
                const container = document.getElementById('slidesContainer');
                container.className = `slides-container mode-${this.mode}`;
                
                // –ü–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞–µ–º —Å–ª–∞–π–¥—ã –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞
                this.renderSlides();
            }
            
            // ===== –†–ï–ù–î–ï–†–ò–ù–ì –°–õ–ê–ô–î–û–í =====
            
            renderSlides() {
                const container = document.getElementById('slidesContainer');
                
                container.innerHTML = this.slides.map((slide, index) => `
                    <div class="slide" id="slide_${index}" style="background: ${slide.background.color};">
                        <div class="slide-text">${slide.text.replace(/\n/g, '<br>')}</div>
                    </div>
                `).join('');
            }
            
            // ===== –°–ò–°–¢–ï–ú–ê –≠–ö–°–ü–û–†–¢–ê =====
            
            async exportSlides() {
                this.logStep('üöÄ –ù–∞—á–∞–ª–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å–ª–∞–π–¥–æ–≤');
                this.showLoading('–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —ç–∫—Å–ø–æ—Ä—Ç—É...');
                
                try {
                    // –®–∞–≥ 1: –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –≤ —Ä–µ–∂–∏–º —ç–∫—Å–ø–æ—Ä—Ç–∞
                    await this.setMode('export');
                    this.updateProgress(10);
                    
                    // –®–∞–≥ 2: –ñ–¥–µ–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —á–∏—Å—Ç—ã—Ö —Å–ª–∞–π–¥–æ–≤
                    this.showLoading('–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —á–∏—Å—Ç—ã—Ö —Å–ª–∞–π–¥–æ–≤...');
                    await this.nextTick();
                    await this.delay(100); // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
                    this.updateProgress(20);
                    
                    // –®–∞–≥ 3: –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–∞–∂–¥—ã–π —Å–ª–∞–π–¥
                    this.exportedImages = [];
                    
                    for (let i = 0; i < this.slides.length; i++) {
                        const slide = this.slides[i];
                        this.showLoading(`–≠–∫—Å–ø–æ—Ä—Ç —Å–ª–∞–π–¥–∞ ${i + 1} –∏–∑ ${this.slides.length}...`);
                        
                        this.logInfo(`üì∏ –≠–∫—Å–ø–æ—Ä—Ç —Å–ª–∞–π–¥–∞ ${i + 1}: ${slide.id}`);
                        
                        const imageData = await this.exportSlide(i);
                        this.exportedImages.push({
                            slideIndex: i,
                            slideId: slide.id,
                            imageData: imageData,
                            timestamp: new Date().toISOString()
                        });
                        
                        this.updateProgress(20 + (i + 1) / this.slides.length * 70);
                        this.logSuccess(`‚úÖ –°–ª–∞–π–¥ ${i + 1} —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω`);
                    }
                    
                    // –®–∞–≥ 4: –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                    this.showLoading('–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...');
                    await this.delay(500);
                    this.renderExportedImages();
                    this.updateProgress(100);
                    
                    // –®–∞–≥ 5: –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ —Ä–µ–∂–∏–º –ø—Ä–µ–≤—å—é
                    await this.setMode('preview');
                    
                    this.hideLoading();
                    this.logSuccess(`üéâ –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω! –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${this.exportedImages.length} —Å–ª–∞–π–¥–æ–≤`);
                    
                } catch (error) {
                    this.hideLoading();
                    this.logError(`‚ùå –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞: ${error.message}`);
                    console.error('–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞:', error);
                    
                    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ —Ä–µ–∂–∏–º –ø—Ä–µ–≤—å—é –ø—Ä–∏ –æ—à–∏–±–∫–µ
                    await this.setMode('preview');
                }
            }
            
            async exportSlide(slideIndex) {
                const slideElement = document.getElementById(`slide_${slideIndex}`);
                if (!slideElement) {
                    throw new Error(`–°–ª–∞–π–¥ ${slideIndex} –Ω–µ –Ω–∞–π–¥–µ–Ω`);
                }
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ html2canvas –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞
                const options = {
                    backgroundColor: null,
                    scale: 2, // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
                    useCORS: true,
                    allowTaint: true,
                    width: slideElement.offsetWidth,
                    height: slideElement.offsetHeight,
                    scrollX: 0,
                    scrollY: 0
                };
                
                try {
                    const canvas = await html2canvas(slideElement, options);
                    const imageData = canvas.toDataURL('image/png', 1.0);
                    
                    this.logInfo(`üìä –†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ${canvas.width}x${canvas.height}`);
                    
                    return imageData;
                    
                } catch (error) {
                    this.logError(`–û—à–∏–±–∫–∞ html2canvas –¥–ª—è —Å–ª–∞–π–¥–∞ ${slideIndex}: ${error.message}`);
                    throw error;
                }
            }
            
            // ===== –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–û–í =====
            
            renderExportedImages() {
                const container = document.getElementById('exportedImages');
                
                if (this.exportedImages.length === 0) {
                    container.innerHTML = '<p>–ù–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</p>';
                    return;
                }
                
                container.innerHTML = this.exportedImages.map((exported, index) => `
                    <div class="exported-image">
                        <img src="${exported.imageData}" alt="–°–ª–∞–π–¥ ${index + 1}">
                        <div class="image-info">
                            –°–ª–∞–π–¥ ${index + 1} ‚Ä¢ ${new Date(exported.timestamp).toLocaleTimeString()}
                            <br>
                            <a href="${exported.imageData}" download="slide_${index + 1}.png" 
                               style="color: #833ab4; text-decoration: none;">üíæ –°–∫–∞—á–∞—Ç—å</a>
                        </div>
                    </div>
                `).join('');
            }
            
            // ===== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò =====
            
            // –û–∂–∏–¥–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç–∏–∫–∞ —Å–æ–±—ã—Ç–∏–π
            nextTick() {
                return new Promise(resolve => {
                    requestAnimationFrame(() => {
                        requestAnimationFrame(resolve);
                    });
                });
            }
            
            // –ó–∞–¥–µ—Ä–∂–∫–∞
            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            updateProgress(percent) {
                const progressFill = document.getElementById('progressFill');
                progressFill.style.width = `${percent}%`;
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
            showLoading(text) {
                const overlay = document.getElementById('loadingOverlay');
                const loadingText = document.getElementById('loadingText');
                
                loadingText.textContent = text;
                overlay.style.display = 'flex';
            }
            
            // –°–∫—Ä—ã—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
            hideLoading() {
                const overlay = document.getElementById('loadingOverlay');
                overlay.style.display = 'none';
                this.updateProgress(0);
            }
            
            // ===== –õ–û–ì–ò–†–û–í–ê–ù–ò–ï =====
            
            logStep(message) {
                this.exportLog.push({ type: 'step', message, timestamp: new Date() });
                this.updateLog();
                console.log('üìã', message);
            }
            
            logSuccess(message) {
                this.exportLog.push({ type: 'success', message, timestamp: new Date() });
                this.updateLog();
                console.log('‚úÖ', message);
            }
            
            logError(message) {
                this.exportLog.push({ type: 'error', message, timestamp: new Date() });
                this.updateLog();
                console.error('‚ùå', message);
            }
            
            logInfo(message) {
                this.exportLog.push({ type: 'info', message, timestamp: new Date() });
                this.updateLog();
                console.log('‚ÑπÔ∏è', message);
            }
            
            updateLog() {
                const logContainer = document.getElementById('exportLog');
                const recentEntries = this.exportLog.slice(-15); // –ü–æ—Å–ª–µ–¥–Ω–∏–µ 15 –∑–∞–ø–∏—Å–µ–π
                
                logContainer.innerHTML = recentEntries.map(entry => `
                    <div class="log-entry log-${entry.type}">
                        [${entry.timestamp.toLocaleTimeString()}] ${entry.message}
                    </div>
                `).join('');
                
                // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
                logContainer.scrollTop = logContainer.scrollHeight;
            }
            
            render() {
                this.updateModeIndicator();
                this.renderSlides();
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
        let exportSystem;
        
        document.addEventListener('DOMContentLoaded', () => {
            exportSystem = new CleanExportSystem();
            console.log('üì§ –°–∏—Å—Ç–µ–º–∞ —á–∏—Å—Ç–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
        });
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
        async function setMode(mode) {
            await exportSystem.setMode(mode);
        }
        
        async function exportSlides() {
            await exportSystem.exportSlides();
        }
    </script>
</body>
</html>