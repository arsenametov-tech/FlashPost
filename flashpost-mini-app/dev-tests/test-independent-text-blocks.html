<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>FlashPost - –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –±–ª–æ–∫–∏</title>
    <link rel="stylesheet" href="app.css">
    <style>
        :root {
            --tg-bg: #ffffff;
            --tg-text: #000000;
            --primary: #833ab4;
        }
        
        .test-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid #e5e5e5;
            border-radius: 8px;
            padding: 12px;
            font-size: 11px;
            z-index: 1000;
            max-width: 250px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .test-item {
            margin: 6px 0;
            padding: 4px 6px;
            background: #f8f9fa;
            border-radius: 3px;
            font-family: monospace;
        }
        
        .test-item.success {
            background: #e8f5e8;
            color: #2e7d32;
        }
        
        .test-item.error {
            background: #ffebee;
            color: #c62828;
        }
        
        .test-controls {
            position: fixed;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            z-index: 1000;
        }
        
        .test-btn {
            padding: 8px 16px;
            background: #833ab4;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .test-btn:hover {
            background: #6d2d96;
        }
        
        .test-btn.secondary {
            background: #6c757d;
        }
        
        .test-btn.secondary:hover {
            background: #5a6268;
        }
        
        .test-btn.danger {
            background: #dc3545;
        }
        
        .test-btn.danger:hover {
            background: #c82333;
        }
    </style>
</head>
<body>
    <div class="test-panel">
        <h4>üß© –¢–µ—Å—Ç –±–ª–æ–∫–æ–≤</h4>
        <div class="test-item" id="blocksCount">–ë–ª–æ–∫–æ–≤: 0</div>
        <div class="test-item" id="selectedBlock">–í—ã–±—Ä–∞–Ω: –Ω–µ—Ç</div>
        <div class="test-item" id="addButton">–ö–Ω–æ–ø–∫–∞ +: –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</div>
        <div class="test-item" id="deleteButton">–ö–Ω–æ–ø–∫–∞ -: –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</div>
        <div class="test-item" id="dataStructure">–°—Ç—Ä—É–∫—Ç—É—Ä–∞: –ø—Ä–æ–≤–µ—Ä–∫–∞...</div>
    </div>
    
    <div class="test-controls">
        <button class="test-btn" onclick="openEditor()">–û—Ç–∫—Ä—ã—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä</button>
        <button class="test-btn secondary" onclick="testAddBlock()">–î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫</button>
        <button class="test-btn secondary" onclick="testSelectBlock()">–í—ã–±—Ä–∞—Ç—å –±–ª–æ–∫</button>
        <button class="test-btn danger" onclick="testDeleteBlock()">–£–¥–∞–ª–∏—Ç—å –±–ª–æ–∫</button>
        <button class="test-btn secondary" onclick="checkStructure()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É</button>
    </div>

    <div id="app">
        <div style="padding: 40px; text-align: center; height: 100vh; display: flex; flex-direction: column; justify-content: center;">
            <h2>–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –±–ª–æ–∫–∏</h2>
            <p>–¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã —Å–æ–∑–¥–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ –±–ª–æ–∫–∞–º–∏</p>
            <p style="font-size: 12px; color: #666;">–ö–∞–∂–¥—ã–π –±–ª–æ–∫ –∏–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: —Ç–µ–∫—Å—Ç, —à—Ä–∏—Ñ—Ç, —Ä–∞–∑–º–µ—Ä, –ø–æ–∑–∏—Ü–∏—é</p>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        const app = new FlashPostApp();
        
        // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        app.slides = [
            {
                title: "–ë–ª–æ–∫–∏",
                text: "üß© –¢–µ—Å—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –±–ª–æ–∫–æ–≤\n\n–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤."
            },
            {
                title: "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ", 
                text: "‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞–º–∏\n\n–ö–∞–∂–¥—ã–π –±–ª–æ–∫ –∏–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: —à—Ä–∏—Ñ—Ç, —Ä–∞–∑–º–µ—Ä, —Ü–≤–µ—Ç, –ø–æ–∑–∏—Ü–∏—é."
            },
            {
                title: "–°—Ç—Ä—É–∫—Ç—É—Ä–∞",
                text: "üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö\n\nslide = {id, background, textBlocks: [{id, text, x, y, font, size, weight, glow, color}]}"
            }
        ];
        
        app.initializeSlideStyles();
        
        // –î–æ–±–∞–≤–ª—è–µ–º Instagram –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        const instagramInput = document.createElement('input');
        instagramInput.id = 'instagramInput';
        instagramInput.value = '@blocks_test';
        instagramInput.style.display = 'none';
        document.body.appendChild(instagramInput);
        
        function updateTestInfo() {
            const blocksCountEl = document.getElementById('blocksCount');
            const selectedBlockEl = document.getElementById('selectedBlock');
            const addButtonEl = document.getElementById('addButton');
            const deleteButtonEl = document.getElementById('deleteButton');
            const dataStructureEl = document.getElementById('dataStructure');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤
            const currentSlide = app.slides[app.currentEditingSlide];
            if (currentSlide && currentSlide.textBlocks) {
                blocksCountEl.textContent = `–ë–ª–æ–∫–æ–≤: ${currentSlide.textBlocks.length}`;
                blocksCountEl.className = 'test-item success';
            } else {
                blocksCountEl.textContent = '–ë–ª–æ–∫–æ–≤: 0';
                blocksCountEl.className = 'test-item error';
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –±–ª–æ–∫
            if (app.selectedTextBlockId) {
                const selectedBlock = currentSlide.textBlocks.find(b => b.id === app.selectedTextBlockId);
                selectedBlockEl.textContent = `–í—ã–±—Ä–∞–Ω: ${selectedBlock ? selectedBlock.text.substring(0, 20) + '...' : '–Ω–µ –Ω–∞–π–¥–µ–Ω'}`;
                selectedBlockEl.className = selectedBlock ? 'test-item success' : 'test-item error';
            } else {
                selectedBlockEl.textContent = '–í—ã–±—Ä–∞–Ω: –Ω–µ—Ç';
                selectedBlockEl.className = 'test-item';
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–Ω–æ–ø–∫–∏
            const addBtn = document.getElementById('addTextBlockBtn');
            addButtonEl.textContent = `–ö–Ω–æ–ø–∫–∞ +: ${addBtn ? '–Ω–∞–π–¥–µ–Ω–∞' : '–Ω–µ –Ω–∞–π–¥–µ–Ω–∞'}`;
            addButtonEl.className = `test-item ${addBtn ? 'success' : 'error'}`;
            
            const deleteBtn = document.getElementById('deleteTextBlockBtn');
            deleteButtonEl.textContent = `–ö–Ω–æ–ø–∫–∞ -: ${deleteBtn ? '–Ω–∞–π–¥–µ–Ω–∞' : '–Ω–µ –Ω–∞–π–¥–µ–Ω–∞'}`;
            deleteButtonEl.className = `test-item ${deleteBtn ? 'success' : 'error'}`;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
            const hasCorrectStructure = currentSlide && 
                currentSlide.id && 
                currentSlide.background && 
                Array.isArray(currentSlide.textBlocks);
            
            dataStructureEl.textContent = `–°—Ç—Ä—É–∫—Ç—É—Ä–∞: ${hasCorrectStructure ? '–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è' : '–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è'}`;
            dataStructureEl.className = `test-item ${hasCorrectStructure ? 'success' : 'error'}`;
        }
        
        function openEditor() {
            console.log('üß™ –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä...');
            app.openEditor();
            setTimeout(updateTestInfo, 500);
        }
        
        function testAddBlock() {
            console.log('üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞...');
            
            if (!document.querySelector('.editor-section')) {
                app.openEditor();
                setTimeout(testAddBlock, 500);
                return;
            }
            
            const addBtn = document.getElementById('addTextBlockBtn');
            if (addBtn) {
                const beforeCount = app.slides[app.currentEditingSlide].textBlocks.length;
                addBtn.click();
                
                setTimeout(() => {
                    const afterCount = app.slides[app.currentEditingSlide].textBlocks.length;
                    console.log(`${afterCount > beforeCount ? '‚úÖ' : '‚ùå'} –ë–ª–æ–∫–æ–≤ –±—ã–ª–æ: ${beforeCount}, —Å—Ç–∞–ª–æ: ${afterCount}`);
                    updateTestInfo();
                }, 200);
            } else {
                console.error('‚ùå –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
            }
        }
        
        function testSelectBlock() {
            console.log('üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º –≤—ã–±–æ—Ä –±–ª–æ–∫–∞...');
            
            const currentSlide = app.slides[app.currentEditingSlide];
            if (currentSlide.textBlocks.length > 0) {
                const randomBlock = currentSlide.textBlocks[Math.floor(Math.random() * currentSlide.textBlocks.length)];
                app.selectedTextBlockId = randomBlock.id;
                app.updateTextBlockControls();
                console.log(`‚úÖ –í—ã–±—Ä–∞–Ω –±–ª–æ–∫: ${randomBlock.id}`);
                updateTestInfo();
            } else {
                console.error('‚ùå –ù–µ—Ç –±–ª–æ–∫–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞');
            }
        }
        
        function testDeleteBlock() {
            console.log('üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º —É–¥–∞–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞...');
            
            if (!app.selectedTextBlockId) {
                console.error('‚ùå –ù–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞');
                return;
            }
            
            const beforeCount = app.slides[app.currentEditingSlide].textBlocks.length;
            const deleteBtn = document.getElementById('deleteTextBlockBtn');
            
            if (deleteBtn) {
                deleteBtn.click();
                
                setTimeout(() => {
                    const afterCount = app.slides[app.currentEditingSlide].textBlocks.length;
                    console.log(`${afterCount < beforeCount ? '‚úÖ' : '‚ùå'} –ë–ª–æ–∫–æ–≤ –±—ã–ª–æ: ${beforeCount}, —Å—Ç–∞–ª–æ: ${afterCount}`);
                    updateTestInfo();
                }, 200);
            } else {
                console.error('‚ùå –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
            }
        }
        
        function checkStructure() {
            console.log('üß™ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö...');
            
            const currentSlide = app.slides[app.currentEditingSlide];
            console.log('üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ª–∞–π–¥–∞:', {
                id: currentSlide.id,
                background: currentSlide.background,
                textBlocksCount: currentSlide.textBlocks.length,
                textBlocks: currentSlide.textBlocks.map(block => ({
                    id: block.id,
                    text: block.text.substring(0, 30) + '...',
                    x: block.x,
                    y: block.y,
                    font: block.font,
                    size: block.size,
                    weight: block.weight,
                    color: block.color,
                    glow: block.glow
                }))
            });
            
            updateTestInfo();
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä
        setTimeout(() => {
            console.log('üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä...');
            openEditor();
        }, 1000);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
        setInterval(updateTestInfo, 3000);
        
        console.log(`
üß© –¢–ï–°–¢ –ù–ï–ó–ê–í–ò–°–ò–ú–´–• –¢–ï–ö–°–¢–û–í–´–• –ë–õ–û–ö–û–í

–ü—Ä–æ–≤–µ—Ä—è–µ–º:
‚úÖ –ö–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç" - —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π textBlock
‚úÖ –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞
‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ: —Ç–µ–∫—Å—Ç, —à—Ä–∏—Ñ—Ç, —Ä–∞–∑–º–µ—Ä, –ø–æ–∑–∏—Ü–∏—è
‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö: slide = {id, background, textBlocks: [...]}
‚úÖ –ö–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è –±–ª–æ–∫–∞
‚úÖ –í—ã–±–æ—Ä –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞–º–∏

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ —Å–ª–µ–≤–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!
        `);
        
        console.log('‚úÖ –¢–µ—Å—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –±–ª–æ–∫–æ–≤ –≥–æ—Ç–æ–≤');
    </script>
</body>
</html>