<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlashPost SAFE MODE Recovery Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .test-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .btn {
            background: linear-gradient(135deg, #833ab4 0%, #fd1d1d 50%, #fcb045 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .log-container {
            background: #000;
            border-radius: 8px;
            padding: 15px;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
        }
        
        .log-entry {
            margin-bottom: 2px;
            padding: 2px 0;
        }
        
        .log-error { color: #f44336; }
        .log-warning { color: #ff9800; }
        .log-info { color: #2196F3; }
        .log-success { color: #4CAF50; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üö® FlashPost SAFE MODE Recovery Test</h1>
        <p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è UI –≤ SAFE MODE</p>
        
        <div class="test-section">
            <h2>üìã Test Scenarios</h2>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è SAFE MODE recovery:</p>
            
            <button class="btn" onclick="testNormalLaunch()">
                ‚úÖ Normal Launch (Expected Success)
            </button>
            
            <button class="btn" onclick="testWithoutTelegram()">
                üì± Launch Without Telegram (Auto PREVIEW MODE)
            </button>
            
            <button class="btn" onclick="testWithBrokenModules()">
                üì¶ Launch With Broken Modules (Fallback UI)
            </button>
            
            <button class="btn" onclick="testDirectSafeMode()">
                üîß Direct SAFE MODE Test
            </button>
            
            <button class="btn" onclick="clearLogs()">
                üóëÔ∏è Clear Logs
            </button>
        </div>
        
        <div class="test-section">
            <h2>üìä Console Logs</h2>
            <div class="log-container" id="consoleLogs"></div>
        </div>
        
        <div class="test-section">
            <h2>üéØ Expected Results</h2>
            <ul>
                <li>‚úÖ UI –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∏–¥–∏–º—ã–º (–Ω–µ –±–µ–ª—ã–π —ç–∫—Ä–∞–Ω)</li>
                <li>‚úÖ –ö–Ω–æ–ø–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–º–∏</li>
                <li>‚úÖ Console.log –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø bootstrap</li>
                <li>‚úÖ Telegram –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π PREVIEW MODE</li>
                <li>‚úÖ –ú–æ–¥—É–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã ‚Üí fallback UI —Å –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é</li>
                <li>‚úÖ #app.innerHTML –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω</li>
            </ul>
        </div>
    </div>

    <script>
        // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º console.log –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        const logs = [];
        
        function addLog(type, message) {
            const timestamp = new Date().toLocaleTimeString();
            logs.push({type, message, timestamp});
            updateConsoleLogs();
        }
        
        console.log = function(...args) {
            addLog('info', args.join(' '));
            originalLog.apply(console, args);
        };
        
        console.error = function(...args) {
            addLog('error', args.join(' '));
            originalError.apply(console, args);
        };
        
        console.warn = function(...args) {
            addLog('warning', args.join(' '));
            originalWarn.apply(console, args);
        };
        
        function updateConsoleLogs() {
            const container = document.getElementById('consoleLogs');
            container.innerHTML = logs.slice(-50).map(log => 
                `<div class="log-entry log-${log.type}">[${log.timestamp}] ${log.message}</div>`
            ).join('');
            container.scrollTop = container.scrollHeight;
        }
        
        function clearLogs() {
            logs.length = 0;
            updateConsoleLogs();
        }
        
        function testNormalLaunch() {
            console.log('üß™ TEST: Normal Launch - –æ—Ç–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ');
            window.open('index.html', '_blank');
        }
        
        function testWithoutTelegram() {
            console.log('üß™ TEST: Launch Without Telegram - —Ç–µ—Å—Ç–∏—Ä—É–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π PREVIEW MODE');
            
            // –í—Ä–µ–º–µ–Ω–Ω–æ —É–¥–∞–ª—è–µ–º Telegram –¥–ª—è —Ç–µ—Å—Ç–∞
            const originalTelegram = window.Telegram;
            delete window.Telegram;
            
            setTimeout(() => {
                window.open('index.html', '_blank');
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                setTimeout(() => {
                    if (originalTelegram) {
                        window.Telegram = originalTelegram;
                    }
                }, 5000);
            }, 100);
        }
        
        function testWithBrokenModules() {
            console.log('üß™ TEST: Broken Modules - —Ç–µ—Å—Ç–∏—Ä—É–µ–º fallback UI');
            
            // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –ø–æ–ª–æ–º–∞–Ω–Ω—ã–º–∏ –º–æ–¥—É–ª—è–º–∏
            const testWindow = window.open('', '_blank');
            testWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>FlashPost Broken Modules Test</title>
                    <style>
                        body { 
                            background: linear-gradient(135deg, #0f0f14 0%, #1a1a2e 50%, #16213e 100%);
                            color: white;
                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                            margin: 0;
                            padding: 0;
                        }
                    </style>
                </head>
                <body>
                    <div id="app"></div>
                    
                    <script>
                        console.log('üß™ TEST: –°–∏–º—É–ª–∏—Ä—É–µ–º –ø–æ–ª–æ–º–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏');
                        
                        // –ù–ï –∑–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥—É–ª–∏ - –æ–Ω–∏ –±—É–¥—É—Ç undefined
                        
                        // –°–∏–º—É–ª–∏—Ä—É–µ–º FlashPostApp —Å –ø–æ–ª–æ–º–∞–Ω–Ω—ã–º–∏ –º–æ–¥—É–ª—è–º–∏
                        class FlashPostApp {
                            constructor() {
                                console.log('üöÄ SAFE MODE: FlashPostApp constructor');
                                this.state = null; // –ü–æ–ª–æ–º–∞–Ω–Ω—ã–π state
                                this.renderer = null; // –ü–æ–ª–æ–º–∞–Ω–Ω—ã–π renderer
                            }
                            
                            checkModulesAvailable() {
                                return false; // –ú–æ–¥—É–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
                            }
                            
                            async init() {
                                console.log('üöÄ SAFE MODE: init() called');
                                await this.renderApp();
                            }
                            
                            async renderApp() {
                                console.log('üé® SAFE MODE: renderApp() called');
                                
                                const app = document.getElementById('app');
                                if (!app) {
                                    console.error('‚ùå SAFE MODE: #app not found');
                                    return;
                                }
                                
                                const modulesAvailable = this.checkModulesAvailable();
                                console.log('üì¶ SAFE MODE: Modules available:', modulesAvailable);
                                
                                if (!modulesAvailable) {
                                    console.log('‚ö†Ô∏è SAFE MODE: Modules unavailable, showing fallback UI');
                                    this.renderBasicUI(app);
                                    return;
                                }
                            }
                            
                            renderBasicUI(app) {
                                console.log('üîß SAFE MODE: Rendering basic UI');
                                
                                app.innerHTML = \`
                                    <div style="
                                        min-height: 100vh;
                                        display: flex;
                                        align-items: center;
                                        justify-content: center;
                                        padding: 20px;
                                    ">
                                        <div style="
                                            background: rgba(255, 255, 255, 0.1);
                                            border-radius: 20px;
                                            padding: 40px;
                                            text-align: center;
                                            max-width: 500px;
                                        ">
                                            <h1 style="
                                                font-size: 32px;
                                                background: linear-gradient(45deg, #4CAF50, #8BC34A);
                                                -webkit-background-clip: text;
                                                -webkit-text-fill-color: transparent;
                                                margin-bottom: 20px;
                                            ">‚úÖ SAFE MODE Active</h1>
                                            
                                            <p style="margin-bottom: 30px; opacity: 0.9;">
                                                Modules unavailable, but UI is recovered!
                                            </p>
                                            
                                            <button onclick="alert('‚úÖ Button is clickable!')" style="
                                                background: linear-gradient(135deg, #833ab4, #fd1d1d);
                                                color: white;
                                                border: none;
                                                padding: 15px 30px;
                                                border-radius: 12px;
                                                font-size: 16px;
                                                font-weight: 700;
                                                cursor: pointer;
                                                pointer-events: auto;
                                                z-index: 1000;
                                                position: relative;
                                            ">
                                                üñ±Ô∏è Test Button Click
                                            </button>
                                            
                                            <div style="
                                                margin-top: 20px;
                                                padding: 15px;
                                                background: rgba(76, 175, 80, 0.2);
                                                border-radius: 8px;
                                                font-size: 14px;
                                            ">
                                                üéØ SAFE MODE SUCCESS: UI visible and interactive!
                                            </div>
                                        </div>
                                    </div>
                                \`;
                                
                                console.log('‚úÖ SAFE MODE: Basic UI rendered successfully');
                            }
                        }
                        
                        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç
                        window.addEventListener('load', () => {
                            console.log('üì¶ SAFE MODE: Window loaded, starting test');
                            const app = new FlashPostApp();
                            app.init();
                        });
                    </script>
                </body>
                </html>
            `);
            testWindow.document.close();
        }
        
        function testDirectSafeMode() {
            console.log('üß™ TEST: Direct SAFE MODE - –ø—Ä—è–º–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SAFE MODE —Ñ—É–Ω–∫—Ü–∏–π');
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º emergency fix –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
            window.open('index-emergency-fix.html', '_blank');
        }
        
        console.log('üß™ SAFE MODE Recovery Test loaded');
        console.log('üìã Available tests:');
        console.log('  ‚úÖ Normal Launch');
        console.log('  üì± Without Telegram (Auto PREVIEW MODE)');
        console.log('  üì¶ Broken Modules (Fallback UI)');
        console.log('  üîß Direct SAFE MODE');
    </script>
</body>
</html>