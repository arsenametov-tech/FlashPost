<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéØ –¢–µ—Å—Ç –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞</title>
    <link rel="stylesheet" href="app.css">
    <style>
        .editor-test-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 20px;
            border-radius: 8px;
            z-index: 10000;
            font-size: 14px;
            max-width: 350px;
        }
        .test-step {
            margin: 15px 0;
            padding: 12px;
            border-radius: 6px;
            border-left: 4px solid #833ab4;
            background: rgba(131, 58, 180, 0.1);
        }
        .test-button {
            display: block;
            width: 100%;
            margin: 8px 0;
            padding: 10px;
            background: #833ab4;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
        }
        .test-button:hover {
            background: #9d4edd;
        }
        .test-result {
            margin: 8px 0;
            padding: 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 11px;
        }
        .success { background: #4CAF50; color: white; }
        .error { background: #f44336; color: white; }
        .warning { background: #ff9800; color: white; }
        .info { background: #2196F3; color: white; }
        .block-info {
            background: #333;
            padding: 8px;
            margin: 5px 0;
            border-radius: 4px;
            font-family: monospace;
            font-size: 10px;
        }
    </style>
</head>
<body>
    <div id="loading" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">üéØ</div>
            <h2>–¢–µ—Å—Ç –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞</h2>
            <div class="loading-spinner"></div>
            <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π...</p>
        </div>
    </div>

    <div id="app" style="display: none;"></div>

    <div class="editor-test-panel">
        <h3>üéØ –¢–µ—Å—Ç –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞</h3>
        
        <div class="test-step">
            <strong>–®–∞–≥ 1:</strong> –î–æ–±–∞–≤–∏—Ç—å 2-3 —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –±–ª–æ–∫–∞
            <button class="test-button" onclick="testAddMultipleBlocks()">
                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫–∏
            </button>
        </div>

        <div class="test-step">
            <strong>–®–∞–≥ 2:</strong> –ò–∑–º–µ–Ω–∏—Ç—å —à—Ä–∏—Ñ—Ç —É –≤—Ç–æ—Ä–æ–≥–æ –±–ª–æ–∫–∞
            <button class="test-button" onclick="testIndependentFontChange()">
                üî§ –ò–∑–º–µ–Ω–∏—Ç—å —à—Ä–∏—Ñ—Ç 2-–≥–æ –±–ª–æ–∫–∞
            </button>
        </div>

        <div class="test-step">
            <strong>–®–∞–≥ 3:</strong> –ü–µ—Ä–µ—Ç–∞—â–∏—Ç—å –±–ª–æ–∫ (–±–µ–∑ –ø—Ä—ã–∂–∫–æ–≤)
            <button class="test-button" onclick="testSmoothDrag()">
                üñ± –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –±–ª–æ–∫
            </button>
        </div>

        <div class="test-step">
            <strong>–®–∞–≥ 4:</strong> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç (–±–µ–∑ —Å–±—Ä–æ—Å–∞)
            <button class="test-button" onclick="testPersistentTextEdit()">
                ‚úçÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç
            </button>
        </div>

        <button class="test-button" onclick="runFullEditorTest()" style="background: #28a745; margin-top: 15px;">
            üöÄ –ü–û–õ–ù–´–ô –¢–ï–°–¢ –†–ï–î–ê–ö–¢–û–†–ê
        </button>

        <button class="test-button" onclick="showBlocksInfo()">
            üìä –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–ª–æ–∫–æ–≤
        </button>

        <div id="testResults"></div>
    </div>
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π -->
    <script src="src/state.js"></script>
    <script src="src/renderer.js"></script>
    <script src="src/editor.js"></script>
    <script src="src/drag.js"></script>
    <script src="src/export.js"></script>
    <script src="src/ai.js"></script>
    <script src="src/templates.js"></script>
    <script src="src/app.js"></script>

    <script>
        let app = null;
        let testBlocks = [];

        function logResult(message, type = 'info') {
            const resultsDiv = document.getElementById('testResults');
            const timestamp = new Date().toLocaleTimeString();
            
            resultsDiv.innerHTML += `
                <div class="test-result ${type}">
                    [${timestamp}] ${message}
                </div>
            `;
            
            console.log(`${type.toUpperCase()}: ${message}`);
        }

        function initRealEditorTest() {
            try {
                app = window.flashPostApp;
                
                if (!app) {
                    throw new Error('FlashPostApp –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
                }

                // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Å–ª–∞–π–¥
                const testSlide = app.state.createSlide({
                    title: '–¢–µ—Å—Ç –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞',
                    text: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π',
                    background: { type: 'color', color: '#833ab4' }
                });

                // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                app.enterEditMode();
                
                logResult('‚úÖ –†–µ–¥–∞–∫—Ç–æ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'success');
                
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: ${error.message}`, 'error');
            }
        }

        // –¢–µ—Å—Ç 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–ª–æ–∫–æ–≤
        function testAddMultipleBlocks() {
            try {
                logResult('=== –¢–ï–°–¢ 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ 3 –±–ª–æ–∫–æ–≤ ===', 'info');
                
                const initialCount = app.state.getActiveSlide()?.textBlocks.length || 0;
                testBlocks = [];
                
                // –î–æ–±–∞–≤–ª—è–µ–º 3 –±–ª–æ–∫–∞
                for (let i = 1; i <= 3; i++) {
                    const block = app.state.addTextBlock();
                    if (block) {
                        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç
                        app.state.updateTextBlockProperty(block.id, 'text', `–ë–ª–æ–∫ ${i}`);
                        testBlocks.push(block.id);
                        logResult(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –±–ª–æ–∫ ${i}: ${block.id}`, 'success');
                    } else {
                        logResult(`‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –±–ª–æ–∫ ${i}`, 'error');
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                setTimeout(() => {
                    const finalCount = app.state.getActiveSlide()?.textBlocks.length || 0;
                    const domCount = document.querySelectorAll('[data-block-id]').length;
                    
                    if (finalCount === initialCount + 3 && domCount >= 3) {
                        logResult(`‚úÖ –¢–ï–°–¢ 1 –ü–†–û–ô–î–ï–ù: ${finalCount} –±–ª–æ–∫–æ–≤ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏, ${domCount} –≤ DOM`, 'success');
                    } else {
                        logResult(`‚ùå –¢–ï–°–¢ 1 –ü–†–û–í–ê–õ–ï–ù: –æ–∂–∏–¥–∞–ª–æ—Å—å ${initialCount + 3}, –ø–æ–ª—É—á–µ–Ω–æ ${finalCount} (DOM: ${domCount})`, 'error');
                    }
                }, 300);
                
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞ 1: ${error.message}`, 'error');
            }
        }

        // –¢–µ—Å—Ç 2: –ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —à—Ä–∏—Ñ—Ç–∞
        function testIndependentFontChange() {
            try {
                logResult('=== –¢–ï–°–¢ 2: –ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —à—Ä–∏—Ñ—Ç–∞ ===', 'info');
                
                if (testBlocks.length < 2) {
                    logResult('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–ª–æ–∫–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∞. –°–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤—å—Ç–µ –±–ª–æ–∫–∏.', 'error');
                    return;
                }

                const block1Id = testBlocks[0];
                const block2Id = testBlocks[1];
                
                // –ü–æ–ª—É—á–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã
                const slide = app.state.getActiveSlide();
                const block1Before = slide.textBlocks.find(b => b.id === block1Id);
                const block2Before = slide.textBlocks.find(b => b.id === block2Id);
                
                const font1Before = block1Before.font;
                const font2Before = block2Before.font;
                
                logResult(`–®—Ä–∏—Ñ—Ç—ã –î–û: –ë–ª–æ–∫1="${font1Before}", –ë–ª–æ–∫2="${font2Before}"`, 'info');
                
                // –ò–∑–º–µ–Ω—è–µ–º —à—Ä–∏—Ñ—Ç —Ç–æ–ª—å–∫–æ —É –≤—Ç–æ—Ä–æ–≥–æ –±–ª–æ–∫–∞
                const newFont = 'Montserrat';
                app.state.updateTextBlockProperty(block2Id, 'font', newFont);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                setTimeout(() => {
                    const slideAfter = app.state.getActiveSlide();
                    const block1After = slideAfter.textBlocks.find(b => b.id === block1Id);
                    const block2After = slideAfter.textBlocks.find(b => b.id === block2Id);
                    
                    const font1After = block1After.font;
                    const font2After = block2After.font;
                    
                    logResult(`–®—Ä–∏—Ñ—Ç—ã –ü–û–°–õ–ï: –ë–ª–æ–∫1="${font1After}", –ë–ª–æ–∫2="${font2After}"`, 'info');
                    
                    if (font1After === font1Before && font2After === newFont) {
                        logResult('‚úÖ –¢–ï–°–¢ 2 –ü–†–û–ô–î–ï–ù: –®—Ä–∏—Ñ—Ç—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã', 'success');
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º DOM
                        const dom1 = document.querySelector(`[data-block-id="${block1Id}"]`);
                        const dom2 = document.querySelector(`[data-block-id="${block2Id}"]`);
                        
                        if (dom1 && dom2) {
                            const domFont1 = dom1.style.fontFamily;
                            const domFont2 = dom2.style.fontFamily;
                            logResult(`DOM —à—Ä–∏—Ñ—Ç—ã: –ë–ª–æ–∫1="${domFont1}", –ë–ª–æ–∫2="${domFont2}"`, 'info');
                        }
                    } else {
                        logResult('‚ùå –¢–ï–°–¢ 2 –ü–†–û–í–ê–õ–ï–ù: –®—Ä–∏—Ñ—Ç—ã –≤–ª–∏—è—é—Ç –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞', 'error');
                    }
                }, 200);
                
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞ 2: ${error.message}`, 'error');
            }
        }

        // –¢–µ—Å—Ç 3: –ü–ª–∞–≤–Ω–æ–µ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ
        function testSmoothDrag() {
            try {
                logResult('=== –¢–ï–°–¢ 3: –ü–ª–∞–≤–Ω–æ–µ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ ===', 'info');
                
                if (testBlocks.length < 1) {
                    logResult('‚ùå –ù–µ—Ç –±–ª–æ–∫–æ–≤ –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è', 'error');
                    return;
                }

                const blockId = testBlocks[0];
                const slide = app.state.getActiveSlide();
                const block = slide.textBlocks.find(b => b.id === blockId);
                
                const startX = block.x;
                const startY = block.y;
                
                logResult(`–ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è: (${startX}%, ${startY}%)`, 'info');
                
                // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø–ª–∞–≤–Ω–æ–µ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —à–∞–≥–∞–º–∏
                const steps = 5;
                const targetX = startX + 20;
                const targetY = startY + 15;
                
                let currentStep = 0;
                
                const dragStep = () => {
                    currentStep++;
                    const progress = currentStep / steps;
                    const currentX = startX + (targetX - startX) * progress;
                    const currentY = startY + (targetY - startY) * progress;
                    
                    app.state.updateTextBlockProperty(blockId, 'x', currentX);
                    app.state.updateTextBlockProperty(blockId, 'y', currentY);
                    
                    logResult(`–®–∞–≥ ${currentStep}: (${currentX.toFixed(1)}%, ${currentY.toFixed(1)}%)`, 'info');
                    
                    if (currentStep < steps) {
                        setTimeout(dragStep, 100);
                    } else {
                        // –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
                        setTimeout(() => {
                            const finalSlide = app.state.getActiveSlide();
                            const finalBlock = finalSlide.textBlocks.find(b => b.id === blockId);
                            const domBlock = document.querySelector(`[data-block-id="${blockId}"]`);
                            
                            logResult(`–§–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è: —Å–æ—Å—Ç–æ—è–Ω–∏–µ=(${finalBlock.x.toFixed(1)}%, ${finalBlock.y.toFixed(1)}%)`, 'info');
                            
                            if (domBlock) {
                                logResult(`–§–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è: DOM=(${domBlock.style.left}, ${domBlock.style.top})`, 'info');
                                
                                if (Math.abs(finalBlock.x - targetX) < 0.1 && Math.abs(finalBlock.y - targetY) < 0.1) {
                                    logResult('‚úÖ –¢–ï–°–¢ 3 –ü–†–û–ô–î–ï–ù: –ü–ª–∞–≤–Ω–æ–µ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                                } else {
                                    logResult('‚ùå –¢–ï–°–¢ 3 –ü–†–û–í–ê–õ–ï–ù: –ü–æ–∑–∏—Ü–∏—è –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–π', 'error');
                                }
                            } else {
                                logResult('‚ùå –¢–ï–°–¢ 3 –ü–†–û–í–ê–õ–ï–ù: –ë–ª–æ–∫ –∏—Å—á–µ–∑ –∏–∑ DOM', 'error');
                            }
                        }, 200);
                    }
                };
                
                dragStep();
                
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞ 3: ${error.message}`, 'error');
            }
        }

        // –¢–µ—Å—Ç 4: –£—Å—Ç–æ–π—á–∏–≤–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
        function testPersistentTextEdit() {
            try {
                logResult('=== –¢–ï–°–¢ 4: –£—Å—Ç–æ–π—á–∏–≤–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ ===', 'info');
                
                if (testBlocks.length < 1) {
                    logResult('‚ùå –ù–µ—Ç –±–ª–æ–∫–æ–≤ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
                    return;
                }

                const blockId = testBlocks[0];
                const slide = app.state.getActiveSlide();
                const block = slide.textBlocks.find(b => b.id === blockId);
                
                const originalText = block.text;
                logResult(`–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç: "${originalText}"`, 'info');
                
                // –°–µ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç–µ–∫—Å—Ç–∞
                const textChanges = [
                    '–ü–µ—Ä–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ',
                    '–í—Ç–æ—Ä–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å –¥–ª–∏–Ω–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º',
                    '–¢—Ä–µ—Ç—å–µ',
                    '–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞'
                ];
                
                let changeIndex = 0;
                
                const changeText = () => {
                    if (changeIndex < textChanges.length) {
                        const newText = textChanges[changeIndex];
                        app.state.updateTextBlockProperty(blockId, 'text', newText);
                        
                        logResult(`–ò–∑–º–µ–Ω–µ–Ω–∏–µ ${changeIndex + 1}: "${newText}"`, 'info');
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–∏–ª–æ—Å—å
                        setTimeout(() => {
                            const updatedSlide = app.state.getActiveSlide();
                            const updatedBlock = updatedSlide.textBlocks.find(b => b.id === blockId);
                            const domBlock = document.querySelector(`[data-block-id="${blockId}"]`);
                            
                            if (updatedBlock.text === newText) {
                                logResult(`‚úÖ –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ: "${updatedBlock.text}"`, 'success');
                                
                                if (domBlock && domBlock.textContent === newText) {
                                    logResult(`‚úÖ DOM —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω: "${domBlock.textContent}"`, 'success');
                                } else {
                                    logResult(`‚ùå DOM –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω: "${domBlock?.textContent || '–ù–ï–¢'}"`, 'error');
                                }
                            } else {
                                logResult(`‚ùå –°–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ –æ–±–Ω–æ–≤–∏–ª–æ—Å—å: "${updatedBlock.text}"`, 'error');
                            }
                            
                            changeIndex++;
                            if (changeIndex < textChanges.length) {
                                setTimeout(changeText, 300);
                            } else {
                                logResult('‚úÖ –¢–ï–°–¢ 4 –ü–†–û–ô–î–ï–ù: –¢–µ–∫—Å—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è —É—Å—Ç–æ–π—á–∏–≤–æ', 'success');
                            }
                        }, 100);
                    }
                };
                
                changeText();
                
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞ 4: ${error.message}`, 'error');
            }
        }

        // –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
        function runFullEditorTest() {
            logResult('üöÄ –ó–ê–ü–£–°–ö –ü–û–õ–ù–û–ì–û –¢–ï–°–¢–ê –†–ï–î–ê–ö–¢–û–†–ê', 'info');
            document.getElementById('testResults').innerHTML = '';
            
            setTimeout(() => testAddMultipleBlocks(), 100);
            setTimeout(() => testIndependentFontChange(), 1000);
            setTimeout(() => testSmoothDrag(), 2000);
            setTimeout(() => testPersistentTextEdit(), 3500);
            
            setTimeout(() => {
                logResult('üèÅ –ü–û–õ–ù–´–ô –¢–ï–°–¢ –ó–ê–í–ï–†–®–ï–ù', 'info');
            }, 6000);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–ª–æ–∫–∞—Ö
        function showBlocksInfo() {
            try {
                const slide = app.state.getActiveSlide();
                const blocks = slide?.textBlocks || [];
                const domBlocks = document.querySelectorAll('[data-block-id]');
                
                let info = `<div class="block-info">
                    <strong>–°–æ—Å—Ç–æ—è–Ω–∏–µ:</strong> ${blocks.length} –±–ª–æ–∫–æ–≤<br>
                    <strong>DOM:</strong> ${domBlocks.length} —ç–ª–µ–º–µ–Ω—Ç–æ–≤<br><br>
                `;
                
                blocks.forEach((block, index) => {
                    const domBlock = document.querySelector(`[data-block-id="${block.id}"]`);
                    info += `
                        <strong>–ë–ª–æ–∫ ${index + 1} (${block.id.substring(0, 8)}...):</strong><br>
                        –¢–µ–∫—Å—Ç: "${block.text}"<br>
                        –ü–æ–∑–∏—Ü–∏—è: (${block.x}%, ${block.y}%)<br>
                        –®—Ä–∏—Ñ—Ç: ${block.font} ${block.size}px<br>
                        –í DOM: ${domBlock ? '‚úÖ' : '‚ùå'}<br><br>
                    `;
                });
                
                info += '</div>';
                
                document.getElementById('testResults').innerHTML = info;
                
            } catch (error) {
                logResult(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫–∞–∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏: ${error.message}`, 'error');
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('app').style.display = 'block';
                
                setTimeout(() => {
                    initRealEditorTest();
                }, 1000);
            }, 500);
        });
    </script>
</body>
</html>