<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Generation Pipeline Test - FlashPost</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .test-section h3 {
            margin-top: 0;
            color: #333;
        }
        
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        button:hover {
            background: #0056b3;
        }
        
        .app-frame {
            border: 2px solid #dee2e6;
            border-radius: 8px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .app-frame iframe {
            width: 100%;
            height: 600px;
            border: none;
        }
        
        .pipeline-step {
            display: flex;
            gap: 10px;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .step-status {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #ccc;
        }
        
        .step-status.success { background: #28a745; }
        .step-status.error { background: #dc3545; }
        .step-status.testing { background: #ffc107; }
        .step-status.running { background: #17a2b8; animation: pulse 1s infinite; }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #833ab4, #fd1d1d, #fcb045);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .topic-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 16px;
        }
        
        .slides-preview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .slide-card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            min-height: 150px;
        }
        
        .slide-title {
            font-weight: bold;
            color: #495057;
            margin-bottom: 10px;
        }
        
        .slide-text {
            font-size: 14px;
            color: #6c757d;
            line-height: 1.4;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ü§ñ AI Generation Pipeline Test</h1>
        <p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—Ä—É—Å–µ–ª–∏: –æ—Ç –≤–≤–æ–¥–∞ —Ç–µ–º—ã –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–∞–π–¥–æ–≤</p>
        
        <div class="test-section">
            <h3>üéØ Test Controls</h3>
            <input type="text" class="topic-input" id="testTopic" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–º—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: '–ö–∞–∫ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞—Ö')" value="–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–π">
            <div>
                <button onclick="testFullPipeline()">üöÄ Test Full Pipeline</button>
                <button onclick="testWithMockAI()">ü§ñ Test with Mock AI</button>
                <button onclick="loadMainApp()">üì± Load Main App</button>
                <button onclick="clearLog()">üßπ Clear Log</button>
            </div>
        </div>
        
        <div class="test-section">
            <h3>üìä Pipeline Progress</h3>
            <div class="progress-bar">
                <div class="progress-fill" id="pipeline-progress"></div>
            </div>
            <div id="pipeline-steps">
                <div class="pipeline-step">
                    <div class="step-status" id="step1-status"></div>
                    <span>1. User Input Validation</span>
                    <span id="step1-result">Waiting...</span>
                </div>
                <div class="pipeline-step">
                    <div class="step-status" id="step2-status"></div>
                    <span>2. AI Request (Gemini)</span>
                    <span id="step2-result">Waiting...</span>
                </div>
                <div class="pipeline-step">
                    <div class="step-status" id="step3-status"></div>
                    <span>3. Response Parsing</span>
                    <span id="step3-result">Waiting...</span>
                </div>
                <div class="pipeline-step">
                    <div class="step-status" id="step4-status"></div>
                    <span>4. Slide Validation</span>
                    <span id="step4-result">Waiting...</span>
                </div>
                <div class="pipeline-step">
                    <div class="step-status" id="step5-status"></div>
                    <span>5. Project Creation</span>
                    <span id="step5-result">Waiting...</span>
                </div>
                <div class="pipeline-step">
                    <div class="step-status" id="step6-status"></div>
                    <span>6. Render & Display</span>
                    <span id="step6-result">Waiting...</span>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h3>üìù Generated Slides Preview</h3>
            <div id="slides-preview" class="slides-preview">
                No slides generated yet...
            </div>
        </div>
        
        <div class="test-section">
            <h3>üìã Test Log</h3>
            <div class="log" id="test-log">
                Test logs will appear here...
            </div>
        </div>
        
        <div class="test-section">
            <h3>üì± Main Application</h3>
            <div class="app-frame" id="app-frame" style="display: none;">
                <iframe id="main-app-iframe" src="about:blank"></iframe>
            </div>
        </div>
    </div>

    <script>
        let testResults = [];
        let appFrame = null;
        let currentStep = 0;
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            
            testResults.push({ timestamp, message, type });
            
            const logContainer = document.getElementById('test-log');
            const logDiv = document.createElement('div');
            logDiv.style.color = type === 'error' ? '#dc3545' : 
                               type === 'success' ? '#28a745' : 
                               type === 'warning' ? '#ffc107' : '#17a2b8';
            logDiv.textContent = logEntry;
            
            logContainer.appendChild(logDiv);
            logContainer.scrollTop = logContainer.scrollHeight;
            
            console.log(`[AI-PIPELINE-TEST] ${message}`);
        }
        
        function updateStepStatus(stepNumber, status, message) {
            const statusEl = document.getElementById(`step${stepNumber}-status`);
            const resultEl = document.getElementById(`step${stepNumber}-result`);
            
            if (statusEl) {
                statusEl.className = `step-status ${status}`;
            }
            
            if (resultEl) {
                resultEl.textContent = message;
            }
        }
        
        function updateProgress(percentage) {
            const progressFill = document.getElementById('pipeline-progress');
            if (progressFill) {
                progressFill.style.width = `${percentage}%`;
            }
        }
        
        function resetPipeline() {
            for (let i = 1; i <= 6; i++) {
                updateStepStatus(i, '', 'Waiting...');
            }
            updateProgress(0);
            document.getElementById('slides-preview').innerHTML = 'No slides generated yet...';
        }
        
        async function testFullPipeline() {
            log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏...', 'info');
            resetPipeline();
            
            const topic = document.getElementById('testTopic').value.trim();
            if (!topic) {
                log('‚ùå –í–≤–µ–¥–∏—Ç–µ —Ç–µ–º—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
                return;
            }
            
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ
                if (!appFrame) {
                    await loadMainAppForTesting();
                }
                
                // –®–∞–≥ 1: –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞
                updateStepStatus(1, 'running', 'Validating...');
                updateProgress(10);
                log(`1Ô∏è‚É£ –í–∞–ª–∏–¥–∏—Ä—É–µ–º —Ç–µ–º—É: "${topic}"`, 'info');
                
                if (topic.length < 5) {
                    throw new Error('–¢–µ–º–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∞—è');
                }
                
                updateStepStatus(1, 'success', 'Valid topic');
                log('‚úÖ –¢–µ–º–∞ –≤–∞–ª–∏–¥–Ω–∞', 'success');
                
                // –®–∞–≥ 2: AI –∑–∞–ø—Ä–æ—Å
                updateStepStatus(2, 'running', 'Calling AI...');
                updateProgress(30);
                log('2Ô∏è‚É£ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ AI...', 'info');
                
                const app = appFrame.flashPostApp;
                if (!app) {
                    throw new Error('App not available');
                }
                
                // –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                appFrame.document.addEventListener('aiGenerationProgress', (e) => {
                    log(`üîÑ AI Progress: ${e.detail.message} (${e.detail.percentage}%)`, 'info');
                    updateProgress(20 + (e.detail.percentage * 0.4)); // 20-60% –¥–∏–∞–ø–∞–∑–æ–Ω
                });
                
                // –í—ã–∑—ã–≤–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
                const slidesData = await app.aiManager.generateSlides(topic);
                
                updateStepStatus(2, 'success', `${slidesData.length} slides`);
                log(`‚úÖ AI –≤–µ—Ä–Ω—É–ª ${slidesData.length} —Å–ª–∞–π–¥–æ–≤`, 'success');
                
                // –®–∞–≥ 3: –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞
                updateStepStatus(3, 'running', 'Parsing...');
                updateProgress(65);
                log('3Ô∏è‚É£ –ü–∞—Ä—Å–∏–º –æ—Ç–≤–µ—Ç AI...', 'info');
                
                if (!Array.isArray(slidesData)) {
                    throw new Error('AI response is not an array');
                }
                
                updateStepStatus(3, 'success', 'Parsed successfully');
                log('‚úÖ –û—Ç–≤–µ—Ç —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω', 'success');
                
                // –®–∞–≥ 4: –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–ª–∞–π–¥–æ–≤
                updateStepStatus(4, 'running', 'Validating...');
                updateProgress(75);
                log('4Ô∏è‚É£ –í–∞–ª–∏–¥–∏—Ä—É–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–ª–∞–π–¥–æ–≤...', 'info');
                
                const validSlides = slidesData.filter(slide => 
                    slide && slide.text && slide.text.trim().length > 0
                );
                
                if (validSlides.length === 0) {
                    throw new Error('No valid slides found');
                }
                
                updateStepStatus(4, 'success', `${validSlides.length} valid`);
                log(`‚úÖ ${validSlides.length} —Å–ª–∞–π–¥–æ–≤ –ø—Ä–æ—à–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é`, 'success');
                
                // –®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
                updateStepStatus(5, 'running', 'Creating...');
                updateProgress(85);
                log('5Ô∏è‚É£ –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–µ–∫—Ç —Å —Å–ª–∞–π–¥–∞–º–∏...', 'info');
                
                // –ò–º–∏—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
                app.state.clearProject();
                
                validSlides.forEach((slideData, index) => {
                    const slide = app.state.createSlide({
                        title: slideData.title || `–°–ª–∞–π–¥ ${index + 1}`,
                        text: slideData.text,
                        background: {
                            type: 'color',
                            color: '#833ab4'
                        }
                    });
                    
                    app.state.createTextBlock(slide.id, {
                        text: slideData.text,
                        x: 50,
                        y: 50,
                        width: 80
                    });
                });
                
                updateStepStatus(5, 'success', 'Project created');
                log('‚úÖ –ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω —Å —Å–ª–∞–π–¥–∞–º–∏', 'success');
                
                // –®–∞–≥ 6: –†–µ–Ω–¥–µ—Ä –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                updateStepStatus(6, 'running', 'Rendering...');
                updateProgress(95);
                log('6Ô∏è‚É£ –†–µ–Ω–¥–µ—Ä–∏–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–∞—Ä—É—Å–µ–ª—å...', 'info');
                
                // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –ø—Ä–µ–≤—å—é
                await app.enterPreviewMode();
                
                updateStepStatus(6, 'success', 'Rendered');
                updateProgress(100);
                log('‚úÖ –ö–∞—Ä—É—Å–µ–ª—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∞', 'success');
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–≤—å—é —Å–ª–∞–π–¥–æ–≤
                displaySlidesPreview(validSlides);
                
                log('üéâ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –≤ —Ü–∏–∫–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: ${error.message}`, 'error');
                
                // –û—Ç–º–µ—á–∞–µ–º —Ç–µ–∫—É—â–∏–π —à–∞–≥ –∫–∞–∫ –æ—à–∏–±–æ—á–Ω—ã–π
                if (currentStep > 0) {
                    updateStepStatus(currentStep, 'error', error.message);
                }
            }
        }
        
        async function testWithMockAI() {
            log('ü§ñ –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å –º–æ–∫-–¥–∞–Ω–Ω—ã–º–∏ AI...', 'info');
            resetPipeline();
            
            const topic = document.getElementById('testTopic').value.trim() || '–¢–µ—Å—Ç–æ–≤–∞—è —Ç–µ–º–∞';
            
            // –ú–æ–∫-–¥–∞–Ω–Ω—ã–µ —Å–ª–∞–π–¥–æ–≤
            const mockSlides = [
                {
                    title: 'Hook',
                    text: '–ó–Ω–∞–µ—Ç–µ –ª–∏ –≤—ã, —á—Ç–æ 90% –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–π —Ç—Ä–∞—Ç—è—Ç –≤—Ä–µ–º—è –≤–ø—É—Å—Ç—É—é? –Ø –ø–æ—Ç–µ—Ä—è–ª 2 –≥–æ–¥–∞ —Å–≤–æ–µ–π –∂–∏–∑–Ω–∏ –Ω–∞ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã. –°–µ–≥–æ–¥–Ω—è –ø–æ–∫–∞–∂—É —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è —É–≤–µ–ª–∏—á–∏—Ç –≤–∞—à—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ 3 —Ä–∞–∑–∞.'
                },
                {
                    title: 'Problem',
                    text: '–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–π —Ä–∞–±–æ—Ç–∞—é—Ç 12+ —á–∞—Å–æ–≤ –≤ –¥–µ–Ω—å, –Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∏–Ω–∏–º–∞–ª—å–Ω—ã. –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏ —Å–Ω–∏–∂–∞—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞ 40%. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –≤—ã–≥–æ—Ä–∞–Ω–∏—é.'
                },
                {
                    title: 'Solution',
                    text: '–ú–µ—Ç–æ–¥ "–ì–ª—É–±–æ–∫–æ–π —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∫–∏" - —Ä–∞–±–æ—Ç–∞ –±–ª–æ–∫–∞–º–∏ –ø–æ 90 –º–∏–Ω—É—Ç —Å –ø–æ–ª–Ω—ã–º –ø–æ–≥—Ä—É–∂–µ–Ω–∏–µ–º –≤ –æ–¥–Ω—É –∑–∞–¥–∞—á—É. –ù–∏–∫–∞–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –∑–≤–æ–Ω–∫–æ–≤, —Å–æ—Ü—Å–µ—Ç–µ–π. –¢–æ–ª—å–∫–æ –≤—ã –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞.'
                },
                {
                    title: 'Steps',
                    text: '1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ 3 –≥–ª–∞–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ –Ω–∞ –¥–µ–Ω—å\n2. –ó–∞–±–ª–æ–∫–∏—Ä—É–π—Ç–µ 90-–º–∏–Ω—É—Ç–Ω—ã–µ –æ–∫–Ω–∞\n3. –û—Ç–∫–ª—é—á–∏—Ç–µ –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\n4. –†–∞–±–æ—Ç–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–∞–¥ –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–µ–π\n5. –î–µ–ª–∞–π—Ç–µ 15-–º–∏–Ω—É—Ç–Ω—ã–µ –ø–µ—Ä–µ—Ä—ã–≤—ã'
                },
                {
                    title: 'Results',
                    text: '–ó–∞ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü: —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞ 200%. –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è —Å 12 –¥–æ 8 —á–∞—Å–æ–≤. –ë–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Å–µ–º—å—é –∏ –æ—Ç–¥—ã—Ö. –°–Ω–∏–∂–µ–Ω–∏–µ —Å—Ç—Ä–µ—Å—Å–∞ –∏ –ø–æ–≤—ã—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã.'
                },
                {
                    title: 'CTA',
                    text: '–ù–∞—á–Ω–∏—Ç–µ –ø—Ä—è–º–æ —Å–µ–≥–æ–¥–Ω—è! –í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –≤–∞–∂–Ω—É—é –∑–∞–¥–∞—á—É –∏ —Ä–∞–±–æ—Ç–∞–π—Ç–µ –Ω–∞–¥ –Ω–µ–π 90 –º–∏–Ω—É—Ç –±–µ–∑ –ø–µ—Ä–µ—Ä—ã–≤–∞. –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö!'
                }
            ];
            
            try {
                // –ò–º–∏—Ç–∏—Ä—É–µ–º –≤—Å–µ —à–∞–≥–∏
                for (let i = 1; i <= 6; i++) {
                    updateStepStatus(i, 'running', 'Processing...');
                    updateProgress(i * 16);
                    await new Promise(resolve => setTimeout(resolve, 500));
                    updateStepStatus(i, 'success', 'Completed');
                    log(`‚úÖ –®–∞–≥ ${i} –∑–∞–≤–µ—Ä—à–µ–Ω (–º–æ–∫-–¥–∞–Ω–Ω—ã–µ)`, 'success');
                }
                
                updateProgress(100);
                displaySlidesPreview(mockSlides);
                log('üéâ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –º–æ–∫-–¥–∞–Ω–Ω—ã–º–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!', 'success');
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –º–æ–∫-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ${error.message}`, 'error');
            }
        }
        
        function displaySlidesPreview(slides) {
            const previewContainer = document.getElementById('slides-preview');
            
            if (!slides || slides.length === 0) {
                previewContainer.innerHTML = 'No slides to display';
                return;
            }
            
            const slidesHTML = slides.map((slide, index) => `
                <div class="slide-card">
                    <div class="slide-title">${index + 1}. ${slide.title || 'Untitled'}</div>
                    <div class="slide-text">${slide.text ? slide.text.substring(0, 150) + '...' : 'No content'}</div>
                </div>
            `).join('');
            
            previewContainer.innerHTML = slidesHTML;
            log(`üìã –û—Ç–æ–±—Ä–∞–∂–µ–Ω–æ ${slides.length} —Å–ª–∞–π–¥–æ–≤ –≤ –ø—Ä–µ–≤—å—é`, 'info');
        }
        
        async function loadMainAppForTesting() {
            log('üì± –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...', 'info');
            
            const appFrameContainer = document.getElementById('app-frame');
            const iframe = document.getElementById('main-app-iframe');
            
            appFrameContainer.style.display = 'block';
            
            return new Promise((resolve, reject) => {
                iframe.onload = () => {
                    appFrame = iframe.contentWindow;
                    log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –≤ iframe', 'success');
                    
                    // –ñ–¥–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
                    setTimeout(() => {
                        if (appFrame.flashPostApp) {
                            log('‚úÖ FlashPostApp –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'success');
                            resolve();
                        } else {
                            log('‚ö†Ô∏è FlashPostApp –Ω–µ –Ω–∞–π–¥–µ–Ω, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º', 'warning');
                            resolve();
                        }
                    }, 2000);
                };
                
                iframe.onerror = () => {
                    log('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è', 'error');
                    reject(new Error('Failed to load app'));
                };
                
                iframe.src = '/index.html';
            });
        }
        
        function loadMainApp() {
            loadMainAppForTesting();
        }
        
        function clearLog() {
            document.getElementById('test-log').innerHTML = 'Test logs cleared...';
            testResults = [];
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            log('üîß AI Generation Pipeline Test –≥–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É', 'info');
        });
    </script>
</body>
</html>