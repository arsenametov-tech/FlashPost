<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>FlashPost Mini App - Working Version</title>
    
    <!-- Google Fonts - –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —à—Ä–∏—Ñ—Ç–æ–≤ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Playfair+Display:wght@400;500;600;700;800;900&family=Bebas+Neue:wght@400&family=Space+Grotesk:wght@300;400;500;600;700&family=IBM+Plex+Mono:wght@300;400;500;600;700&display=swap&subset=latin,cyrillic" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            background: linear-gradient(135deg, #0f0f14 0%, #1a1a2e 50%, #16213e 100%);
            font-family: 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            color: #ffffff;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }
        
        .app {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
        }
        
        .bubbles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        .bubble {
            position: absolute;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            backdrop-filter: blur(4px);
            animation: float 8s infinite ease-in-out;
        }
        
        .bubble:nth-child(1) { width: 80px; height: 80px; left: 10%; animation-delay: 0s; }
        .bubble:nth-child(2) { width: 60px; height: 60px; left: 20%; animation-delay: 1s; }
        .bubble:nth-child(3) { width: 100px; height: 100px; left: 35%; animation-delay: 2s; }
        .bubble:nth-child(4) { width: 40px; height: 40px; left: 50%; animation-delay: 3s; }
        .bubble:nth-child(5) { width: 70px; height: 70px; left: 65%; animation-delay: 4s; }
        .bubble:nth-child(6) { width: 90px; height: 90px; left: 80%; animation-delay: 5s; }
        
        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }
        
        .main-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            z-index: 2;
            position: relative;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .title {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
        }
        
        .input-section {
            margin-bottom: 20px;
        }
        
        .manual-input-section {
            margin-bottom: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .input-label {
            display: block;
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 12px;
            color: rgba(255, 255, 255, 0.95);
        }
        
        .topic-input, .manual-textarea {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 16px 20px;
            font-size: 16px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.95);
            resize: none;
            outline: none;
            transition: all 0.3s ease;
            font-family: inherit;
            line-height: 1.5;
        }
        
        .topic-input {
            min-height: 80px;
        }
        
        .manual-textarea {
            min-height: 120px;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .topic-input:focus, .manual-textarea:focus {
            border-color: rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.1);
            transform: scale(1.01);
        }
        
        .topic-input::placeholder, .manual-textarea::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .generation-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }
        
        .btn {
            flex: 1;
            padding: 18px 24px;
            border: none;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-family: inherit;
            position: relative;
            overflow: hidden;
            z-index: 10;
            pointer-events: auto;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn-generate {
            background: linear-gradient(135deg, #833ab4 0%, #fd1d1d 50%, #fcb045 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(131, 58, 180, 0.3);
        }
        
        .btn-generate:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(131, 58, 180, 0.4);
        }
        
        .btn-ai {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        
        .btn-ai:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        .btn-ai:disabled {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.5);
            cursor: not-allowed;
            box-shadow: none;
        }
        
        .btn-manual {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(17, 153, 142, 0.3);
            margin-top: 15px;
            width: 100%;
        }
        
        .btn-manual:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(17, 153, 142, 0.4);
        }
        
        .carousel-container {
            display: none;
            margin-top: 30px;
        }
        
        .carousel-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .carousel-header h2 {
            font-size: 20px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: 4px;
        }
        
        .slide-preview {
            width: 100%;
            height: 300px;
            background: linear-gradient(135deg, #833ab4 0%, #fd1d1d 50%, #fcb045 100%);
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .slide-text {
            font-size: 18px;
            font-weight: 700;
            color: white;
            text-align: center;
            line-height: 1.4;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .slide-number {
            position: absolute;
            top: 16px;
            right: 16px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .carousel-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }
        
        .nav-btn {
            width: 48px;
            height: 48px;
            border: none;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            color: white;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 15;
            pointer-events: auto;
        }
        
        .nav-btn:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }
        
        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .indicators {
            display: flex;
            gap: 6px;
            flex: 1;
            justify-content: center;
            align-items: center;
        }
        
        .indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.4);
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 15;
            pointer-events: auto;
        }
        
        .indicator.active {
            background: white;
            transform: scale(1.4);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.5);
        }
        
        .actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.15);
            color: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            z-index: 10000;
            font-size: 14px;
            max-width: 300px;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }
        
        .toast.show {
            opacity: 1;
            transform: translateX(0);
        }
        
        .toast.error {
            background: #f44336;
        }
        
        /* ===== –†–ï–î–ê–ö–¢–û–† –°–õ–ê–ô–î–û–í ===== */
        .editor-container {
            margin-top: 30px;
        }
        
        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .editor-header h2 {
            font-size: 20px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.95);
        }
        
        .editor-content {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .slide-editor-preview {
            flex: 1;
            min-width: 300px;
            height: 300px;
            background: linear-gradient(135deg, #833ab4 0%, #fd1d1d 50%, #fcb045 100%);
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            padding: 20px;
        }
        
        .text-block {
            position: absolute;
            color: white;
            cursor: pointer;
            padding: 5px;
            border: 2px solid transparent;
            border-radius: 4px;
            transition: all 0.3s ease;
            word-wrap: break-word;
            white-space: pre-line;
            z-index: 20;
            pointer-events: auto;
        }
        
        .text-block:hover {
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(0, 0, 0, 0.2);
        }
        
        .text-block.active {
            border-color: #fff;
            background: rgba(0, 0, 0, 0.3);
        }
        
        .editor-controls {
            flex: 1;
            min-width: 300px;
        }
        
        .btn-add-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            width: 100%;
            margin-bottom: 20px;
        }
        
        .btn-add-text:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        .text-block-editor {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
        }
        
        .text-block-editor h3 {
            font-size: 16px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: 15px;
        }
        
        .block-text-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 12px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.95);
            resize: vertical;
            outline: none;
            transition: all 0.3s ease;
            font-family: inherit;
            min-height: 80px;
            margin-bottom: 15px;
        }
        
        .block-text-input:focus {
            border-color: rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .block-controls {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .block-controls label {
            font-size: 14px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .block-controls select,
        .block-controls input[type="range"] {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            padding: 8px;
            color: rgba(255, 255, 255, 0.95);
            font-size: 14px;
        }
        
        .block-controls select {
            cursor: pointer;
        }
        
        .block-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(255, 65, 108, 0.3);
        }
        
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 65, 108, 0.4);
        }
        
        @media (max-width: 480px) {
            .main-container {
                padding: 30px 20px;
                margin: 10px;
            }
            
            .title {
                font-size: 24px;
            }
            
            .generation-buttons {
                flex-direction: column;
                gap: 8px;
            }
        }
        
        /* ===== –°–ò–°–¢–ï–ú–ê –®–†–ò–§–¢–û–í ===== */
        .font-inter { font-family: 'Inter', sans-serif; }
        .font-playfair { font-family: 'Playfair Display', serif; }
        .font-bebas { font-family: 'Bebas Neue', cursive; }
        .font-space { font-family: 'Space Grotesk', sans-serif; }
        .font-mono { font-family: 'IBM Plex Mono', monospace; }
        
        /* ===== –†–ï–î–ê–ö–¢–û–† –¢–ï–ö–°–¢–ê ===== */
        .editor-container {
            display: none;
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 100%;
            overflow: hidden;
            z-index: 5;
        }
        
        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .editor-title {
            font-size: 18px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.95);
        }
        
        .editor-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .editor-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        
        .editor-content {
            display: flex;
            gap: 20px;
        }
        
        .editor-preview {
            flex: 2;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 20px;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .editor-text {
            color: white;
            text-align: center;
            line-height: 1.4;
            word-wrap: break-word;
            max-width: 100%;
        }
        
        .editor-controls {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .control-group {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
        }
        
        .control-label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .font-selector {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 10px;
            color: white;
            font-size: 14px;
            outline: none;
            cursor: pointer;
        }
        
        .font-selector option {
            background: #2a2a2a;
            color: white;
            padding: 8px;
        }
        
        .size-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .size-slider {
            flex: 1;
            height: 4px;
            border-radius: 2px;
            background: rgba(255, 255, 255, 0.2);
            outline: none;
            appearance: none;
            cursor: pointer;
        }
        
        .size-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .size-value {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            min-width: 30px;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 4px 8px;
            border-radius: 4px;
        }
        
        .weight-buttons {
            display: flex;
            gap: 5px;
        }
        
        .weight-btn {
            flex: 1;
            padding: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .weight-btn.active {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        .weight-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        @media (max-width: 768px) {
            .editor-content {
                flex-direction: column;
            }
            
            .editor-preview {
                min-height: 200px;
            }
        }
        
        /* ===== DEBUG HOVER STYLES ===== */
        .btn:hover,
        .nav-btn:hover:not(:disabled),
        .indicator:hover,
        .text-block:hover {
            outline: 2px solid rgba(0, 255, 128, 0.6) !important;
            outline-offset: 2px !important;
        }
        
        /* ===== CLICKABILITY FIXES ===== */
        button, 
        [onclick], 
        [role="button"],
        .clickable {
            pointer-events: auto !important;
            cursor: pointer !important;
            position: relative;
            z-index: 10;
        }
        
        .btn:disabled {
            pointer-events: none !important;
            cursor: not-allowed !important;
        }
        
        /* ===== MINI-APP BOUNDARIES ===== */
        .main-container {
            max-width: 600px;
            width: 100%;
            box-sizing: border-box;
            overflow: hidden;
        }
        
        .editor-content {
            max-width: 100%;
            overflow: hidden;
        }
        
        .slide-editor-preview {
            max-width: 100%;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    <!-- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É–∑—ã—Ä—å–∫–∏ -->
    <div class="bubbles">
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
    </div>

    <div class="app">
        <div class="main-container">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="header">
                <h1 class="title">üöÄ FlashPost AI</h1>
                <p class="subtitle">–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –≤–∏—Ä—É—Å–Ω—ã–µ –∫–∞—Ä—É—Å–µ–ª–∏ –∑–∞ –º–∏–Ω—É—Ç—ã</p>
            </div>
            
            <!-- –í–≤–æ–¥ —Ç–µ–º—ã -->
            <div class="input-section">
                <label class="input-label">üí° –í–≤–µ–¥–∏ —Ç–µ–º—É –¥–ª—è –∫–∞—Ä—É—Å–µ–ª–∏:</label>
                <textarea 
                    id="topicInput" 
                    class="topic-input" 
                    placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: '–ó–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ', '–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å', '–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏'..."
                    maxlength="200"
                ></textarea>
                
                <!-- –ö–Ω–æ–ø–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ -->
                <div class="generation-buttons">
                    <button class="btn btn-generate" id="generateBtn">
                        üéØ –°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—É—Å–µ–ª—å
                    </button>
                    <button class="btn btn-ai" id="aiBtn" disabled>
                        ü§ñ AI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
                    </button>
                </div>
            </div>
            
            <!-- –†—É—á–Ω–æ–π –≤–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ -->
            <div class="manual-input-section">
                <label class="input-label">‚úçÔ∏è –ò–ª–∏ –≤–≤–µ–¥–∏ –≥–æ—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç:</label>
                <textarea 
                    id="manualInput" 
                    class="manual-textarea" 
                    placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç, —Ä–∞–∑–¥–µ–ª—è—è —Å–ª–∞–π–¥—ã –¥–≤–æ–π–Ω—ã–º –ø–µ—Ä–µ–Ω–æ—Å–æ–º —Å—Ç—Ä–æ–∫–∏ (Enter Enter)&#10;&#10;–ù–∞–ø—Ä–∏–º–µ—Ä:&#10;–ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–µ—Ä–≤–æ–≥–æ —Å–ª–∞–π–¥–∞&#10;–û–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ —Å–ª–∞–π–¥–∞&#10;&#10;–ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤—Ç–æ—Ä–æ–≥–æ —Å–ª–∞–π–¥–∞&#10;–û–ø–∏—Å–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ —Å–ª–∞–π–¥–∞"
                ></textarea>
                
                <button class="btn btn-manual" id="manualBtn">
                    üìù –°–æ–∑–¥–∞—Ç—å –∏–∑ —Ç–µ–∫—Å—Ç–∞
                </button>
            </div>
            
            <!-- –ö–∞—Ä—É—Å–µ–ª—å (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
            <div class="carousel-container" id="carouselContainer">
                <div class="carousel-header">
                    <h2 id="carouselTitle">–í–∞—à–∞ –∫–∞—Ä—É—Å–µ–ª—å –≥–æ—Ç–æ–≤–∞!</h2>
                    <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä–µ–ª–∫–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏</p>
                </div>
                
                <div class="slide-preview" id="slidePreview">
                    <div class="slide-text" id="slideText">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    <div class="slide-number" id="slideNumber">1/5</div>
                </div>
                
                <div class="carousel-nav">
                    <button class="nav-btn" id="prevBtn">‚Äπ</button>
                    <div class="indicators" id="indicators"></div>
                    <button class="nav-btn" id="nextBtn">‚Ä∫</button>
                </div>
                
                <div class="actions">
                    <button class="btn btn-secondary" id="newCarouselBtn">
                        üîÑ –ù–æ–≤–∞—è –∫–∞—Ä—É—Å–µ–ª—å
                    </button>
                    <button class="btn btn-secondary" id="expandBtn">
                        üöÄ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏–¥–µ—é
                    </button>
                    <button class="btn btn-secondary" id="editSlideBtn">
                        ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ª–∞–π–¥
                    </button>
                </div>
            </div>
            
            <!-- –†–µ–¥–∞–∫—Ç–æ—Ä —Å–ª–∞–π–¥–∞ (—Å–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
            <div class="editor-container" id="editorContainer" style="display: none;">
                <div class="editor-header">
                    <h2 id="editorTitle">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–∞–π–¥–∞</h2>
                    <button class="btn btn-secondary" id="backToCarouselBtn">
                        ‚Üê –ù–∞–∑–∞–¥ –∫ –∫–∞—Ä—É—Å–µ–ª–∏
                    </button>
                </div>
                
                <div class="editor-content">
                    <div class="slide-editor-preview" id="slideEditorPreview">
                        <div id="textBlocksContainer"></div>
                    </div>
                    
                    <div class="editor-controls">
                        <button class="btn btn-add-text" id="addTextBtn">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç –Ω–∏–∂–µ
                        </button>
                        
                        <div class="text-block-editor" id="textBlockEditor" style="display: none;">
                            <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –±–ª–æ–∫–∞</h3>
                            <textarea id="blockTextInput" class="block-text-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç..."></textarea>
                            
                            <div class="block-controls">
                                <label>–®—Ä–∏—Ñ—Ç:</label>
                                <select id="blockFont">
                                    <option value="Inter">Inter</option>
                                    <option value="Montserrat">Montserrat</option>
                                    <option value="Arial">Arial</option>
                                </select>
                                
                                <label>–†–∞–∑–º–µ—Ä:</label>
                                <input type="range" id="blockSize" min="12" max="32" value="16">
                                <span id="blockSizeValue">16px</span>
                                
                                <label>–í–µ—Å:</label>
                                <select id="blockWeight">
                                    <option value="400">Normal</option>
                                    <option value="500">Medium</option>
                                    <option value="600">Semi-bold</option>
                                    <option value="700">Bold</option>
                                    <option value="800">Extra-bold</option>
                                </select>
                            </div>
                            
                            <div class="block-actions">
                                <button class="btn btn-secondary" id="saveBlockBtn">
                                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –±–ª–æ–∫
                                </button>
                                <button class="btn btn-danger" id="deleteBlockBtn">
                                    üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –±–ª–æ–∫
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ü—Ä–æ—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let currentSlides = [];
        let currentSlideIndex = 0;
        let isGenerating = false;
        let currentEditingSlide = null;
        let currentEditingBlockId = null;
        let nextBlockId = 1; nextBlockId = 1;

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const topicInput = document.getElementById('topicInput');
        const manualInput = document.getElementById('manualInput');
        const generateBtn = document.getElementById('generateBtn');
        const aiBtn = document.getElementById('aiBtn');
        const manualBtn = document.getElementById('manualBtn');
        const carouselContainer = document.getElementById('carouselContainer');
        const slidePreview = document.getElementById('slidePreview');
        const slideText = document.getElementById('slideText');
        const slideNumber = document.getElementById('slideNumber');
        const indicators = document.getElementById('indicators');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const newCarouselBtn = document.getElementById('newCarouselBtn');
        const expandBtn = document.getElementById('expandBtn');
        const editSlideBtn = document.getElementById('editSlideBtn');
        const carouselTitle = document.getElementById('carouselTitle');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
        const editorContainer = document.getElementById('editorContainer');
        const editorTitle = document.getElementById('editorTitle');
        const backToCarouselBtn = document.getElementById('backToCarouselBtn');
        const slideEditorPreview = document.getElementById('slideEditorPreview');
        const textBlocksContainer = document.getElementById('textBlocksContainer');
        const addTextBtn = document.getElementById('addTextBtn');
        const textBlockEditor = document.getElementById('textBlockEditor');
        const blockTextInput = document.getElementById('blockTextInput');
        const blockFont = document.getElementById('blockFont');
        const blockSize = document.getElementById('blockSize');
        const blockSizeValue = document.getElementById('blockSizeValue');
        const blockWeight = document.getElementById('blockWeight');
        const saveBlockBtn = document.getElementById('saveBlockBtn');
        const deleteBlockBtn = document.getElementById('deleteBlockBtn');

        // –°–∏—Å—Ç–µ–º–∞ —à—Ä–∏—Ñ—Ç–æ–≤
        const fontSystem = {
            fonts: [
                { name: 'Inter', family: 'Inter', class: 'font-inter', type: 'Sans-serif' },
                { name: 'Playfair Display', family: 'Playfair Display', class: 'font-playfair', type: 'Serif' },
                { name: 'Bebas Neue', family: 'Bebas Neue', class: 'font-bebas', type: 'Display' },
                { name: 'Space Grotesk', family: 'Space Grotesk', class: 'font-space', type: 'Modern' },
                { name: 'IBM Plex Mono', family: 'IBM Plex Mono', class: 'font-mono', type: 'Monospace' }
            ],
            
            applyFont: function(element, fontName) {
                // –£–±–∏—Ä–∞–µ–º –≤—Å–µ –∫–ª–∞—Å—Å—ã —à—Ä–∏—Ñ—Ç–æ–≤
                this.fonts.forEach(font => {
                    element.classList.remove(font.class);
                });
                
                // –ù–∞—Ö–æ–¥–∏–º —à—Ä–∏—Ñ—Ç –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º
                const font = this.fonts.find(f => f.name === fontName);
                if (font) {
                    element.classList.add(font.class);
                    element.style.fontFamily = font.family;
                    console.log(`üî§ –ü—Ä–∏–º–µ–Ω–µ–Ω —à—Ä–∏—Ñ—Ç: ${font.name}`);
                }
            },
            
            getFontOptions: function() {
                return this.fonts.map(font => 
                    `<option value="${font.name}">${font.name} (${font.type})</option>`
                ).join('');
            }
        };
        const slideColors = [
            'linear-gradient(135deg, #833ab4 0%, #fd1d1d 50%, #fcb045 100%)',
            'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
            'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
            'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
            'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',
            'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
            'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)'
        ];

        // –®–∞–±–ª–æ–Ω—ã –¥–ª—è —Ä—É—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
        function generateManualSlides(topic) {
            const templates = [
                {
                    title: `${topic}`,
                    subtitle: '–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ'
                },
                {
                    title: '–ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?',
                    subtitle: `–û—Å–Ω–æ–≤—ã ${topic.toLowerCase()}`
                },
                {
                    title: '–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ?',
                    subtitle: '–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞'
                },
                {
                    title: '–ö–∞–∫ –Ω–∞—á–∞—Ç—å?',
                    subtitle: '–ü–µ—Ä–≤—ã–µ —à–∞–≥–∏'
                },
                {
                    title: '–ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏',
                    subtitle: '–ß–µ–≥–æ –∏–∑–±–µ–≥–∞—Ç—å'
                },
                {
                    title: '–ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã',
                    subtitle: '–õ–∞–π—Ñ—Ö–∞–∫–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏'
                },
                {
                    title: '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ',
                    subtitle: '–ì–ª–∞–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã'
                }
            ];

            const slideCount = Math.floor(Math.random() * 3) + 5; // 5-7 —Å–ª–∞–π–¥–æ–≤
            return templates.slice(0, slideCount).map((template, index) => ({
                id: `slide_${Date.now()}_${index}`,
                title: template.title,
                subtitle: template.subtitle,
                text: `${template.title}\n\n${template.subtitle}`,
                color: slideColors[index % slideColors.length]
            }));
        }

        // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –¢–ï–ö–°–¢–û–í–´–ú–ò –ë–õ–û–ö–ê–ú–ò =====
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –±–ª–æ–∫–∞
        function createNewTextBlock(slideIndex) {
            const slide = currentSlides[slideIndex];
            if (!slide) return null;
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º textBlocks –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
            if (!slide.textBlocks) {
                slide.textBlocks = [];
            }
            
            // –í—ã—á–∏—Å–ª—è–µ–º Y –ø–æ–∑–∏—Ü–∏—é –¥–ª—è –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞
            let newY = 20; // –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
            if (slide.textBlocks.length > 0) {
                const lastBlock = slide.textBlocks[slide.textBlocks.length - 1];
                newY = (lastBlock.y || 20) + 15; // +15% –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –±–ª–æ–∫–∞
            }
            
            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –±–ª–æ–∫ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ID
            const newBlock = {
                id: `block_${Date.now()}_${nextBlockId++}`,
                text: '–ù–æ–≤—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫',
                x: 10,
                y: newY,
                width: 80,
                font: 'Inter',
                size: 16,
                weight: 500,
                color: '#ffffff',
                textAlign: 'center'
            };
            
            // –î–æ–±–∞–≤–ª—è–µ–º –±–ª–æ–∫ –∫ —Å–ª–∞–π–¥—É (–ù–ï –∫–æ–ø–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ)
            slide.textBlocks.push(newBlock);
            
            console.log(`‚úÖ –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫: ${newBlock.id} –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ Y=${newY}`);
            return newBlock;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –±–ª–æ–∫–∞
        function updateTextBlock(slideIndex, blockId, updates) {
            const slide = currentSlides[slideIndex];
            if (!slide || !slide.textBlocks) return false;
            
            const blockIndex = slide.textBlocks.findIndex(block => block.id === blockId);
            if (blockIndex === -1) return false;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
            Object.assign(slide.textBlocks[blockIndex], updates);
            
            console.log(`‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫: ${blockId}`, updates);
            return true;
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –±–ª–æ–∫–∞
        function deleteTextBlock(slideIndex, blockId) {
            const slide = currentSlides[slideIndex];
            if (!slide || !slide.textBlocks) return false;
            
            const blockIndex = slide.textBlocks.findIndex(block => block.id === blockId);
            if (blockIndex === -1) return false;
            
            // –£–¥–∞–ª—è–µ–º –±–ª–æ–∫ –∏–∑ –º–∞—Å—Å–∏–≤–∞
            slide.textBlocks.splice(blockIndex, 1);
            
            console.log(`‚úÖ –£–¥–∞–ª–µ–Ω —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫: ${blockId}`);
            return true;
        }
        
        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
        function renderTextBlocks() {
            if (!currentEditingSlide || !currentEditingSlide.textBlocks) return;
            
            textBlocksContainer.innerHTML = '';
            
            currentEditingSlide.textBlocks.forEach(block => {
                const blockElement = document.createElement('div');
                blockElement.className = 'text-block';
                blockElement.id = `block_${block.id}`;
                blockElement.style.cssText = `
                    left: ${block.x}%;
                    top: ${block.y}%;
                    width: ${block.width}%;
                    font-family: ${block.font};
                    font-size: ${block.size}px;
                    font-weight: ${block.weight};
                    color: ${block.color};
                    text-align: ${block.textAlign};
                `;
                blockElement.textContent = block.text;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                blockElement.addEventListener('click', () => {
                    selectTextBlock(block.id);
                });
                
                textBlocksContainer.appendChild(blockElement);
            });
            
            console.log(`‚úÖ –û—Ç—Ä–µ–Ω–¥–µ—Ä–µ–Ω–æ ${currentEditingSlide.textBlocks.length} —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤`);
        }
        
        // –í—ã–±–æ—Ä —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –±–ª–æ–∫–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function selectTextBlock(blockId) {
            currentEditingBlockId = blockId;
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –±–ª–æ–∫–æ–≤
            document.querySelectorAll('.text-block').forEach(el => {
                el.classList.remove('active');
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –±–ª–æ–∫—É
            const selectedElement = document.getElementById(`block_${blockId}`);
            if (selectedElement) {
                selectedElement.classList.add('active');
            }
            
            // –ù–∞—Ö–æ–¥–∏–º –±–ª–æ–∫ –≤ –¥–∞–Ω–Ω—ã—Ö
            const block = currentEditingSlide.textBlocks.find(b => b.id === blockId);
            if (block) {
                // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                blockTextInput.value = block.text;
                blockFont.value = block.font;
                blockSize.value = block.size;
                blockSizeValue.textContent = `${block.size}px`;
                blockWeight.value = block.weight;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä –±–ª–æ–∫–∞
                textBlockEditor.style.display = 'block';
                
                console.log(`‚úÖ –í—ã–±—Ä–∞–Ω –±–ª–æ–∫ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ${blockId}`);
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –±–ª–æ–∫–∞
        function saveCurrentBlock() {
            if (!currentEditingBlockId) return;
            
            const updates = {
                text: blockTextInput.value,
                font: blockFont.value,
                size: parseInt(blockSize.value),
                weight: parseInt(blockWeight.value)
            };
            
            const success = updateTextBlock(currentSlideIndex, currentEditingBlockId, updates);
            if (success) {
                renderTextBlocks();
                showToast('–¢–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
            }
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –±–ª–æ–∫–∞
        function deleteCurrentBlock() {
            if (!currentEditingBlockId) return;
            
            const success = deleteTextBlock(currentSlideIndex, currentEditingBlockId);
            if (success) {
                currentEditingBlockId = null;
                textBlockEditor.style.display = 'none';
                renderTextBlocks();
                showToast('–¢–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫ —É–¥–∞–ª–µ–Ω!');
            }
        }
        // ===== –§–£–ù–ö–¶–ò–ò –†–ï–î–ê–ö–¢–û–†–ê –°–õ–ê–ô–î–û–í =====
        
        // –û—Ç–∫—Ä—ã—Ç–∏–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ —Å–ª–∞–π–¥–∞
        function openSlideEditor() {
            if (currentSlides.length === 0) {
                showToast('–ù–µ—Ç —Å–ª–∞–π–¥–æ–≤ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
                return;
            }
            
            currentEditingSlide = currentSlides[currentSlideIndex];
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º textBlocks –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
            if (!currentEditingSlide.textBlocks) {
                currentEditingSlide.textBlocks = [];
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
            editorTitle.textContent = `–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: ${currentEditingSlide.title}`;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω –ø—Ä–µ–≤—å—é
            slideEditorPreview.style.background = currentEditingSlide.color;
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∫–∞—Ä—É—Å–µ–ª—å –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä
            carouselContainer.style.display = 'none';
            editorContainer.style.display = 'block';
            
            // –†–µ–Ω–¥–µ—Ä–∏–º —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –±–ª–æ–∫–∏
            renderTextBlocks();
            
            console.log(`‚úÖ –û—Ç–∫—Ä—ã—Ç —Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–ª—è —Å–ª–∞–π–¥–∞: ${currentEditingSlide.title}`);
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∏ –≤–æ–∑–≤—Ä–∞—Ç –∫ –∫–∞—Ä—É—Å–µ–ª–∏
        function closeSlideEditor() {
            // –°–∫—Ä—ã–≤–∞–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞—Ä—É—Å–µ–ª—å
            editorContainer.style.display = 'none';
            carouselContainer.style.display = 'block';
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
            currentEditingSlide = null;
            currentEditingBlockId = null;
            textBlockEditor.style.display = 'none';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ä—É—Å–µ–ª–∏
            updateSlideDisplay();
            
            console.log('‚úÖ –†–µ–¥–∞–∫—Ç–æ—Ä –∑–∞–∫—Ä—ã—Ç, –≤–æ–∑–≤—Ä–∞—Ç –∫ –∫–∞—Ä—É—Å–µ–ª–∏');
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –±–ª–æ–∫–∞
        function addNewTextBlock() {
            if (!currentEditingSlide) return;
            
            const newBlock = createNewTextBlock(currentSlideIndex);
            if (newBlock) {
                renderTextBlocks();
                selectTextBlock(newBlock.id);
                showToast('–î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫!');
            }
        }

        function generateSlidesFromText(text) {
            console.log('üìù –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–∞–π–¥–æ–≤ –∏–∑ —Ç–µ–∫—Å—Ç–∞...');
            
            // –†–∞–∑–±–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –Ω–∞ –∞–±–∑–∞—Ü—ã –ø–æ –¥–≤–æ–π–Ω–æ–º—É –ø–µ—Ä–µ–Ω–æ—Å—É —Å—Ç—Ä–æ–∫–∏
            const paragraphs = text.split('\n\n')
                .map(p => p.trim())
                .filter(p => p.length > 0);
            
            console.log(`üìù –ù–∞–π–¥–µ–Ω–æ ${paragraphs.length} –∞–±–∑–∞—Ü–µ–≤`);
            
            if (paragraphs.length === 0) {
                throw new Error('–¢–µ–∫—Å—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–±–∑–∞—Ü–µ–≤');
            }
            
            // –°–æ–∑–¥–∞–µ–º —Å–ª–∞–π–¥—ã –∏–∑ –∞–±–∑–∞—Ü–µ–≤
            const slides = paragraphs.map((paragraph, index) => {
                const lines = paragraph.split('\n').filter(line => line.trim().length > 0);
                const title = lines[0] || `–°–ª–∞–π–¥ ${index + 1}`;
                const fullText = paragraph;
                
                return {
                    id: `text_slide_${Date.now()}_${index}`,
                    title: title,
                    subtitle: lines.length > 1 ? lines.slice(1).join(' ') : '',
                    text: fullText,
                    color: slideColors[index % slideColors.length],
                    textBlocks: [{
                        id: `text_block_${Date.now()}_${index}`,
                        text: fullText,
                        x: 10,
                        y: 20,
                        width: 80,
                        font: 'Inter',
                        size: 16,
                        weight: 500,
                        color: '#ffffff',
                        textAlign: 'center'
                    }]
                };
            });
            
            // –ï—Å–ª–∏ —Å–ª–∞–π–¥–æ–≤ –º–µ–Ω—å—à–µ 5, –¥–æ–ø–æ–ª–Ω—è–µ–º —à–∞–±–ª–æ–Ω–Ω—ã–º–∏
            if (slides.length < 5) {
                const topic = slides[0]?.title || '–¢–µ–º–∞';
                const additionalTemplates = [
                    { title: '–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã', subtitle: '–ß—Ç–æ –≤–∞–∂–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å' },
                    { title: '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã', subtitle: '–ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ' },
                    { title: '–ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏', subtitle: '–ß–µ–≥–æ —Å—Ç–æ–∏—Ç –∏–∑–±–µ–≥–∞—Ç—å' },
                    { title: '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ', subtitle: '–ü–æ–¥–≤–æ–¥–∏–º –∏—Ç–æ–≥–∏' }
                ];
                
                const needed = 5 - slides.length;
                const startIndex = slides.length;
                
                for (let i = 0; i < needed && i < additionalTemplates.length; i++) {
                    const template = additionalTemplates[i];
                    const slideIndex = startIndex + i;
                    
                    slides.push({
                        id: `template_slide_${Date.now()}_${slideIndex}`,
                        title: template.title,
                        subtitle: template.subtitle,
                        text: `${template.title}\n\n${template.subtitle}`,
                        color: slideColors[slideIndex % slideColors.length],
                        textBlocks: [{
                            id: `template_block_${Date.now()}_${slideIndex}`,
                            text: `${template.title}\n\n${template.subtitle}`,
                            x: 10,
                            y: 20,
                            width: 80,
                            font: 'Inter',
                            size: 16,
                            weight: 500,
                            color: '#ffffff',
                            textAlign: 'center'
                        }]
                    });
                }
                
                console.log(`üìù –î–æ–±–∞–≤–ª–µ–Ω–æ ${needed} —à–∞–±–ª–æ–Ω–Ω—ã—Ö —Å–ª–∞–π–¥–æ–≤`);
            }
            
            console.log(`‚úÖ –°–æ–∑–¥–∞–Ω–æ ${slides.length} —Å–ª–∞–π–¥–æ–≤ –∏–∑ —Ç–µ–∫—Å—Ç–∞`);
            return slides;
        }
        function generateExpandSlides(topic) {
            const expandTemplates = [
                {
                    title: `–ú–∏—Ñ –æ ${topic.toLowerCase()}`,
                    subtitle: '–†–∞–∑—Ä—É—à–∞–µ–º –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∑–∞–±–ª—É–∂–¥–µ–Ω–∏—è'
                },
                {
                    title: '–ì–ª–∞–≤–Ω–∞—è –æ—à–∏–±–∫–∞ –Ω–æ–≤–∏—á–∫–æ–≤',
                    subtitle: `–ß—Ç–æ –ù–ï –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å –≤ ${topic.toLowerCase()}`
                },
                {
                    title: '–ù–µ–æ—á–µ–≤–∏–¥–Ω—ã–π –∏–Ω—Å–∞–π—Ç',
                    subtitle: '–¢–æ, –æ —á–µ–º –Ω–µ –≥–æ–≤–æ—Ä—è—Ç —ç–∫—Å–ø–µ—Ä—Ç—ã'
                },
                {
                    title: '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∫–µ–π—Å',
                    subtitle: '–†–µ–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∏–∑ –∂–∏–∑–Ω–∏'
                },
                {
                    title: '–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏',
                    subtitle: '–ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ'
                }
            ];

            const slideCount = Math.floor(Math.random() * 3) + 3; // 3-5 —Å–ª–∞–π–¥–æ–≤
            const startIndex = currentSlides.length;
            
            return expandTemplates.slice(0, slideCount).map((template, index) => ({
                id: `expand_slide_${Date.now()}_${index}`,
                title: template.title,
                subtitle: template.subtitle,
                text: `${template.title}\n\n${template.subtitle}`,
                color: slideColors[(startIndex + index) % slideColors.length]
            }));
        }

        // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showToast(message, type = 'success') {
            try {
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.textContent = message;
                document.body.appendChild(toast);

                setTimeout(() => toast.classList.add('show'), 100);
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => {
                        if (document.body.contains(toast)) {
                            document.body.removeChild(toast);
                        }
                    }, 300);
                }, 3000);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:', error);
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ª–∞–π–¥–∞
        function updateSlideDisplay() {
            try {
                if (currentSlides.length === 0) return;

                const slide = currentSlides[currentSlideIndex];
                if (!slide) return;

                if (slideText) slideText.textContent = slide.text;
                if (slideNumber) slideNumber.textContent = `${currentSlideIndex + 1}/${currentSlides.length}`;
                if (slidePreview) slidePreview.style.background = slide.color;
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º —à—Ä–∏—Ñ—Ç –µ—Å–ª–∏ –æ–Ω —É–∫–∞–∑–∞–Ω –≤ textBlocks
                if (slide.textBlocks && slide.textBlocks[0] && slide.textBlocks[0].font && slideText) {
                    fontSystem.applyFont(slideText, slide.textBlocks[0].font);
                    slideText.style.fontSize = (slide.textBlocks[0].size || 18) + 'px';
                    slideText.style.fontWeight = slide.textBlocks[0].weight || 500;
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
                if (indicators) {
                    indicators.innerHTML = '';
                    currentSlides.forEach((_, index) => {
                        const indicator = document.createElement('div');
                        indicator.className = `indicator ${index === currentSlideIndex ? 'active' : ''}`;
                        indicator.addEventListener('click', () => {
                            currentSlideIndex = index;
                            updateSlideDisplay();
                        });
                        indicators.appendChild(indicator);
                    });
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                if (prevBtn) prevBtn.disabled = currentSlideIndex === 0;
                if (nextBtn) nextBtn.disabled = currentSlideIndex === currentSlides.length - 1;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ª–∞–π–¥–∞:', error);
                showToast('–û—à–∏–±–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ª–∞–π–¥–∞', 'error');
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
        function handleManualGenerate() {
            try {
                if (!topicInput) {
                    showToast('–û—à–∏–±–∫–∞: –ø–æ–ª–µ –≤–≤–æ–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ', 'error');
                    return;
                }

                const topic = topicInput.value.trim();
                if (!topic) {
                    showToast('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–º—É –¥–ª—è –∫–∞—Ä—É—Å–µ–ª–∏', 'error');
                    return;
                }

                if (isGenerating) return;

                isGenerating = true;
                if (generateBtn) {
                    generateBtn.textContent = 'üîÑ –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—É—Å–µ–ª—å...';
                    generateBtn.disabled = true;
                }

                setTimeout(() => {
                    try {
                        currentSlides = generateManualSlides(topic);
                        currentSlideIndex = 0;
                        
                        if (carouselTitle) carouselTitle.textContent = `–ö–∞—Ä—É—Å–µ–ª—å "${topic}" –≥–æ—Ç–æ–≤–∞!`;
                        if (carouselContainer) carouselContainer.style.display = 'block';
                        updateSlideDisplay();
                        
                        showToast(`–°–æ–∑–¥–∞–Ω–æ ${currentSlides.length} —Å–ª–∞–π–¥–æ–≤!`);
                        console.log('‚úÖ –ö–∞—Ä—É—Å–µ–ª—å —Å–æ–∑–¥–∞–Ω–∞:', currentSlides);
                        
                    } catch (error) {
                        console.error('‚ùå –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:', error);
                        showToast('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—É—Å–µ–ª–∏', 'error');
                    } finally {
                        isGenerating = false;
                        if (generateBtn) {
                            generateBtn.textContent = 'üéØ –°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—É—Å–µ–ª—å';
                            generateBtn.disabled = false;
                        }
                    }
                }, 1500);
            } catch (error) {
                console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:', error);
                showToast('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞', 'error');
                isGenerating = false;
                if (generateBtn) {
                    generateBtn.textContent = 'üéØ –°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—É—Å–µ–ª—å';
                    generateBtn.disabled = false;
                }
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏–∑ —Ç–µ–∫—Å—Ç–∞
        function handleManualText() {
            try {
                if (!manualInput) {
                    showToast('–û—à–∏–±–∫–∞: –ø–æ–ª–µ –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ', 'error');
                    return;
                }

                const text = manualInput.value.trim();
                if (!text) {
                    showToast('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–∞–π–¥–æ–≤', 'error');
                    return;
                }

                if (isGenerating) return;

                isGenerating = true;
                if (manualBtn) {
                    manualBtn.textContent = 'üîÑ –°–æ–∑–¥–∞–µ–º –∏–∑ —Ç–µ–∫—Å—Ç–∞...';
                    manualBtn.disabled = true;
                }

                setTimeout(() => {
                    try {
                        currentSlides = generateSlidesFromText(text);
                        currentSlideIndex = 0;
                        
                        if (carouselTitle) carouselTitle.textContent = '–ö–∞—Ä—É—Å–µ–ª—å –∏–∑ –≤–∞—à–µ–≥–æ —Ç–µ–∫—Å—Ç–∞ –≥–æ—Ç–æ–≤–∞!';
                        if (carouselContainer) carouselContainer.style.display = 'block';
                        updateSlideDisplay();
                        
                        showToast(`–°–æ–∑–¥–∞–Ω–æ ${currentSlides.length} —Å–ª–∞–π–¥–æ–≤ –∏–∑ —Ç–µ–∫—Å—Ç–∞!`);
                        console.log('‚úÖ –ö–∞—Ä—É—Å–µ–ª—å –∏–∑ —Ç–µ–∫—Å—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞:', currentSlides);
                        
                    } catch (error) {
                        console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏–∑ —Ç–µ–∫—Å—Ç–∞:', error);
                        showToast(`–û—à–∏–±–∫–∞: ${error.message}`, 'error');
                    } finally {
                        isGenerating = false;
                        if (manualBtn) {
                            manualBtn.textContent = 'üìù –°–æ–∑–¥–∞—Ç—å –∏–∑ —Ç–µ–∫—Å—Ç–∞';
                            manualBtn.disabled = false;
                        }
                    }
                }, 1000);
            } catch (error) {
                console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏–∑ —Ç–µ–∫—Å—Ç–∞:', error);
                showToast('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞', 'error');
                isGenerating = false;
                if (manualBtn) {
                    manualBtn.textContent = 'üìù –°–æ–∑–¥–∞—Ç—å –∏–∑ —Ç–µ–∫—Å—Ç–∞';
                    manualBtn.disabled = false;
                }
            }
        }
        function handleExpandIdea() {
            if (currentSlides.length === 0) {
                showToast('–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ä—É—Å–µ–ª—å', 'error');
                return;
            }

            const topic = currentSlides[0].title;
            expandBtn.textContent = 'üîÑ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ–º...';
            expandBtn.disabled = true;

            setTimeout(() => {
                try {
                    const newSlides = generateExpandSlides(topic);
                    currentSlides = [...currentSlides, ...newSlides];
                    
                    updateSlideDisplay();
                    showToast(`–î–æ–±–∞–≤–ª–µ–Ω–æ ${newSlides.length} —Å–ª–∞–π–¥–æ–≤!`);
                    console.log('‚úÖ –ò–¥–µ—è —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞:', newSlides);
                    
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:', error);
                    showToast('–û—à–∏–±–∫–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏–¥–µ–∏', 'error');
                } finally {
                    expandBtn.textContent = 'üöÄ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏–¥–µ—é';
                    expandBtn.disabled = false;
                }
            }, 1000);
        }

        // –ü—Ä–æ—Å—Ç–æ–π —Ä–µ–¥–∞–∫—Ç–æ—Ä —à—Ä–∏—Ñ—Ç–æ–≤
        function openFontEditor() {
            if (currentSlides.length === 0) {
                showToast('–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ä—É—Å–µ–ª—å', 'error');
                return;
            }
            
            const slide = currentSlides[currentSlideIndex];
            const currentFont = slide.textBlocks?.[0]?.font || 'Inter';
            const currentSize = slide.textBlocks?.[0]?.size || 18;
            const currentWeight = slide.textBlocks?.[0]?.weight || 500;
            
            const editorHTML = `
                <div style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.8);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10000;
                " id="fontEditorModal">
                    <div style="
                        background: linear-gradient(135deg, #0f0f14 0%, #1a1a2e 50%, #16213e 100%);
                        border-radius: 20px;
                        padding: 30px;
                        max-width: 500px;
                        width: 90%;
                        border: 1px solid rgba(255,255,255,0.2);
                        box-shadow: 0 20px 60px rgba(0,0,0,0.5);
                    ">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3 style="color: white; margin: 0;">üî§ –†–µ–¥–∞–∫—Ç–æ—Ä —à—Ä–∏—Ñ—Ç–æ–≤</h3>
                            <button onclick="closeFontEditor()" style="
                                background: rgba(255,255,255,0.2);
                                border: none;
                                border-radius: 50%;
                                width: 32px;
                                height: 32px;
                                color: white;
                                cursor: pointer;
                                font-size: 18px;
                            ">√ó</button>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <div style="
                                background: rgba(0,0,0,0.3);
                                border-radius: 12px;
                                padding: 30px;
                                text-align: center;
                                margin-bottom: 20px;
                            ">
                                <div id="fontPreviewText" style="
                                    color: white;
                                    font-size: ${currentSize}px;
                                    font-weight: ${currentWeight};
                                    font-family: '${currentFont}', sans-serif;
                                    line-height: 1.4;
                                ">${slide.text}</div>
                            </div>
                        </div>
                        
                        <div style="display: flex; flex-direction: column; gap: 15px;">
                            <div>
                                <label style="color: rgba(255,255,255,0.8); font-size: 12px; margin-bottom: 5px; display: block;">–®–†–ò–§–¢</label>
                                <select id="fontSelect" style="
                                    width: 100%;
                                    background: rgba(255,255,255,0.1);
                                    border: 1px solid rgba(255,255,255,0.2);
                                    border-radius: 8px;
                                    padding: 10px;
                                    color: white;
                                    font-size: 14px;
                                ">
                                    ${fontSystem.getFontOptions()}
                                </select>
                            </div>
                            
                            <div>
                                <label style="color: rgba(255,255,255,0.8); font-size: 12px; margin-bottom: 5px; display: block;">–†–ê–ó–ú–ï–†: <span id="sizeDisplay">${currentSize}px</span></label>
                                <input type="range" id="sizeRange" min="12" max="48" value="${currentSize}" style="
                                    width: 100%;
                                    height: 4px;
                                    border-radius: 2px;
                                    background: rgba(255,255,255,0.2);
                                    outline: none;
                                    appearance: none;
                                    cursor: pointer;
                                ">
                            </div>
                            
                            <div>
                                <label style="color: rgba(255,255,255,0.8); font-size: 12px; margin-bottom: 5px; display: block;">–¢–û–õ–©–ò–ù–ê</label>
                                <div style="display: flex; gap: 5px;">
                                    <button class="weightBtn" data-weight="300" style="
                                        flex: 1; padding: 8px; border: 1px solid rgba(255,255,255,0.2);
                                        border-radius: 6px; background: rgba(255,255,255,0.1);
                                        color: white; font-size: 12px; cursor: pointer;
                                        ${currentWeight == 300 ? 'background: rgba(255,255,255,0.3);' : ''}
                                    ">Light</button>
                                    <button class="weightBtn" data-weight="500" style="
                                        flex: 1; padding: 8px; border: 1px solid rgba(255,255,255,0.2);
                                        border-radius: 6px; background: rgba(255,255,255,0.1);
                                        color: white; font-size: 12px; cursor: pointer;
                                        ${currentWeight == 500 ? 'background: rgba(255,255,255,0.3);' : ''}
                                    ">Normal</button>
                                    <button class="weightBtn" data-weight="700" style="
                                        flex: 1; padding: 8px; border: 1px solid rgba(255,255,255,0.2);
                                        border-radius: 6px; background: rgba(255,255,255,0.1);
                                        color: white; font-size: 12px; cursor: pointer;
                                        ${currentWeight == 700 ? 'background: rgba(255,255,255,0.3);' : ''}
                                    ">Bold</button>
                                </div>
                            </div>
                            
                            <button onclick="applyFontChanges()" style="
                                background: linear-gradient(45deg, #833ab4, #fd1d1d);
                                color: white;
                                border: none;
                                padding: 15px;
                                border-radius: 8px;
                                cursor: pointer;
                                font-weight: 600;
                                margin-top: 10px;
                            ">‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', editorHTML);
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —à—Ä–∏—Ñ—Ç
            document.getElementById('fontSelect').value = currentFont;
            
            // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏—è
            setupFontEditorEvents();
        }
        
        function setupFontEditorEvents() {
            const fontSelect = document.getElementById('fontSelect');
            const sizeRange = document.getElementById('sizeRange');
            const sizeDisplay = document.getElementById('sizeDisplay');
            const previewText = document.getElementById('fontPreviewText');
            const weightBtns = document.querySelectorAll('.weightBtn');
            
            let selectedFont = fontSelect.value;
            let selectedSize = parseInt(sizeRange.value);
            let selectedWeight = 500;
            
            // –ù–∞—Ö–æ–¥–∏–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É –≤–µ—Å–∞
            weightBtns.forEach(btn => {
                if (btn.style.background.includes('0.3')) {
                    selectedWeight = parseInt(btn.dataset.weight);
                }
            });
            
            function updatePreview() {
                previewText.style.fontFamily = selectedFont;
                previewText.style.fontSize = selectedSize + 'px';
                previewText.style.fontWeight = selectedWeight;
            }
            
            fontSelect.addEventListener('change', (e) => {
                selectedFont = e.target.value;
                updatePreview();
            });
            
            sizeRange.addEventListener('input', (e) => {
                selectedSize = parseInt(e.target.value);
                sizeDisplay.textContent = selectedSize + 'px';
                updatePreview();
            });
            
            weightBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    weightBtns.forEach(b => b.style.background = 'rgba(255,255,255,0.1)');
                    btn.style.background = 'rgba(255,255,255,0.3)';
                    selectedWeight = parseInt(btn.dataset.weight);
                    updatePreview();
                });
            });
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
            window.selectedFontSettings = {
                font: selectedFont,
                size: selectedSize,
                weight: selectedWeight
            };
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
            fontSelect.addEventListener('change', () => {
                window.selectedFontSettings.font = fontSelect.value;
            });
            sizeRange.addEventListener('input', () => {
                window.selectedFontSettings.size = parseInt(sizeRange.value);
            });
        }
        
        function applyFontChanges() {
            if (!window.selectedFontSettings) return;
            
            const settings = window.selectedFontSettings;
            const slide = currentSlides[currentSlideIndex];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º textBlocks —Å–ª–∞–π–¥–∞
            if (!slide.textBlocks) slide.textBlocks = [];
            if (!slide.textBlocks[0]) {
                slide.textBlocks[0] = {
                    id: `block_${Date.now()}`,
                    text: slide.text,
                    x: 10, y: 20, width: 80,
                    font: 'Inter', size: 18, weight: 500,
                    color: '#ffffff', textAlign: 'center'
                };
            }
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            slide.textBlocks[0].font = settings.font;
            slide.textBlocks[0].size = settings.size;
            slide.textBlocks[0].weight = settings.weight;
            
            console.log('üî§ –®—Ä–∏—Ñ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω:', settings);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateSlideDisplay();
            closeFontEditor();
            
            showToast(`–®—Ä–∏—Ñ—Ç –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ ${settings.font}!`);
        }
        
        function closeFontEditor() {
            const modal = document.getElementById('fontEditorModal');
            if (modal) {
                modal.remove();
            }
        }
        function handleNewCarousel() {
            currentSlides = [];
            currentSlideIndex = 0;
            carouselContainer.style.display = 'none';
            topicInput.value = '';
            manualInput.value = '';
            topicInput.focus();
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å–ª–∞–π–¥–∞–º
        function navigateSlide(direction) {
            if (direction === 'prev' && currentSlideIndex > 0) {
                currentSlideIndex--;
            } else if (direction === 'next' && currentSlideIndex < currentSlides.length - 1) {
                currentSlideIndex++;
            }
            updateSlideDisplay();
        }

        // –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
        function bindEvents() {
            try {
                if (generateBtn) generateBtn.addEventListener('click', handleManualGenerate);
                if (manualBtn) manualBtn.addEventListener('click', handleManualText);
                if (expandBtn) expandBtn.addEventListener('click', handleExpandIdea);
                if (newCarouselBtn) newCarouselBtn.addEventListener('click', handleNewCarousel);
                if (editSlideBtn) editSlideBtn.addEventListener('click', openFontEditor);
                if (prevBtn) prevBtn.addEventListener('click', () => navigateSlide('prev'));
                if (nextBtn) nextBtn.addEventListener('click', () => navigateSlide('next'));
                
                // –°–æ–±—ã—Ç–∏—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
                if (backToCarouselBtn) backToCarouselBtn.addEventListener('click', closeSlideEditor);
                if (addTextBtn) addTextBtn.addEventListener('click', addNewTextBlock);
                if (saveBlockBtn) saveBlockBtn.addEventListener('click', saveCurrentBlock);
                if (deleteBlockBtn) deleteBlockBtn.addEventListener('click', deleteCurrentBlock);
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
                if (blockSize && blockSizeValue) {
                    blockSize.addEventListener('input', () => {
                        blockSizeValue.textContent = `${blockSize.value}px`;
                    });
                }

                // –û–±—Ä–∞–±–æ—Ç–∫–∞ Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
                if (topicInput) {
                    topicInput.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' && !e.shiftKey) {
                            e.preventDefault();
                            handleManualGenerate();
                        }
                    });
                }

                // –ù–∞–≤–∏–≥–∞—Ü–∏—è –∫–ª–∞–≤–∏—à–∞–º–∏
                document.addEventListener('keydown', (e) => {
                    try {
                        if (carouselContainer && carouselContainer.style.display === 'block') {
                            if (e.key === 'ArrowLeft') navigateSlide('prev');
                            if (e.key === 'ArrowRight') navigateSlide('next');
                        }
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∫–ª–∞–≤–∏—à–∞–º–∏:', error);
                    }
                });
                
                console.log('‚úÖ –°–æ–±—ã—Ç–∏—è —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–≤—è–∑–∞–Ω—ã');
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏–≤—è–∑–∫–∏ —Å–æ–±—ã—Ç–∏–π:', error);
                showToast('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π', 'error');
            }
        }

        // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏—è
        bindEvents();

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
        function initializeApp() {
            try {
                console.log('üöÄ FlashPost Working App –∑–∞–≥—Ä—É–∂–µ–Ω');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                const requiredElements = [
                    { element: topicInput, name: 'topicInput' },
                    { element: manualInput, name: 'manualInput' },
                    { element: generateBtn, name: 'generateBtn' },
                    { element: manualBtn, name: 'manualBtn' }
                ];
                
                let missingElements = [];
                requiredElements.forEach(({ element, name }) => {
                    if (!element) {
                        missingElements.push(name);
                        console.error(`‚ùå –≠–ª–µ–º–µ–Ω—Ç ${name} –Ω–µ –Ω–∞–π–¥–µ–Ω`);
                    }
                });
                
                if (missingElements.length > 0) {
                    console.error(`‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã: ${missingElements.join(', ')}`);
                    showToast('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è', 'error');
                    return;
                }
                
                // –§–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
                if (topicInput) {
                    topicInput.focus();
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
                setTimeout(() => {
                    showToast('FlashPost –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ!');
                }, 500);
                
                console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
                
            } catch (error) {
                console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                showToast('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏', 'error');
            }
        }

        // –ó–∞–ø—É—Å–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        initializeApp();
    </script>
</body>
</html>