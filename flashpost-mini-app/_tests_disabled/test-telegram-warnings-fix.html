<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Telegram Warnings Fix</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f0f14;
            color: white;
            padding: 20px;
            line-height: 1.6;
        }
        .test-container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }
        .status {
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
        }
        .success { background: rgba(40, 167, 69, 0.2); border-left: 4px solid #28a745; }
        .warning { background: rgba(255, 193, 7, 0.2); border-left: 4px solid #ffc107; }
        .error { background: rgba(220, 53, 69, 0.2); border-left: 4px solid #dc3545; }
        .console-output {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin: 15px 0;
        }
        button {
            background: #833ab4;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            margin: 5px;
        }
        button:hover {
            background: #6c2e8f;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üîß Test Telegram WebApp Warnings Fix</h1>
        
        <div class="status success">
            <strong>‚úÖ –¶–µ–ª—å:</strong> –£–±—Ä–∞—Ç—å warnings –æ setHeaderColor –∏ setBackgroundColor
        </div>
        
        <div class="status warning">
            <strong>‚ö†Ô∏è –ë—ã–ª–æ:</strong> [Telegram.WebApp] Header/Background color is not supported in version 6.0
        </div>
        
        <div class="status success">
            <strong>üéØ –°—Ç–∞–ª–æ:</strong> –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ API –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º –º–µ—Ç–æ–¥–æ–≤
        </div>
        
        <h3>üìä Console Output Monitor</h3>
        <div class="console-output" id="consoleOutput">
            Monitoring console messages...
        </div>
        
        <div>
            <button onclick="testTelegramInit()">üß™ Test Telegram Init</button>
            <button onclick="clearConsole()">üßπ Clear Console</button>
            <button onclick="window.location.href='index.html'">üöÄ Open Main App</button>
        </div>
        
        <h3>üìã Test Results</h3>
        <div id="testResults">
            <div class="status warning">Waiting for tests...</div>
        </div>
    </div>

    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <script>
        let consoleMessages = [];
        let originalConsole = {
            log: console.log,
            warn: console.warn,
            error: console.error
        };
        
        // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º console —Å–æ–æ–±—â–µ–Ω–∏—è
        function interceptConsole() {
            ['log', 'warn', 'error'].forEach(method => {
                console[method] = function(...args) {
                    const message = args.join(' ');
                    const timestamp = new Date().toLocaleTimeString();
                    
                    consoleMessages.push({
                        type: method,
                        message: message,
                        timestamp: timestamp
                    });
                    
                    updateConsoleOutput();
                    originalConsole[method].apply(console, args);
                };
            });
        }
        
        function updateConsoleOutput() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML = consoleMessages.map(msg => {
                const color = {
                    log: '#4CAF50',
                    warn: '#FF9800', 
                    error: '#F44336'
                }[msg.type];
                
                return `<div style="color: ${color}; margin: 2px 0;">
                    [${msg.timestamp}] ${msg.type.toUpperCase()}: ${msg.message}
                </div>`;
            }).join('');
            
            output.scrollTop = output.scrollHeight;
        }
        
        function clearConsole() {
            consoleMessages = [];
            updateConsoleOutput();
        }
        
        function testTelegramInit() {
            console.log('üß™ Starting Telegram WebApp initialization test...');
            
            const tg = window.Telegram?.WebApp;
            if (!tg) {
                console.error('‚ùå Telegram WebApp not available');
                updateTestResults('error', 'Telegram WebApp SDK not loaded');
                return;
            }
            
            console.log('‚úÖ Telegram WebApp SDK loaded');
            console.log('üìä Version:', tg.version || 'unknown');
            
            try {
                // –¢–µ—Å—Ç–∏—Ä—É–µ–º –Ω–æ–≤—É—é –ª–æ–≥–∏–∫—É —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≤–µ—Ä—Å–∏–∏
                const version = tg.version || '6.0';
                const majorVersion = parseFloat(version);
                
                console.log('üîç Checking API version:', version, 'Major:', majorVersion);
                
                if (majorVersion >= 6.1) {
                    console.log('‚úÖ Version supports color methods, calling setHeaderColor...');
                    tg.setHeaderColor('#833ab4');
                    tg.setBackgroundColor('#ffffff');
                    console.log('‚úÖ Color methods called successfully');
                } else {
                    console.log('‚ÑπÔ∏è Version does not support color methods, skipping...');
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º warnings
                setTimeout(() => {
                    const hasWarnings = consoleMessages.some(msg => 
                        msg.message.includes('Header color is not supported') ||
                        msg.message.includes('Background color is not supported')
                    );
                    
                    if (hasWarnings) {
                        updateTestResults('error', 'Warnings still present in console');
                    } else {
                        updateTestResults('success', 'No Telegram WebApp warnings detected!');
                    }
                }, 1000);
                
            } catch (error) {
                console.error('‚ùå Error during test:', error);
                updateTestResults('error', 'Test failed: ' + error.message);
            }
        }
        
        function updateTestResults(type, message) {
            const results = document.getElementById('testResults');
            const statusClass = type === 'success' ? 'success' : type === 'error' ? 'error' : 'warning';
            const icon = type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : '‚ö†Ô∏è';
            
            results.innerHTML = `<div class="status ${statusClass}">
                <strong>${icon} Result:</strong> ${message}
            </div>`;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        interceptConsole();
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('üöÄ Page loaded, running automatic test...');
                testTelegramInit();
            }, 500);
        });
    </script>
</body>
</html>