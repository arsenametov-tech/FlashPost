<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìù Test Manual Input</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; background: linear-gradient(135deg, #0f0f14 0%, #1a1a2e 50%, #16213e 100%); color: #fff; font-family: Arial, sans-serif; }
        .container { padding: 20px; max-width: 800px; margin: 0 auto; }
        .test-card { background: rgba(255,255,255,0.1); border-radius: 12px; padding: 20px; margin: 20px 0; border: 1px solid rgba(255,255,255,0.2); backdrop-filter: blur(20px); }
        .btn { background: linear-gradient(45deg, #11998e, #38ef7d); color: white; border: none; padding: 15px 30px; border-radius: 8px; cursor: pointer; margin: 10px; font-size: 16px; font-weight: 600; transition: transform 0.2s; }
        .btn:hover { transform: translateY(-2px); }
        .textarea { width: 100%; background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.2); border-radius: 8px; padding: 15px; color: #fff; font-family: inherit; resize: vertical; min-height: 150px; }
        .result { background: #2a2a2a; border: 1px solid #444; border-radius: 8px; padding: 15px; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto; margin: 10px 0; }
        .slide-preview { background: rgba(0,0,0,0.3); border-radius: 8px; padding: 15px; margin: 10px 0; border-left: 4px solid #11998e; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìù Test Manual Input Feature</h1>
        <p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–∞–π–¥–æ–≤ –∏–∑ —Ä—É—á–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞</p>
        
        <div class="test-card">
            <h2>üìù –í–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞</h2>
            <textarea id="testInput" class="textarea" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç, —Ä–∞–∑–¥–µ–ª—è—è —Å–ª–∞–π–¥—ã –¥–≤–æ–π–Ω—ã–º –ø–µ—Ä–µ–Ω–æ—Å–æ–º —Å—Ç—Ä–æ–∫–∏...">–ó–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ
–û—Å–Ω–æ–≤—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –¥–ª—è –∑–¥–æ—Ä–æ–≤–æ–π –∂–∏–∑–Ω–∏

–ß—Ç–æ —Ç–∞–∫–æ–µ –∑–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ?
–ó–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ ‚Äî —ç—Ç–æ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞—Ü–∏–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–º –≤—Å–µ–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –ø–∏—Ç–∞—Ç–µ–ª—å–Ω—ã–º–∏ –≤–µ—â–µ—Å—Ç–≤–∞–º–∏

–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã
–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
–£–º–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –ø–æ—Ä—Ü–∏—è—Ö
–†–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç—å –ø—Ä–∏–µ–º–∞ –ø–∏—â–∏

–ü–æ–ª–µ–∑–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã
–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã ‚Äî –æ—Å–Ω–æ–≤–∞ —Ä–∞—Ü–∏–æ–Ω–∞
–¶–µ–ª—å–Ω–æ–∑–µ—Ä–Ω–æ–≤—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã
–ù–µ–∂–∏—Ä–Ω—ã–µ –±–µ–ª–∫–∏</textarea>
            
            <button class="btn" onclick="testManualInput()">üß™ –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–∞–π–¥–æ–≤</button>
            <button class="btn" onclick="openWorkingApp()">üì± –û—Ç–∫—Ä—ã—Ç—å —Ä–∞–±–æ—á–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
        </div>

        <div class="test-card">
            <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
            <div id="results" class="result">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å...</div>
        </div>

        <div class="test-card">
            <h2>üëÄ –ü—Ä–µ–≤—å—é —Å–ª–∞–π–¥–æ–≤</h2>
            <div id="slidesPreview"></div>
        </div>
    </div>

    <script>
        const slideColors = [
            'linear-gradient(135deg, #833ab4 0%, #fd1d1d 50%, #fcb045 100%)',
            'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
            'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
            'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
            'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',
            'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
            'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)'
        ];

        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const timestamp = new Date().toLocaleTimeString();
            const icon = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : '‚ÑπÔ∏è';
            results.innerHTML += `<div style="color: ${type === 'error' ? '#ff6b6b' : type === 'success' ? '#51cf66' : '#74c0fc'}">[${timestamp}] ${icon} ${message}</div>`;
            results.scrollTop = results.scrollHeight;
            console.log(message);
        }

        function generateSlidesFromText(text) {
            log('üìù –ù–∞—á–∏–Ω–∞–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ —Å–ª–∞–π–¥–æ–≤ –∏–∑ —Ç–µ–∫—Å—Ç–∞...', 'info');
            
            // –†–∞–∑–±–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –Ω–∞ –∞–±–∑–∞—Ü—ã –ø–æ –¥–≤–æ–π–Ω–æ–º—É –ø–µ—Ä–µ–Ω–æ—Å—É —Å—Ç—Ä–æ–∫–∏
            const paragraphs = text.split('\n\n')
                .map(p => p.trim())
                .filter(p => p.length > 0);
            
            log(`üìù –ù–∞–π–¥–µ–Ω–æ ${paragraphs.length} –∞–±–∑–∞—Ü–µ–≤`, 'info');
            
            if (paragraphs.length === 0) {
                throw new Error('–¢–µ–∫—Å—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–±–∑–∞—Ü–µ–≤');
            }
            
            // –°–æ–∑–¥–∞–µ–º —Å–ª–∞–π–¥—ã –∏–∑ –∞–±–∑–∞—Ü–µ–≤
            const slides = paragraphs.map((paragraph, index) => {
                const lines = paragraph.split('\n').filter(line => line.trim().length > 0);
                const title = lines[0] || `–°–ª–∞–π–¥ ${index + 1}`;
                const fullText = paragraph;
                
                log(`üìÑ –°–ª–∞–π–¥ ${index + 1}: "${title}"`, 'success');
                
                return {
                    id: `text_slide_${Date.now()}_${index}`,
                    title: title,
                    subtitle: lines.length > 1 ? lines.slice(1).join(' ') : '',
                    text: fullText,
                    color: slideColors[index % slideColors.length],
                    textBlocks: [{
                        id: `text_block_${Date.now()}_${index}`,
                        text: fullText,
                        x: 10,
                        y: 20,
                        width: 80,
                        font: 'Inter',
                        size: 16,
                        weight: 500,
                        color: '#ffffff',
                        textAlign: 'center'
                    }]
                };
            });
            
            // –ï—Å–ª–∏ —Å–ª–∞–π–¥–æ–≤ –º–µ–Ω—å—à–µ 5, –¥–æ–ø–æ–ª–Ω—è–µ–º —à–∞–±–ª–æ–Ω–Ω—ã–º–∏
            if (slides.length < 5) {
                log(`‚ö†Ô∏è –°–ª–∞–π–¥–æ–≤ –º–µ–Ω—å—à–µ 5 (${slides.length}), –¥–æ–ø–æ–ª–Ω—è–µ–º —à–∞–±–ª–æ–Ω–Ω—ã–º–∏`, 'info');
                
                const topic = slides[0]?.title || '–¢–µ–º–∞';
                const additionalTemplates = [
                    { title: '–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã', subtitle: '–ß—Ç–æ –≤–∞–∂–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å' },
                    { title: '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã', subtitle: '–ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ' },
                    { title: '–ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏', subtitle: '–ß–µ–≥–æ —Å—Ç–æ–∏—Ç –∏–∑–±–µ–≥–∞—Ç—å' },
                    { title: '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ', subtitle: '–ü–æ–¥–≤–æ–¥–∏–º –∏—Ç–æ–≥–∏' }
                ];
                
                const needed = 5 - slides.length;
                const startIndex = slides.length;
                
                for (let i = 0; i < needed && i < additionalTemplates.length; i++) {
                    const template = additionalTemplates[i];
                    const slideIndex = startIndex + i;
                    
                    log(`‚ûï –î–æ–±–∞–≤–ª—è–µ–º —à–∞–±–ª–æ–Ω–Ω—ã–π —Å–ª–∞–π–¥: "${template.title}"`, 'info');
                    
                    slides.push({
                        id: `template_slide_${Date.now()}_${slideIndex}`,
                        title: template.title,
                        subtitle: template.subtitle,
                        text: `${template.title}\n\n${template.subtitle}`,
                        color: slideColors[slideIndex % slideColors.length],
                        textBlocks: [{
                            id: `template_block_${Date.now()}_${slideIndex}`,
                            text: `${template.title}\n\n${template.subtitle}`,
                            x: 10,
                            y: 20,
                            width: 80,
                            font: 'Inter',
                            size: 16,
                            weight: 500,
                            color: '#ffffff',
                            textAlign: 'center'
                        }]
                    });
                }
                
                log(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ ${needed} —à–∞–±–ª–æ–Ω–Ω—ã—Ö —Å–ª–∞–π–¥–æ–≤`, 'success');
            }
            
            log(`üéØ –ò—Ç–æ–≥–æ —Å–æ–∑–¥–∞–Ω–æ ${slides.length} —Å–ª–∞–π–¥–æ–≤`, 'success');
            return slides;
        }

        function renderSlidesPreview(slides) {
            const preview = document.getElementById('slidesPreview');
            preview.innerHTML = '';
            
            slides.forEach((slide, index) => {
                const slideDiv = document.createElement('div');
                slideDiv.className = 'slide-preview';
                slideDiv.style.background = slide.color;
                slideDiv.innerHTML = `
                    <h3 style="margin-bottom: 10px; color: white;">–°–ª–∞–π–¥ ${index + 1}: ${slide.title}</h3>
                    <p style="color: rgba(255,255,255,0.9); white-space: pre-line; line-height: 1.5;">${slide.text}</p>
                    <small style="color: rgba(255,255,255,0.7); margin-top: 10px; display: block;">
                        ID: ${slide.id} | TextBlocks: ${slide.textBlocks.length}
                    </small>
                `;
                preview.appendChild(slideDiv);
            });
        }

        function testManualInput() {
            log('üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞...', 'info');
            
            const text = document.getElementById('testInput').value.trim();
            
            if (!text) {
                log('‚ùå –¢–µ–∫—Å—Ç –Ω–µ –≤–≤–µ–¥–µ–Ω', 'error');
                return;
            }
            
            try {
                const slides = generateSlidesFromText(text);
                
                log(`‚úÖ –¢–µ—Å—Ç —É—Å–ø–µ—à–µ–Ω! –°–æ–∑–¥–∞–Ω–æ ${slides.length} —Å–ª–∞–π–¥–æ–≤`, 'success');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–ª–∞–π–¥–æ–≤
                slides.forEach((slide, index) => {
                    if (!slide.id || !slide.title || !slide.textBlocks) {
                        log(`‚ùå –°–ª–∞–π–¥ ${index + 1} –∏–º–µ–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É`, 'error');
                    } else {
                        log(`‚úÖ –°–ª–∞–π–¥ ${index + 1} —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞`, 'success');
                    }
                });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–≤—å—é
                renderSlidesPreview(slides);
                
                log('üéØ –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞: ${error.message}`, 'error');
            }
        }

        function openWorkingApp() {
            log('üì± –û—Ç–∫—Ä—ã—Ç–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...', 'info');
            window.open('/working-app.html', '_blank');
        }

        // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞
        window.addEventListener('load', () => {
            log('üß™ Manual Input Test –∑–∞–≥—Ä—É–∂–µ–Ω', 'info');
            setTimeout(testManualInput, 1000);
        });
    </script>
</body>
</html>