<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ñ Test AI Optional Generation</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; background: #0f0f14; color: #fff; font-family: Arial, sans-serif; }
        .container { padding: 20px; max-width: 1200px; margin: 0 auto; }
        .test-section { background: rgba(255,255,255,0.1); border-radius: 12px; padding: 20px; margin: 20px 0; border: 1px solid rgba(255,255,255,0.2); }
        .status { padding: 15px; margin: 10px 0; border-radius: 8px; font-weight: bold; }
        .success { background: #1a5f1a; border: 2px solid #28a745; }
        .error { background: #5f1a1a; border: 2px solid #dc3545; }
        .warning { background: #5f4a1a; border: 2px solid #ffc107; }
        .info { background: #1a3a5f; border: 2px solid #007bff; }
        .btn { background: linear-gradient(45deg, #833ab4, #fd1d1d); color: white; border: none; padding: 15px 30px; border-radius: 8px; cursor: pointer; margin: 10px; font-size: 16px; font-weight: 600; transition: transform 0.2s; }
        .btn:hover { transform: translateY(-2px); }
        .btn-ai { background: linear-gradient(45deg, #667eea, #764ba2); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .log { background: #2a2a2a; border: 1px solid #444; border-radius: 8px; padding: 15px; font-family: 'Courier New', monospace; font-size: 12px; max-height: 400px; overflow-y: auto; margin: 10px 0; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .test-item { background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); }
        .test-result { font-weight: bold; margin-top: 10px; }
        .input-group { margin: 15px 0; }
        .input-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .input-group input, .input-group textarea { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #444; background: #2a2a2a; color: #fff; }
        .generation-buttons { display: flex; gap: 10px; margin-top: 15px; }
        .generation-buttons .btn { flex: 1; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ü§ñ Test AI Optional Generation</h1>
        <p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä—É—á–Ω–æ–π –∏ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞–∫ –æ–ø—Ü–∏–π</p>
        
        <div id="overallStatus" class="status info">üîÑ –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é...</div>
        
        <div class="test-section">
            <h2>üöÄ –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
            <button class="btn" onclick="testBothGenerations()">üîç –¢–µ—Å—Ç –æ–±–µ–∏—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π</button>
            <button class="btn" onclick="openMainApp()">üì± –û—Ç–∫—Ä—ã—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
            <button class="btn" onclick="testAIAvailability()">ü§ñ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å AI</button>
        </div>

        <div class="test-section">
            <h2>üìù –¢–µ—Å—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</h2>
            
            <div class="input-group">
                <label for="testTopic">–¢–µ–º–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</label>
                <input type="text" id="testTopic" value="–ó–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–º—É...">
            </div>
            
            <div class="generation-buttons">
                <button class="btn" id="testManualBtn" onclick="testManualGeneration()">üéØ –¢–µ—Å—Ç —Ä—É—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</button>
                <button class="btn btn-ai" id="testAIBtn" onclick="testAIGeneration()">ü§ñ –¢–µ—Å—Ç AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</button>
            </div>
            
            <div id="generationResults" class="test-result"></div>
        </div>

        <div class="grid">
            <div class="test-item">
                <h3>üéØ –†—É—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è</h3>
                <div id="manualStatus">–ù–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ</div>
                <div id="manualResults" class="test-result"></div>
            </div>
            
            <div class="test-item">
                <h3>ü§ñ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è</h3>
                <div id="aiStatus">–ù–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ</div>
                <div id="aiResults" class="test-result"></div>
            </div>
            
            <div class="test-item">
                <h3>üîÑ Fallback —Å–∏—Å—Ç–µ–º–∞</h3>
                <div id="fallbackStatus">–ù–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ</div>
                <div id="fallbackResults" class="test-result"></div>
            </div>
            
            <div class="test-item">
                <h3>üé® UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è</h3>
                <div id="uiStatus">–ù–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ</div>
                <div id="uiResults" class="test-result"></div>
            </div>
        </div>

        <div class="test-section">
            <h2>üìã –õ–æ–≥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
            <div id="testLog" class="log">–õ–æ–≥ –±—É–¥–µ—Ç –∑–¥–µ—Å—å...</div>
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –º–æ–¥—É–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <script src="src/state.js"></script>
    <script src="src/renderer.js"></script>
    <script src="src/editor.js"></script>
    <script src="src/drag.js"></script>
    <script src="src/export.js"></script>
    <script src="src/ai.js"></script>
    <script src="src/template-manager.js"></script>
    <script src="src/app.js"></script>

    <script>
        let logElement;
        let testApp;
        
        function log(message, type = 'info') {
            if (!logElement) logElement = document.getElementById('testLog');
            const timestamp = new Date().toLocaleTimeString();
            const icon = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
            logElement.innerHTML += `<div style="color: ${type === 'error' ? '#ff6b6b' : type === 'success' ? '#51cf66' : type === 'warning' ? '#ffd43b' : '#74c0fc'}">[${timestamp}] ${icon} ${message}</div>`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }

        function updateStatus(elementId, message, type) {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = message;
                element.className = `status ${type}`;
            }
        }

        function updateTestResult(elementId, message, success) {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = success ? `‚úÖ ${message}` : `‚ùå ${message}`;
                element.style.color = success ? '#51cf66' : '#ff6b6b';
            }
        }

        async function initTestApp() {
            try {
                log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...', 'info');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–æ–≤
                if (typeof FlashPostApp === 'undefined') {
                    throw new Error('FlashPostApp –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }
                
                // –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                testApp = new FlashPostApp();
                
                // –ñ–¥–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                log('‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ', 'success');
                return true;
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: ${error.message}`, 'error');
                return false;
            }
        }

        async function testAIAvailability() {
            log('ü§ñ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ AI...', 'info');
            
            try {
                if (!testApp) {
                    await initTestApp();
                }
                
                const aiAvailable = testApp.aiManager && testApp.aiManager.isAvailable();
                
                if (aiAvailable) {
                    log('‚úÖ AI –¥–æ—Å—Ç—É–ø–µ–Ω', 'success');
                    updateTestResult('aiResults', 'AI –º–æ–¥—É–ª—å –¥–æ—Å—Ç—É–ø–µ–Ω', true);
                    document.getElementById('testAIBtn').disabled = false;
                } else {
                    log('‚ö†Ô∏è AI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)', 'warning');
                    updateTestResult('aiResults', 'AI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω fallback', true);
                    document.getElementById('testAIBtn').disabled = true;
                }
                
                return aiAvailable;
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ AI: ${error.message}`, 'error');
                updateTestResult('aiResults', '–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ AI', false);
                return false;
            }
        }

        async function testManualGeneration() {
            log('üéØ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä—É—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏...', 'info');
            updateStatus('manualStatus', 'üîÑ –¢–µ—Å—Ç–∏—Ä—É–µ–º...', 'info');
            
            try {
                if (!testApp) {
                    await initTestApp();
                }
                
                const topic = document.getElementById('testTopic').value.trim();
                if (!topic) {
                    throw new Error('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–º—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è');
                }
                
                // –¢–µ—Å—Ç–∏—Ä—É–µ–º –º–µ—Ç–æ–¥ —Ä—É—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
                const slides = testApp.generateManualSlides(topic);
                
                if (slides && slides.length > 0) {
                    log(`‚úÖ –†—É—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è: —Å–æ–∑–¥–∞–Ω–æ ${slides.length} —Å–ª–∞–π–¥–æ–≤`, 'success');
                    updateStatus('manualStatus', '‚úÖ –†—É—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                    updateTestResult('manualResults', `${slides.length} —Å–ª–∞–π–¥–æ–≤ —Å–æ–∑–¥–∞–Ω–æ`, true);
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–ª–∞–π–¥–æ–≤
                    const firstSlide = slides[0];
                    if (firstSlide.title && firstSlide.textBlocks) {
                        log('‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ª–∞–π–¥–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞', 'success');
                    } else {
                        log('‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —Å–ª–∞–π–¥–æ–≤', 'warning');
                    }
                    
                    return true;
                } else {
                    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Å–ª–∞–π–¥—ã');
                }
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ —Ä—É—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: ${error.message}`, 'error');
                updateStatus('manualStatus', '‚ùå –û—à–∏–±–∫–∞ —Ä—É—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏', 'error');
                updateTestResult('manualResults', '–†—É—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç', false);
                return false;
            }
        }

        async function testAIGeneration() {
            log('ü§ñ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏...', 'info');
            updateStatus('aiStatus', 'üîÑ –¢–µ—Å—Ç–∏—Ä—É–µ–º...', 'info');
            
            try {
                if (!testApp) {
                    await initTestApp();
                }
                
                const topic = document.getElementById('testTopic').value.trim();
                if (!topic) {
                    throw new Error('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–º—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è');
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å AI
                const aiAvailable = testApp.aiManager && testApp.aiManager.isAvailable();
                
                if (!aiAvailable) {
                    log('‚ÑπÔ∏è AI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Ç–µ—Å—Ç–∏—Ä—É–µ–º fallback –Ω–∞ —Ä—É—á–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é', 'info');
                    
                    // –¢–µ—Å—Ç–∏—Ä—É–µ–º fallback –ª–æ–≥–∏–∫—É
                    const manualResult = await testManualGeneration();
                    
                    if (manualResult) {
                        log('‚úÖ Fallback –Ω–∞ —Ä—É—á–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                        updateStatus('aiStatus', '‚úÖ Fallback —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                        updateTestResult('aiResults', 'Fallback –Ω–∞ —Ä—É—á–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é', true);
                        updateTestResult('fallbackResults', 'Fallback —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç', true);
                    } else {
                        throw new Error('Fallback –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç');
                    }
                    
                    return true;
                }
                
                // –ï—Å–ª–∏ AI –¥–æ—Å—Ç—É–ø–µ–Ω, —Ç–µ—Å—Ç–∏—Ä—É–µ–º –µ–≥–æ
                try {
                    const aiResult = await testApp.aiManager.generateCarousel(topic);
                    
                    if (aiResult && aiResult.slides && aiResult.slides.length > 0) {
                        log(`‚úÖ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è: —Å–æ–∑–¥–∞–Ω–æ ${aiResult.slides.length} —Å–ª–∞–π–¥–æ–≤`, 'success');
                        updateStatus('aiStatus', '‚úÖ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                        updateTestResult('aiResults', `AI: ${aiResult.slides.length} —Å–ª–∞–π–¥–æ–≤`, true);
                        
                        if (aiResult.autoKeywords && aiResult.autoKeywords.length > 0) {
                            log(`‚úÖ AI –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: ${aiResult.autoKeywords.length} —Å–ª–æ–≤`, 'success');
                        }
                        
                        return true;
                    } else {
                        throw new Error('AI –Ω–µ –≤–µ—Ä–Ω—É–ª —Å–ª–∞–π–¥—ã');
                    }
                    
                } catch (aiError) {
                    log(`‚ö†Ô∏è AI –æ—à–∏–±–∫–∞, —Ç–µ—Å—Ç–∏—Ä—É–µ–º fallback: ${aiError.message}`, 'warning');
                    
                    // –¢–µ—Å—Ç–∏—Ä—É–µ–º fallback
                    const fallbackResult = await testManualGeneration();
                    
                    if (fallbackResult) {
                        log('‚úÖ Fallback –ø–æ—Å–ª–µ AI –æ—à–∏–±–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                        updateStatus('aiStatus', '‚úÖ Fallback –ø–æ—Å–ª–µ AI –æ—à–∏–±–∫–∏', 'success');
                        updateTestResult('fallbackResults', 'Fallback –ø–æ—Å–ª–µ AI –æ—à–∏–±–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç', true);
                        return true;
                    } else {
                        throw new Error('Fallback –ø–æ—Å–ª–µ AI –æ—à–∏–±–∫–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç');
                    }
                }
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: ${error.message}`, 'error');
                updateStatus('aiStatus', '‚ùå –û—à–∏–±–∫–∞ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏', 'error');
                updateTestResult('aiResults', 'AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç', false);
                return false;
            }
        }

        async function testBothGenerations() {
            log('üîç –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π...', 'info');
            updateStatus('overallStatus', 'üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...', 'info');
            
            const results = {
                manual: await testManualGeneration(),
                ai: await testAIGeneration(),
                aiAvailability: await testAIAvailability()
            };
            
            // –¢–µ—Å—Ç–∏—Ä—É–µ–º UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
            await testUIIntegration();
            
            const allPassed = results.manual && results.ai;
            
            if (allPassed) {
                log('‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!', 'success');
                updateStatus('overallStatus', '‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã', 'success');
            } else {
                log('‚ö†Ô∏è –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ—à–ª–∏', 'warning');
                updateStatus('overallStatus', '‚ö†Ô∏è –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã', 'warning');
            }
            
            return results;
        }

        async function testUIIntegration() {
            log('üé® –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏...', 'info');
            updateStatus('uiStatus', 'üîÑ –¢–µ—Å—Ç–∏—Ä—É–µ–º...', 'info');
            
            try {
                if (!testApp) {
                    await initTestApp();
                }
                
                // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
                testApp.state.setMode('start');
                testApp.renderer.render();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–æ–∫
                setTimeout(() => {
                    const manualBtn = document.getElementById('generateBtn');
                    const aiBtn = document.getElementById('generateAIBtn');
                    
                    let uiChecks = 0;
                    let totalChecks = 3;
                    
                    if (manualBtn) {
                        log('‚úÖ –ö–Ω–æ–ø–∫–∞ —Ä—É—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–∞–π–¥–µ–Ω–∞', 'success');
                        uiChecks++;
                    } else {
                        log('‚ùå –ö–Ω–æ–ø–∫–∞ —Ä—É—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', 'error');
                    }
                    
                    if (aiBtn) {
                        log('‚úÖ –ö–Ω–æ–ø–∫–∞ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–∞–π–¥–µ–Ω–∞', 'success');
                        uiChecks++;
                    } else {
                        log('‚ùå –ö–Ω–æ–ø–∫–∞ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', 'error');
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ AI –∫–Ω–æ–ø–∫–∏
                    if (aiBtn) {
                        const aiAvailable = testApp.aiManager && testApp.aiManager.isAvailable();
                        if (!aiAvailable && aiBtn.disabled) {
                            log('‚úÖ AI –∫–Ω–æ–ø–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–∞', 'success');
                            uiChecks++;
                        } else if (aiAvailable && !aiBtn.disabled) {
                            log('‚úÖ AI –∫–Ω–æ–ø–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–∫–ª—é—á–µ–Ω–∞', 'success');
                            uiChecks++;
                        } else {
                            log('‚ö†Ô∏è –°–æ—Å—Ç–æ—è–Ω–∏–µ AI –∫–Ω–æ–ø–∫–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', 'warning');
                        }
                    }
                    
                    const uiSuccess = uiChecks >= 2;
                    updateStatus('uiStatus', uiSuccess ? '‚úÖ UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç' : '‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å UI', uiSuccess ? 'success' : 'error');
                    updateTestResult('uiResults', `${uiChecks}/${totalChecks} UI –ø—Ä–æ–≤–µ—Ä–æ–∫`, uiSuccess);
                    
                }, 1000);
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏: ${error.message}`, 'error');
                updateStatus('uiStatus', '‚ùå –û—à–∏–±–∫–∞ UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏', 'error');
                updateTestResult('uiResults', 'UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç', false);
            }
        }

        function openMainApp() {
            log('üì± –û—Ç–∫—Ä—ã—Ç–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...', 'info');
            window.open('/index.html', '_blank');
        }

        // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
        window.addEventListener('load', () => {
            log('üß™ AI Optional Test –∑–∞–≥—Ä—É–∂–µ–Ω', 'info');
            setTimeout(() => {
                testBothGenerations();
            }, 1000);
        });
    </script>
</body>
</html>