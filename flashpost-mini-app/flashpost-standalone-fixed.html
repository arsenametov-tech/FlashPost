<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlashPost - Standalone Fixed</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            max-width: 600px;
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            text-align: center;
        }
        
        h1 {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            font-size: 16px;
            opacity: 0.8;
            margin-bottom: 30px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        input {
            width: 100%;
            padding: 15px 20px;
            border: none;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 16px;
            margin-bottom: 15px;
        }
        
        input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .btn {
            background: linear-gradient(135deg, #fd79a8 0%, #e84393 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
            min-width: 150px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-weight: 500;
        }
        
        .status.success {
            background: rgba(0, 184, 148, 0.2);
            border: 1px solid #00b894;
        }
        
        .status.error {
            background: rgba(214, 48, 49, 0.2);
            border: 1px solid #d63031;
        }
        
        .status.info {
            background: rgba(116, 185, 255, 0.2);
            border: 1px solid #74b9ff;
        }
        
        .carousel-preview {
            margin-top: 30px;
            text-align: left;
        }
        
        .slide-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #fd79a8;
        }
        
        .slide-title {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 8px;
            color: #fd79a8;
        }
        
        .slide-content {
            line-height: 1.4;
            white-space: pre-line;
            font-size: 14px;
        }
        
        .slide-meta {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 5px;
        }
        
        .loading {
            display: none;
            margin: 20px 0;
        }
        
        .loading.active {
            display: block;
        }
        
        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid #fd79a8;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ FlashPost</h1>
        <p class="subtitle">–°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—É—Å–µ–ª–µ–π —Å Advanced AI Pipeline</p>
        
        <div class="input-group">
            <input type="text" id="topicInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–º—É –∫–∞—Ä—É—Å–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ –≤ Instagram')" />
            <input type="text" id="instagramInput" placeholder="Instagram –Ω–∏–∫–Ω–µ–π–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" />
        </div>
        
        <button class="btn" id="generateBtn">üìù –†—É—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è</button>
        <button class="btn" id="aiBtn">ü§ñ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è</button>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p id="loadingText">–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–∞—Ä—É—Å–µ–ª—å...</p>
        </div>
        
        <div id="status"></div>
        <div id="carouselPreview" class="carousel-preview"></div>
    </div>

    <script>
        // ===== –í–°–¢–†–û–ï–ù–ù–´–ô STATE MANAGER =====
        class StateManager {
            constructor() {
                this.state = {
                    mode: 'start',
                    currentSlideIndex: 0,
                    slides: [],
                    instagramNickname: '',
                    ctaText: '–ü–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ @username',
                    isGenerating: false
                };
                console.log('‚úÖ StateManager –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            }
            
            getMode() { return this.state.mode; }
            setMode(mode) { this.state.mode = mode; }
            
            getSlides() { return this.state.slides; }
            clearProject() { this.state.slides = []; }
            
            createSlide(slideData) {
                const slide = {
                    id: this.state.slides.length + 1,
                    ...slideData
                };
                this.state.slides.push(slide);
                return slide;
            }
            
            setCurrentSlideIndex(index) { this.state.currentSlideIndex = index; }
            getCurrentSlideIndex() { return this.state.currentSlideIndex; }
            
            setInstagramNickname(nickname) { this.state.instagramNickname = nickname; }
            getInstagramNickname() { return this.state.instagramNickname; }
            
            setCTAText(text) { this.state.ctaText = text; }
            getCTAText() { return this.state.ctaText; }
        }

        // ===== –í–°–¢–†–û–ï–ù–ù–´–ô AI MANAGER =====
        class AIManager {
            constructor(stateManager) {
                this.state = stateManager;
                console.log('‚úÖ AIManager –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            }
            
            isAvailable() { return true; }
            
            // ADVANCED AI PIPELINE
            async generateProModeCarousel(topic) {
                console.log('üöÄ ADVANCED AI: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PRO MODE –∫–∞—Ä—É—Å–µ–ª–∏ –¥–ª—è —Ç–µ–º—ã:', topic);
                
                try {
                    // –≠–¢–ê–ü A: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è outline
                    const outline = await this.generateCarouselOutline(topic);
                    
                    // –≠–¢–ê–ü B: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                    const content = await this.generateCarouselContent(topic, outline);
                    
                    // –≠–¢–ê–ü C: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —Å–ª–∞–π–¥—ã
                    const slides = await this.convertToProModeSlides(content);
                    
                    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ state
                    this.state.clearProject();
                    slides.forEach(slideData => {
                        this.state.createSlide(slideData);
                    });
                    
                    if (slides.length > 0) {
                        this.state.setCurrentSlideIndex(0);
                    }
                    
                    console.log(`‚úÖ ADVANCED AI: –°–æ–∑–¥–∞–Ω–æ ${slides.length} —Å–ª–∞–π–¥–æ–≤`);
                    
                    return {
                        slides: slides,
                        topic: topic,
                        generatedBy: 'AI-Advanced-Pipeline',
                        timestamp: Date.now(),
                        outline: outline
                    };
                    
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ Advanced AI Pipeline:', error);
                    throw error;
                }
            }
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è outline (8-11 —Å–ª–∞–π–¥–æ–≤)
            async generateCarouselOutline(topic) {
                console.log('üìã ADVANCED AI: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è outline –¥–ª—è —Ç–µ–º—ã:', topic);
                
                const slideCount = Math.floor(Math.random() * 4) + 8; // 8-11 —Å–ª–∞–π–¥–æ–≤
                
                const slideTypes = [
                    { type: "hook", required: true },
                    { type: "context", required: true },
                    { type: "problem", required: true },
                    { type: "solution", required: true },
                    { type: "benefits", required: true },
                    { type: "proof", required: true },
                    { type: "action", required: true },
                    { type: "cta", required: true },
                    { type: "agitation", required: false },
                    { type: "objections", required: false },
                    { type: "bonus", required: false }
                ];
                
                let selectedSlides = slideTypes.filter(s => s.required);
                const remainingSlots = slideCount - selectedSlides.length;
                
                if (remainingSlots > 0) {
                    const optionalSlides = slideTypes
                        .filter(s => !s.required)
                        .slice(0, remainingSlots);
                    selectedSlides = [...selectedSlides, ...optionalSlides];
                }
                
                const outline = {
                    topic: topic,
                    totalSlides: selectedSlides.length,
                    structure: selectedSlides.map(s => s.type).join(' ‚Üí '),
                    targetAudience: this.analyzeTargetAudience(topic),
                    outline: selectedSlides.map((slideType, index) => ({
                        slideNumber: index + 1,
                        type: slideType.type,
                        mainIdea: `${slideType.type} –¥–ª—è ${topic}`,
                        purpose: `–¶–µ–ª—å —Å–ª–∞–π–¥–∞ ${slideType.type}`,
                        emotionalTone: this.getEmotionalTone(slideType.type)
                    }))
                };
                
                console.log('‚úÖ ADVANCED OUTLINE —Å–æ–∑–¥–∞–Ω:', outline.outline.length, '—Å–ª–∞–π–¥–æ–≤');
                return outline;
            }
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            async generateCarouselContent(topic, outline) {
                console.log('‚úçÔ∏è ADVANCED AI: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ outline...');
                
                const content = {
                    topic: topic,
                    slides: outline.outline.map(outlineSlide => {
                        const slideContent = this.generateSlideContent(outlineSlide.type, topic);
                        
                        return {
                            slideNumber: outlineSlide.slideNumber,
                            type: outlineSlide.type,
                            title: slideContent.title,
                            text: slideContent.text,
                            keywordType: slideContent.keywordType,
                            emotionalTone: outlineSlide.emotionalTone
                        };
                    })
                };
                
                console.log('‚úÖ ADVANCED CONTENT —Å–æ–∑–¥–∞–Ω:', content.slides.length, '—Å–ª–∞–π–¥–æ–≤');
                return content;
            }
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Å–ª–∞–π–¥–∞
            generateSlideContent(slideType, topic) {
                const templates = {
                    hook: {
                        title: `${topic}`,
                        text: `–ó–Ω–∞–ª–∏ –ª–∏ –≤—ã, —á—Ç–æ ${topic.toLowerCase()} –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –∂–∏–∑–Ω—å –∑–∞ 30 –¥–Ω–µ–π?\n\n–ë–æ–ª–µ–µ 80% –ª—é–¥–µ–π –Ω–µ –∑–Ω–∞—é—Ç —ç—Ç–æ–≥–æ —Å–µ–∫—Ä–µ—Ç–∞\n–ê —Ç–µ, –∫—Ç–æ –∑–Ω–∞—é—Ç ‚Äî —É–∂–µ –ø–æ–ª—É—á–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã\n–£–∑–Ω–∞–π—Ç–µ –ø—Ä–∞–≤–¥—É –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å`,
                        keywordType: 'emotional'
                    },
                    context: {
                        title: '–°–∏—Ç—É–∞—Ü–∏—è',
                        text: `–í 2024 –≥–æ–¥—É ${topic.toLowerCase()} —Å—Ç–∞–ª –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–º\n\n–ë–æ–ª–µ–µ 70% —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ\n–û—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–µ—Ä—è—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å\n–í—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å ‚Äî —Å–µ–π—á–∞—Å`,
                        keywordType: 'conceptual'
                    },
                    problem: {
                        title: '–ü—Ä–æ–±–ª–µ–º–∞',
                        text: `95% –ª—é–¥–µ–π —Å–æ–≤–µ—Ä—à–∞—é—Ç –æ–¥–Ω—É –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É\n\n–û–Ω–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç –≤–∞–∂–Ω–æ—Å—Ç—å ${topic.toLowerCase()}\n–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–æ—Ç–µ—Ä–µ –≤—Ä–µ–º–µ–Ω–∏ –∏ —Ä–µ—Å—É—Ä—Å–æ–≤\n–ê —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ—â–µ, —á–µ–º –∫–∞–∂–µ—Ç—Å—è`,
                        keywordType: 'conceptual'
                    },
                    agitation: {
                        title: '–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è',
                        text: `–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –±–µ–∑ ${topic.toLowerCase()} ‚Äî —ç—Ç–æ –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏\n\n–í–∞—à–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ\n–û–Ω–∏ –ø–æ–ª—É—á–∞—é—Ç –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã\n–ê –≤—ã –æ—Å—Ç–∞–µ—Ç–µ—Å—å –ø–æ–∑–∞–¥–∏`,
                        keywordType: 'emotional'
                    },
                    solution: {
                        title: '–†–µ—à–µ–Ω–∏–µ',
                        text: `${topic} ‚Äî —ç—Ç–æ –≤–∞—à –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É\n\n–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç\n–¢—ã—Å—è—á–∏ –ª—é–¥–µ–π —É–∂–µ –ø–æ–ª—É—á–∏–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã\n–¢–µ–ø–µ—Ä—å –≤–∞—à–∞ –æ—á–µ—Ä–µ–¥—å`,
                        keywordType: 'conceptual'
                    },
                    benefits: {
                        title: '–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞',
                        text: `–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π ${topic.toLowerCase()} –¥–∞–µ—Ç:\n\n‚Ä¢ –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ 300%\n‚Ä¢ –≠–∫–æ–Ω–æ–º–∏—é –≤—Ä–µ–º–µ–Ω–∏ –≤ 5 —Ä–∞–∑\n‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–æ—Å—Ç –¥–æ—Ö–æ–¥–æ–≤\n‚Ä¢ –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –∑–∞–≤—Ç—Ä–∞—à–Ω–µ–º –¥–Ω–µ`,
                        keywordType: 'conceptual'
                    },
                    proof: {
                        title: '–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞',
                        text: `–†–µ–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç ${topic.toLowerCase()}:\n\n‚Ä¢ –ö–æ–º–ø–∞–Ω–∏—è –ê: +250% —Ä–æ—Å—Ç–∞ –∑–∞ –≥–æ–¥\n‚Ä¢ –≠–∫—Å–ø–µ—Ä—Ç –ë: –¥–æ—Ö–æ–¥ –≤—ã—Ä–æ—Å –≤ 4 —Ä–∞–∑–∞\n‚Ä¢ –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ: 89% —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–æ–≤–æ–ª—å–Ω—ã`,
                        keywordType: 'conceptual'
                    },
                    objections: {
                        title: '–°–æ–º–Ω–µ–Ω–∏—è?',
                        text: `"${topic} —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ" ‚Äî —ç—Ç–æ –º–∏—Ñ\n\n–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –≤—Å—ë –ø—Ä–æ—â–µ, —á–µ–º –∫–∞–∂–µ—Ç—Å—è\n–ù—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –∑–Ω–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥\n–¢—ã—Å—è—á–∏ –ª—é–¥–µ–π —É–∂–µ —É–±–µ–¥–∏–ª–∏—Å—å –≤ —ç—Ç–æ–º`,
                        keywordType: 'conceptual'
                    },
                    action: {
                        title: '–î–µ–π—Å—Ç–≤–∏–µ',
                        text: `–ö–∞–∫ –Ω–∞—á–∞—Ç—å —Å ${topic.toLowerCase()} —É–∂–µ —Å–µ–≥–æ–¥–Ω—è:\n\n1Ô∏è‚É£ –ò–∑—É—á–∏—Ç–µ –æ—Å–Ω–æ–≤—ã (30 –º–∏–Ω—É—Ç)\n2Ô∏è‚É£ –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –º–µ—Ç–æ–¥\n3Ô∏è‚É£ –°–¥–µ–ª–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π —à–∞–≥\n4Ô∏è‚É£ –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã`,
                        keywordType: 'conceptual'
                    },
                    bonus: {
                        title: '–ë–æ–Ω—É—Å',
                        text: `–°–∫—Ä—ã—Ç—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ ${topic.toLowerCase()}:\n\nüéÅ –£–ª—É—á—à–µ–Ω–∏–µ –¥—Ä—É–≥–∏—Ö —Å—Ñ–µ—Ä –∂–∏–∑–Ω–∏\nüéÅ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏ —Å–≤—è–∑–∏\nüéÅ –ü–æ–≤—ã—à–µ–Ω–∏–µ —Å–∞–º–æ–æ—Ü–µ–Ω–∫–∏\nüéÅ –í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ –¥–ª—è –æ–∫—Ä—É–∂–∞—é—â–∏—Ö`,
                        keywordType: 'emotional'
                    },
                    cta: {
                        title: '–î–µ–π—Å—Ç–≤—É–π—Ç–µ!',
                        text: `–ì–æ—Ç–æ–≤—ã –∏–∑–º–µ–Ω–∏—Ç—å –∂–∏–∑–Ω—å —Å ${topic.toLowerCase()}?\n\nüëç –õ–∞–π–∫, –µ—Å–ª–∏ –º–∞—Ç–µ—Ä–∏–∞–ª –ø–æ–ª–µ–∑–µ–Ω\nüí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –≤–∞—à–∏–º –æ–ø—ã—Ç–æ–º\nüì§ –†–µ–ø–æ—Å—Ç –¥—Ä—É–∑—å—è–º\nüîî –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è`,
                        keywordType: 'emotional'
                    }
                };
                
                return templates[slideType] || templates.hook;
            }
            
            // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —Å–ª–∞–π–¥—ã
            async convertToProModeSlides(content) {
                console.log('üîÑ ADVANCED AI: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —Å–ª–∞–π–¥—ã...');
                
                const gradients = [
                    'linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)',
                    'linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)',
                    'linear-gradient(135deg, #a55eea 0%, #8b5cf6 100%)',
                    'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',
                    'linear-gradient(135deg, #fd79a8 0%, #e84393 100%)',
                    'linear-gradient(135deg, #fdcb6e 0%, #e17055 100%)',
                    'linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%)',
                    'linear-gradient(135deg, #55efc4 0%, #00b894 100%)',
                    'linear-gradient(135deg, #ff7675 0%, #d63031 100%)',
                    'linear-gradient(135deg, #81ecec 0%, #74b9ff 100%)',
                    'linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%)'
                ];
                
                const slides = content.slides.map((slide, index) => ({
                    id: index + 1,
                    background: {
                        type: 'gradient',
                        color: gradients[index % gradients.length]
                    },
                    textBlocks: [
                        {
                            id: `slide_${index + 1}_title`,
                            text: slide.title,
                            x: 50, y: 20, width: 85, height: 15,
                            font: 'Inter', size: 22, weight: 'bold',
                            color: '#ffffff', textAlign: 'center'
                        },
                        {
                            id: `slide_${index + 1}_content`,
                            text: slide.text,
                            x: 50, y: 55, width: 88, height: 55,
                            font: 'Inter', size: 17, weight: 'normal',
                            color: '#ffffff', textAlign: 'center'
                        }
                    ],
                    slideType: slide.type,
                    keywordType: slide.keywordType,
                    emotionalTone: slide.emotionalTone,
                    metadata: {
                        generatedBy: 'AI-Advanced-Pipeline',
                        slideNumber: slide.slideNumber
                    }
                }));
                
                console.log(`‚úÖ ADVANCED AI: –°–æ–∑–¥–∞–Ω–æ ${slides.length} —Å–ª–∞–π–¥–æ–≤`);
                return slides;
            }
            
            // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
            analyzeTargetAudience(topic) {
                const audienceMap = {
                    '–º–∞—Ä–∫–µ—Ç–∏–Ω–≥': '–º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥–∏ –∏ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–∏',
                    '–±–∏–∑–Ω–µ—Å': '–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–∏ –∏ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–∏',
                    '–∑–¥–æ—Ä–æ–≤—å–µ': '–ª—é–¥–∏, –∑–∞–±–æ—Ç—è—â–∏–µ—Å—è –æ –∑–¥–æ—Ä–æ–≤—å–µ',
                    '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': '—Å—Ç—É–¥–µ–Ω—Ç—ã –∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏',
                    '—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏': 'IT-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã',
                    '—Ñ–∏–Ω–∞–Ω—Å—ã': '–∏–Ω–≤–µ—Å—Ç–æ—Ä—ã –∏ —Ç—Ä–µ–π–¥–µ—Ä—ã'
                };
                
                const topicLower = topic.toLowerCase();
                for (const [key, audience] of Object.entries(audienceMap)) {
                    if (topicLower.includes(key)) {
                        return audience;
                    }
                }
                return '—à–∏—Ä–æ–∫–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è';
            }
            
            getEmotionalTone(slideType) {
                const tones = {
                    hook: '—É–¥–∏–≤–ª–µ–Ω–∏–µ',
                    context: '–ø–æ–Ω–∏–º–∞–Ω–∏–µ',
                    problem: '–±–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ',
                    agitation: '—Ç—Ä–µ–≤–æ–≥–∞',
                    solution: '–Ω–∞–¥–µ–∂–¥–∞',
                    benefits: '–≤–æ–æ–¥—É—à–µ–≤–ª–µ–Ω–∏–µ',
                    proof: '–¥–æ–≤–µ—Ä–∏–µ',
                    objections: '—É–±–µ–∂–¥–µ–Ω–∏–µ',
                    action: '–º–æ—Ç–∏–≤–∞—Ü–∏—è',
                    bonus: '–ø—Ä–∏—è—Ç–Ω–æ–µ —É–¥–∏–≤–ª–µ–Ω–∏–µ',
                    cta: '—Ä–µ—à–∏–º–æ—Å—Ç—å'
                };
                return tones[slideType] || '–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π';
            }
            
            // –†—É—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
            generateManualCarousel(topic) {
                console.log('üìù –†—É—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—É—Å–µ–ª–∏ –¥–ª—è —Ç–µ–º—ã:', topic);
                
                const manualSlides = [
                    {
                        background: { type: 'gradient', color: 'linear-gradient(135deg, #833ab4 0%, #fd1d1d 100%)' },
                        textBlocks: [{
                            text: `${topic}\n\n–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ\n–í—Å–µ —á—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å`,
                            x: 50, y: 50, width: 80, height: 'auto',
                            font: 'Inter', size: 18, weight: 600, color: '#ffffff', textAlign: 'center'
                        }]
                    },
                    {
                        background: { type: 'gradient', color: 'linear-gradient(135deg, #fd1d1d 0%, #fcb045 100%)' },
                        textBlocks: [{
                            text: `–û—Å–Ω–æ–≤—ã ${topic.toLowerCase()}\n\n–ß—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å\n–° —á–µ–≥–æ –Ω–∞—á–∞—Ç—å`,
                            x: 50, y: 50, width: 80, height: 'auto',
                            font: 'Inter', size: 18, weight: 600, color: '#ffffff', textAlign: 'center'
                        }]
                    },
                    {
                        background: { type: 'gradient', color: 'linear-gradient(135deg, #fcb045 0%, #f77737 100%)' },
                        textBlocks: [{
                            text: `–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ ${topic.toLowerCase()}\n\n–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —à–∞–≥–∏\n–†–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã`,
                            x: 50, y: 50, width: 80, height: 'auto',
                            font: 'Inter', size: 18, weight: 600, color: '#ffffff', textAlign: 'center'
                        }]
                    },
                    {
                        background: { type: 'gradient', color: 'linear-gradient(135deg, #f77737 0%, #e1306c 100%)' },
                        textBlocks: [{
                            text: `–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç ${topic.toLowerCase()}\n\n–ß–µ–≥–æ –æ–∂–∏–¥–∞—Ç—å\n–ö–∞–∫ –∏–∑–º–µ—Ä–∏—Ç—å —É—Å–ø–µ—Ö`,
                            x: 50, y: 50, width: 80, height: 'auto',
                            font: 'Inter', size: 18, weight: 600, color: '#ffffff', textAlign: 'center'
                        }]
                    },
                    {
                        background: { type: 'gradient', color: 'linear-gradient(135deg, #e1306c 0%, #833ab4 100%)' },
                        textBlocks: [{
                            text: `–í—ã–≤–æ–¥—ã –æ ${topic.toLowerCase()}\n\n–ì–ª–∞–≤–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã\n–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏`,
                            x: 50, y: 50, width: 80, height: 'auto',
                            font: 'Inter', size: 18, weight: 600, color: '#ffffff', textAlign: 'center'
                        }]
                    }
                ];
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ state
                this.state.clearProject();
                manualSlides.forEach(slideData => {
                    this.state.createSlide(slideData);
                });
                
                if (manualSlides.length > 0) {
                    this.state.setCurrentSlideIndex(0);
                }
                
                return {
                    slides: manualSlides,
                    topic: topic,
                    generatedBy: 'Manual',
                    timestamp: Date.now()
                };
            }
        }

        // ===== –û–°–ù–û–í–ù–û–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–ï =====
        class FlashPostApp {
            constructor() {
                this.state = new StateManager();
                this.ai = new AIManager(this.state);
                this.init();
            }
            
            init() {
                console.log('üöÄ FlashPost Standalone –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                this.bindEvents();
                this.showStatus('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ', 'success');
            }
            
            bindEvents() {
                document.getElementById('generateBtn').addEventListener('click', () => {
                    this.handleManualGenerate();
                });
                
                document.getElementById('aiBtn').addEventListener('click', () => {
                    this.handleAIGenerate();
                });
                
                document.getElementById('topicInput').addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') {
                        this.handleManualGenerate();
                    }
                });
                
                document.getElementById('instagramInput').addEventListener('input', (e) => {
                    const nickname = e.target.value.trim();
                    this.state.setInstagramNickname(nickname);
                    if (nickname) {
                        this.state.setCTAText(`–ü–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ @${nickname}`);
                    }
                });
            }
            
            async handleManualGenerate() {
                const topic = document.getElementById('topicInput').value.trim();
                if (!topic) {
                    this.showStatus('‚ùå –í–≤–µ–¥–∏—Ç–µ —Ç–µ–º—É –¥–ª—è –∫–∞—Ä—É—Å–µ–ª–∏', 'error');
                    return;
                }
                
                this.showLoading(true, '–°–æ–∑–¥–∞–µ–º –∫–∞—Ä—É—Å–µ–ª—å –≤—Ä—É—á–Ω—É—é...');
                this.showStatus('üìù –†—É—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—É—Å–µ–ª–∏...', 'info');
                
                try {
                    const result = this.ai.generateManualCarousel(topic);
                    
                    setTimeout(() => {
                        this.showLoading(false);
                        this.showStatus(`‚úÖ –ö–∞—Ä—É—Å–µ–ª—å —Å–æ–∑–¥–∞–Ω–∞! –°–ª–∞–π–¥–æ–≤: ${result.slides.length}`, 'success');
                        this.displayCarousel(result);
                    }, 1500);
                    
                } catch (error) {
                    this.showLoading(false);
                    this.showStatus('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—É—Å–µ–ª–∏: ' + error.message, 'error');
                }
            }
            
            async handleAIGenerate() {
                const topic = document.getElementById('topicInput').value.trim();
                if (!topic) {
                    this.showStatus('‚ùå –í–≤–µ–¥–∏—Ç–µ —Ç–µ–º—É –¥–ª—è –∫–∞—Ä—É—Å–µ–ª–∏', 'error');
                    return;
                }
                
                this.showLoading(true, 'AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–∞—Ä—É—Å–µ–ª—å...');
                this.showStatus('ü§ñ ADVANCED AI Pipeline –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω...', 'info');
                
                try {
                    const result = await this.ai.generateProModeCarousel(topic);
                    
                    setTimeout(() => {
                        this.showLoading(false);
                        this.showStatus(`‚úÖ AI –∫–∞—Ä—É—Å–µ–ª—å —Å–æ–∑–¥–∞–Ω–∞! –°–ª–∞–π–¥–æ–≤: ${result.slides.length} (${result.generatedBy})`, 'success');
                        this.displayCarousel(result);
                    }, 2500);
                    
                } catch (error) {
                    this.showLoading(false);
                    this.showStatus('‚ùå –û—à–∏–±–∫–∞ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: ' + error.message, 'error');
                }
            }
            
            displayCarousel(result) {
                const preview = document.getElementById('carouselPreview');
                preview.innerHTML = `
                    <h3>üìä –ö–∞—Ä—É—Å–µ–ª—å: ${result.topic}</h3>
                    <p><strong>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä:</strong> ${result.generatedBy}</p>
                    <p><strong>–°–ª–∞–π–¥–æ–≤:</strong> ${result.slides.length}</p>
                    ${result.outline ? `<p><strong>–°—Ç—Ä—É–∫—Ç—É—Ä–∞:</strong> ${result.outline.structure}</p>` : ''}
                    ${result.outline ? `<p><strong>–ê—É–¥–∏—Ç–æ—Ä–∏—è:</strong> ${result.outline.targetAudience}</p>` : ''}
                `;
                
                result.slides.forEach((slide, index) => {
                    const slideEl = document.createElement('div');
                    slideEl.className = 'slide-item';
                    
                    const title = slide.textBlocks && slide.textBlocks[0] ? slide.textBlocks[0].text.split('\n')[0] : `–°–ª–∞–π–¥ ${index + 1}`;
                    const content = slide.textBlocks && slide.textBlocks[1] ? slide.textBlocks[1].text : 
                                   (slide.textBlocks && slide.textBlocks[0] ? slide.textBlocks[0].text : '–ù–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞');
                    
                    slideEl.innerHTML = `
                        <div class="slide-title">${title}</div>
                        <div class="slide-content">${content}</div>
                        <div class="slide-meta">
                            –¢–∏–ø: ${slide.slideType || 'standard'} | 
                            –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: ${slide.keywordType || 'none'} | 
                            –¢–æ–Ω: ${slide.emotionalTone || 'neutral'}
                        </div>
                    `;
                    
                    preview.appendChild(slideEl);
                });
            }
            
            showStatus(message, type) {
                const status = document.getElementById('status');
                status.innerHTML = `<div class="status ${type}">${message}</div>`;
            }
            
            showLoading(show, text = '–ó–∞–≥—Ä—É–∑–∫–∞...') {
                const loading = document.getElementById('loading');
                const loadingText = document.getElementById('loadingText');
                
                if (show) {
                    loading.classList.add('active');
                    loadingText.textContent = text;
                } else {
                    loading.classList.remove('active');
                }
            }
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            window.flashPostApp = new FlashPostApp();
        });
    </script>
</body>
</html>