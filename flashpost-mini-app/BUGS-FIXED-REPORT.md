# –û–¢–ß–ï–¢ –û–ë –ò–°–ü–†–ê–í–õ–ï–ù–ò–ò –°–ö–†–´–¢–´–• –ë–ê–ì–û–í

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

### 1. üîß –ò–°–ü–†–ê–í–õ–ï–ù–´ –°–ò–ù–¢–ê–ö–°–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò

#### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª—è –≤ state.js
- **–ë—ã–ª–æ**: –≠–∫—Å–ø–æ—Ä—Ç –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –∫–ª–∞—Å—Å–∞, –Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º—ã–π –∫–æ–¥
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω —ç–∫—Å–ø–æ—Ä—Ç –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞

#### –ü—Ä–æ–±–ª–µ–º–∞: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ substr()
- **–ë—ã–ª–æ**: `Math.random().toString(36).substr(2, 9)`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: `Math.random().toString(36).substring(2, 9)`

#### –ü—Ä–æ–±–ª–µ–º–∞: –û–ø–µ—á–∞—Ç–∫–∞ –≤ editor.js
- **–ë—ã–ª–æ**: `topicInput.value.lengt`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: `topicInput.value.length`

### 2. üîß –ò–°–ü–†–ê–í–õ–ï–ù–´ –¶–ò–ö–õ–ò–ß–ï–°–ö–ò–ï –ó–ê–í–ò–°–ò–ú–û–°–¢–ò

#### –ü—Ä–æ–±–ª–µ–º–∞: Editor –Ω–µ –ø–æ–ª—É—á–∞–ª Renderer –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
- **–ë—ã–ª–æ**: `new Editor(this.state)`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: `new Editor(this.state, this.renderer)`

#### –ü—Ä–æ–±–ª–µ–º–∞: StateManager –Ω–∞–ø—Ä—è–º—É—é –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞–ª DOM
- **–ë—ã–ª–æ**: `triggerLivePreviewUpdate()` –∏ `updateElementFromState()` –≤ StateManager
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –£–¥–∞–ª–µ–Ω—ã DOM –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏, –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∫–æ–ª–±—ç–∫–æ–≤

### 3. üîß –ò–°–ü–†–ê–í–õ–ï–ù–´ –°–û–°–¢–û–Ø–ù–ò–Ø –ì–û–ù–ö–ò

#### –ü—Ä–æ–±–ª–µ–º–∞: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—É—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è DOM
- **–ë—ã–ª–æ**: State ‚Üí DOM –∏ Editor ‚Üí Renderer ‚Üí DOM –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –ï–¥–∏–Ω—ã–π –ø–æ—Ç–æ–∫: State ‚Üí Callback ‚Üí Renderer ‚Üí DOM

#### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π
- **–ë—ã–ª–æ**: –ü—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã `renderer.updateTextBlockStyles()` –∏–∑ Editor
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –í—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–¥—É—Ç —á–µ—Ä–µ–∑ –∫–æ–ª–±—ç–∫ —Å–∏—Å—Ç–µ–º—ã State

### 4. üîß –ò–°–ü–†–ê–í–õ–ï–ù–´ –£–¢–ï–ß–ö–ò –ü–ê–ú–Ø–¢–ò

#### –ü—Ä–æ–±–ª–µ–º–∞: –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –Ω–µ –æ—á–∏—â–∞–ª–∏—Å—å
- **–ë—ã–ª–æ**: –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–æ–±–∞–≤–ª—è–ª–∏—Å—å –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–µ
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ `cleanupEventHandlers()` –≤ Editor

#### –ü—Ä–æ–±–ª–µ–º–∞: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–µ—Ç–æ–¥–∞ destroy()
- **–ë—ã–ª–æ**: –ù–µ—Ç —Å–ø–æ—Å–æ–±–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `destroy()` –≤ Editor

### 5. üîß –ò–°–ü–†–ê–í–õ–ï–ù–ê –ù–ï–°–û–ì–õ–ê–°–û–í–ê–ù–ù–û–°–¢–¨ –°–û–°–¢–û–Ø–ù–ò–Ø

#### –ü—Ä–æ–±–ª–µ–º–∞: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏—Å—Ç–∏–Ω—ã
- **–ë—ã–ª–æ**: State, DOM –∫–ª–∞—Å—Å—ã –∏ –¥–∞–Ω–Ω—ã–µ –±–ª–æ–∫–æ–≤ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –≤ StateManager —Å –∫–æ–ª–±—ç–∫–∞–º–∏

#### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤
- **–ë—ã–ª–æ**: –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–≥–ª–∏ –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–µ
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –î–æ–±–∞–≤–ª–µ–Ω try-catch —Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º

### 6. üîß –ò–°–ü–†–ê–í–õ–ï–ù–´ –ü–†–û–ë–õ–ï–ú–´ –° –§–û–ö–£–°–û–ú

#### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ç–µ—Ä—è –∫—É—Ä—Å–æ—Ä–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- **–ë—ã–ª–æ**: –û—à–∏–±–∫–∞ –≤ `restoreSelection()` –ª–æ–º–∞–ª–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –î–æ–±–∞–≤–ª–µ–Ω try-catch —Å fallback –Ω–∞ –ø—Ä–æ—Å—Ç–æ–π focus()

#### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ñ–ª–∏–∫—Ç –∂–∏–≤–æ–≥–æ –ø—Ä–µ–≤—å—é –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **–ë—ã–ª–æ**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–æ–≥–ª–æ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π —ç–ª–µ–º–µ–Ω—Ç
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –ö–æ–ª–±—ç–∫ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã

### 7. üîß –£–î–ê–õ–ï–ù–ê –î–£–ë–õ–ò–†–û–í–ê–ù–ù–ê–Ø –õ–û–ì–ò–ö–ê

#### –ü—Ä–æ–±–ª–µ–º–∞: Renderer —Å–æ–¥–µ—Ä–∂–∞–ª –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É
- **–ë—ã–ª–æ**: `handleToolbarAction()` –≤ Renderer
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –£–¥–∞–ª–µ–Ω –∏–∑ Renderer, –ª–æ–≥–∏–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –≤ Editor

#### –ü—Ä–æ–±–ª–µ–º–∞: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è DOM
- **–ë—ã–ª–æ**: `updateElementFromState()` –≤ State –∏ `updateTextBlockStyles()` –≤ Renderer
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –¢–æ–ª—å–∫–æ Renderer –æ–±–Ω–æ–≤–ª—è–µ—Ç DOM –ø–æ –∫–æ–ª–±—ç–∫–∞–º

## üèóÔ∏è –ù–û–í–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:
- **StateManager**: –¢–û–õ–¨–ö–û —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ + —Å–∏—Å—Ç–µ–º–∞ –∫–æ–ª–±—ç–∫–æ–≤
- **Editor**: –¢–û–õ–¨–ö–û –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ + –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π + –æ—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
- **Renderer**: –¢–û–õ–¨–ö–û —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ DOM

### –ï–¥–∏–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:
```
User Action ‚Üí Editor ‚Üí StateManager ‚Üí Callback ‚Üí Renderer ‚Üí DOM
```

### –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```javascript
this.state = new StateManager();
this.renderer = new Renderer(this.state);
this.editor = new Editor(this.state, this.renderer); // –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
```

### –°–∏—Å—Ç–µ–º–∞ –∫–æ–ª–±—ç–∫–æ–≤ –¥–ª—è —Å–≤—è–∑–∏ –º–æ–¥—É–ª–µ–π:
```javascript
// –í StateManager
this.onPropertyChangeCallback = null;

// –í App
this.state.setPropertyChangeCallback((hookData) => {
    this.updateAllPreviewElements(hookData.blockId);
});
```

## üõ°Ô∏è –î–û–ë–ê–í–õ–ï–ù–ù–ê–Ø –ó–ê–©–ò–¢–ê –û–¢ –û–®–ò–ë–û–ö

### 1. Try-catch –±–ª–æ–∫–∏ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö
### 2. –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
### 3. Fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–æ—Ä–∞
### 4. –ü—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–µ—Ä–µ–¥ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—è–º–∏

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢

### ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ –º–µ–∂–¥—É core –º–æ–¥—É–ª—è–º–∏
### ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω—ã —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏
### ‚úÖ –ò—Å–∫–ª—é—á–µ–Ω—ã —Å–æ—Å—Ç–æ—è–Ω–∏—è –≥–æ–Ω–∫–∏
### ‚úÖ –û–±–µ—Å–ø–µ—á–µ–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
### ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞ —Å—á–µ—Ç –µ–¥–∏–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

## üîÑ –û–ë–†–ê–¢–ù–ê–Ø –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–¨

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:
- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ `window.renderer` –∏ `window.templateManager` –æ—Å—Ç–∞–ª–∏—Å—å
- API –º–µ—Ç–æ–¥–æ–≤ –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

## üöÄ –ì–û–¢–û–í–ù–û–°–¢–¨ –ö –†–ê–°–®–ò–†–ï–ù–ò–Æ

–ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è:
- –°–∏—Å—Ç–µ–º—ã —à–∞–±–ª–æ–Ω–æ–≤
- –ü–æ–¥—Å–≤–µ—Ç–∫–∏ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤  
- –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ drag & drop
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –æ–±–ª–∞—á–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏