# ‚úÖ –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–´ SINGLE SOURCE OF TRUTH

## üéØ –¶–ï–õ–¨
–û–±–µ—Å–ø–µ—á–∏—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω—É—é –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö —Å–ª–∞–π–¥–æ–≤ –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤ —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã - StateManager.

## üîß –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ù–ê–†–£–®–ï–ù–ò–Ø

### 1. ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ü—Ä—è–º—ã–µ –º—É—Ç–∞—Ü–∏–∏ textBlocks –≤ Templates
**–ë—ã–ª–æ:**
```javascript
// –ù–ê–†–£–®–ï–ù–ò–ï: –ü—Ä—è–º–∞—è –º—É—Ç–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞
slide.textBlocks.push(newBlock);
```

**–°—Ç–∞–ª–æ:**
```javascript
// ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û: –ß–µ—Ä–µ–∑ StateManager
this.state.addTextBlockToSlide(slideId, blockData);
```

### 2. ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ü—Ä—è–º—ã–µ DOM –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ –≤ Drag
**–ë—ã–ª–æ:**
```javascript
// –ù–ê–†–£–®–ï–ù–ò–ï: –ü—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ DOM
blockEl.style.left = clampedX + '%';
blockEl.style.top = clampedY + '%';
```

**–°—Ç–∞–ª–æ:**
```javascript
// ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û: –¢–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
this.state.updateTextBlockProperty(blockId, 'x', clampedX);
this.state.updateTextBlockProperty(blockId, 'y', clampedY);
// DOM –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ –∫–æ–ª–±—ç–∫–∏
```

### 3. ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ project.slides
**–ë—ã–ª–æ –≤ Renderer:**
```javascript
// –ù–ê–†–£–®–ï–ù–ò–ï: –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø
const totalSlides = this.state.project.slides.length;
this.state.project.slides.forEach((slide, index) => {
```

**–°—Ç–∞–ª–æ:**
```javascript
// ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û: –ß–µ—Ä–µ–∑ –º–µ—Ç–æ–¥—ã StateManager
const totalSlides = this.state.getSlidesCount();
const slides = this.state.getAllSlides();
slides.forEach((slide, index) => {
```

**–ë—ã–ª–æ –≤ Export:**
```javascript
// –ù–ê–†–£–®–ï–ù–ò–ï: –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø
const slides = this.state.project.slides;
```

**–°—Ç–∞–ª–æ:**
```javascript
// ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û: –ß–µ—Ä–µ–∑ –º–µ—Ç–æ–¥—ã StateManager
const slides = this.state.getAllSlides();
```

**–ë—ã–ª–æ –≤ Templates:**
```javascript
// –ù–ê–†–£–®–ï–ù–ò–ï: –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø
const slides = this.state.project.slides;
this.state.project.slides.forEach(slide => {
```

**–°—Ç–∞–ª–æ:**
```javascript
// ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û: –ß–µ—Ä–µ–∑ –º–µ—Ç–æ–¥—ã StateManager
const slides = this.state.getAllSlides();
slides.forEach(slide => {
```

### 4. ‚úÖ –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢: –ü—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª–∏–Ω—ã –º–∞—Å—Å–∏–≤–∞
**–ë—ã–ª–æ –≤ Editor:**
```javascript
// –ù–ê–†–£–®–ï–ù–ò–ï: –ü—Ä—è–º–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã
if (currentIndex < this.state.project.slides.length - 1) {
```

**–°—Ç–∞–ª–æ:**
```javascript
// ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û: –ß–µ—Ä–µ–∑ –º–µ—Ç–æ–¥—ã StateManager
const totalSlides = this.state.getSlidesCount();
if (currentIndex < totalSlides - 1) {
```

**–ë—ã–ª–æ –≤ App:**
```javascript
// –ù–ê–†–£–®–ï–ù–ò–ï: –ü—Ä—è–º–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã
if (this.state.project.slides.length > 0) {
```

**–°—Ç–∞–ª–æ:**
```javascript
// ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û: –ß–µ—Ä–µ–∑ –º–µ—Ç–æ–¥—ã StateManager
const slidesCount = this.state.getSlidesCount();
if (slidesCount > 0) {
```

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –ü–†–ò–ù–¶–ò–ü–´

### ‚úÖ –ï–î–ò–ù–´–ô –ò–°–¢–û–ß–ù–ò–ö –ò–°–¢–ò–ù–´
- **–¢–æ–ª—å–∫–æ StateManager** –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ `project.slides` –∏ `textBlocks`
- **–í—Å–µ –º–æ–¥—É–ª–∏** –∏—Å–ø–æ–ª—å–∑—É—é—Ç –º–µ—Ç–æ–¥—ã StateManager –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
- **–í—Å–µ –º—É—Ç–∞—Ü–∏–∏** –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ StateManager

### ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–´–ï –ú–ï–¢–û–î–´ –î–û–°–¢–£–ü–ê
```javascript
// –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∫–æ–ø–∏–∏)
state.getAllSlides()           // –í—Å–µ —Å–ª–∞–π–¥—ã
state.getSlidesCount()         // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–∞–π–¥–æ–≤
state.getSlideById(id)         // –°–ª–∞–π–¥ –ø–æ ID
state.getSlideByIndex(index)   // –°–ª–∞–π–¥ –ø–æ –∏–Ω–¥–µ–∫—Å—É
state.getActiveSlide()         // –ê–∫—Ç–∏–≤–Ω—ã–π —Å–ª–∞–π–¥
state.getActiveSlideIndex()    // –ò–Ω–¥–µ–∫—Å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–ª–∞–π–¥–∞

// –ú—É—Ç–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ StateManager)
state.addTextBlockToSlide(slideId, blockData)
state.updateTextBlockInSlide(slideId, blockId, updates)
state.deleteTextBlockFromSlide(slideId, blockId)
state.updateSlideProperty(slideId, property, value)
```

### ‚úÖ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï DOM
- StateManager —É–≤–µ–¥–æ–º–ª—è–µ—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ —á–µ—Ä–µ–∑ –∫–æ–ª–±—ç–∫–∏
- Renderer –æ–±–Ω–æ–≤–ª—è–µ—Ç DOM –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ù–∏–∫—Ç–æ –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç DOM –Ω–∞–ø—Ä—è–º—É—é, –∫—Ä–æ–º–µ Renderer

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –§–£–ù–ö–¶–ò–ô

### ‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –±–ª–æ–∫–∞
```javascript
// –ß–µ—Ä–µ–∑ StateManager
const newBlock = state.addTextBlock();
// DOM –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

### ‚úçÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
```javascript
// –ß–µ—Ä–µ–∑ StateManager
state.updateTextBlockProperty(blockId, 'text', newText);
// DOM –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

### üñ± Drag & Drop
```javascript
// –¢–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
state.updateTextBlockProperty(blockId, 'x', newX);
state.updateTextBlockProperty(blockId, 'y', newY);
// DOM –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ –∫–æ–ª–±—ç–∫–∏
```

### üìê –ò–∑–º–µ–Ω–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã
```javascript
// –¢–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
state.updateTextBlockProperty(blockId, 'width', newWidth);
// DOM –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ –∫–æ–ª–±—ç–∫–∏
```

## üîç –ü–†–û–í–ï–†–ö–ê –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–û–ô –¶–ï–õ–û–°–¢–ù–û–°–¢–ò

### ‚úÖ –í—Å–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:
1. ‚ùå ~~–ü—Ä—è–º—ã–µ –º—É—Ç–∞—Ü–∏–∏ textBlocks~~ ‚Üí ‚úÖ –ß–µ—Ä–µ–∑ StateManager
2. ‚ùå ~~–ü—Ä—è–º—ã–µ DOM –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏~~ ‚Üí ‚úÖ –¢–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
3. ‚ùå ~~–ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ project.slides~~ ‚Üí ‚úÖ –ß–µ—Ä–µ–∑ –º–µ—Ç–æ–¥—ã StateManager
4. ‚ùå ~~–ü—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª–∏–Ω—ã –º–∞—Å—Å–∏–≤–∞~~ ‚Üí ‚úÖ –ß–µ—Ä–µ–∑ getSlidesCount()

### ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –≥–∞—Ä–∞–Ω—Ç–∏–∏:
- **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å**: –ò–∑–º–µ–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ StateManager
- **–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º–æ—Å—Ç—å**: –í—Å–µ –º—É—Ç–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –í–Ω–µ—à–Ω–∏–µ –º–æ–¥—É–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –∫–æ–ø–∏–∏ –¥–∞–Ω–Ω—ã—Ö

## üöÄ –†–ï–ó–£–õ–¨–¢–ê–¢

–¢–µ–ø–µ—Ä—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø—É Single Source of Truth:

1. **StateManager** - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü –¥–∞–Ω–Ω—ã—Ö
2. **Renderer** - —á–∏—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è
3. **Editor & Drag** - —Ç–æ–ª—å–∫–æ –≤—ã–∑—ã–≤–∞—é—Ç –º–µ—Ç–æ–¥—ã StateManager
4. **Templates & Export** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–æ—Å—Ç—É–ø–∞

–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ! üéâ