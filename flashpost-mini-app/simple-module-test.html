<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Simple Module Test</title>
    <style>
        html, body { margin: 0; padding: 0; height: 100%; background: #0f0f14; color: #fff; font-family: Arial; }
        .container { padding: 20px; max-width: 800px; margin: 0 auto; }
        .log { background: #2a2a2a; border: 1px solid #444; border-radius: 5px; padding: 10px; font-family: monospace; font-size: 12px; max-height: 400px; overflow-y: auto; margin: 10px 0; }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
        .warning { color: #ff9800; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Simple Module Test</h1>
        <div id="log" class="log"></div>
    </div>

    <script>
        function log(message, type = 'info') {
            const logElement = document.getElementById('log');
            const className = type === 'error' ? 'error' : (type === 'success' ? 'success' : (type === 'warning' ? 'warning' : ''));
            logElement.innerHTML += `<div class="${className}">[${new Date().toLocaleTimeString()}] ${message}</div>`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }

        // –ü–µ—Ä–µ—Ö–≤–∞—Ç –æ—à–∏–±–æ–∫
        window.addEventListener('error', (e) => {
            log(`‚ùå JavaScript Error: ${e.message} –≤ ${e.filename}:${e.lineno}`, 'error');
        });

        window.addEventListener('unhandledrejection', (e) => {
            log(`‚ùå Unhandled Promise Rejection: ${e.reason}`, 'error');
        });

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π
        function checkModules() {
            log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π...');
            
            const modules = [
                'StateManager',
                'Renderer', 
                'Editor',
                'DragManager',
                'ExportManager',
                'AIManager',
                'TemplateManager',
                'FlashPostApp'
            ];
            
            let loadedCount = 0;
            let missingModules = [];
            
            modules.forEach(moduleName => {
                if (typeof window[moduleName] !== 'undefined') {
                    log(`‚úÖ ${moduleName}: –∑–∞–≥—Ä—É–∂–µ–Ω`, 'success');
                    loadedCount++;
                } else {
                    log(`‚ùå ${moduleName}: –ù–ï –Ω–∞–π–¥–µ–Ω`, 'error');
                    missingModules.push(moduleName);
                }
            });
            
            log(`üìä –ò—Ç–æ–≥–æ: ${loadedCount}/${modules.length} –º–æ–¥—É–ª–µ–π –∑–∞–≥—Ä—É–∂–µ–Ω–æ`);
            
            if (missingModules.length === 0) {
                log('‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!', 'success');
                testFlashPostApp();
            } else {
                log(`‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –º–æ–¥—É–ª–∏: ${missingModules.join(', ')}`, 'error');
            }
        }

        function testFlashPostApp() {
            log('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ FlashPostApp...');
            
            try {
                log('üì¶ –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä FlashPostApp...');
                const app = new FlashPostApp();
                log('‚úÖ FlashPostApp —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–µ—Ç–æ–¥—ã
                if (typeof app.generateManualSlides === 'function') {
                    log('‚úÖ –ú–µ—Ç–æ–¥ generateManualSlides –Ω–∞–π–¥–µ–Ω', 'success');
                    
                    // –¢–µ—Å—Ç–∏—Ä—É–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
                    const slides = app.generateManualSlides('–¢–µ—Å—Ç–æ–≤–∞—è —Ç–µ–º–∞');
                    log(`‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ ${slides.length} —Å–ª–∞–π–¥–æ–≤`, 'success');
                    
                } else {
                    log('‚ùå –ú–µ—Ç–æ–¥ generateManualSlides –ù–ï –Ω–∞–π–¥–µ–Ω', 'error');
                }
                
                if (typeof app.handleGenerate === 'function') {
                    log('‚úÖ –ú–µ—Ç–æ–¥ handleGenerate –Ω–∞–π–¥–µ–Ω', 'success');
                } else {
                    log('‚ùå –ú–µ—Ç–æ–¥ handleGenerate –ù–ï –Ω–∞–π–¥–µ–Ω', 'error');
                }
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è FlashPostApp: ${error.message}`, 'error');
                log(`‚ùå Stack: ${error.stack}`, 'error');
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
        let scriptsLoaded = 0;
        const totalScripts = 8; // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–¥—É–ª–µ–π

        function onScriptLoad() {
            scriptsLoaded++;
            log(`üì¶ –ó–∞–≥—Ä—É–∂–µ–Ω —Å–∫—Ä–∏–ø—Ç ${scriptsLoaded}/${totalScripts}`);
            
            if (scriptsLoaded === totalScripts) {
                log('üì¶ –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –Ω–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É...', 'success');
                setTimeout(checkModules, 100);
            }
        }

        function onScriptError(scriptName) {
            log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞: ${scriptName}`, 'error');
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥—É–ª–∏ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º
        const scripts = [
            'src/state.js',
            'src/renderer.js',
            'src/editor.js',
            'src/drag.js',
            'src/export.js',
            'src/ai.js',
            'src/template-manager.js',
            'src/app.js'
        ];

        log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –º–æ–¥—É–ª–µ–π...');

        scripts.forEach((scriptPath, index) => {
            const script = document.createElement('script');
            script.src = scriptPath;
            script.onload = () => {
                log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω: ${scriptPath}`, 'success');
                onScriptLoad();
            };
            script.onerror = () => {
                log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${scriptPath}`, 'error');
                onScriptError(scriptPath);
            };
            document.head.appendChild(script);
        });
    </script>
</body>
</html>